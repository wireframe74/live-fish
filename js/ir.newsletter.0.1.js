function newsFormSub(e){$("input#nls").verimail({messageElement:"div.signUpSent"}),"error"==$("input#nls").getVerimailStatus()?($("div.signUpSent").animate({marginLeft:"5px"},50),setTimeout(function(){$("div.signUpSent").animate({marginLeft:"0px"},50)},50),setTimeout(function(){$("div.signUpSent").animate({marginLeft:"5px"},50)},100),setTimeout(function(){$("div.signUpSent").animate({marginLeft:"0px"},50)},150),setTimeout(function(){$("div.signUpSent").animate({marginLeft:"5px"},50)},200),setTimeout(function(){$("div.signUpSent").animate({marginLeft:"0px"},50)},250)):e.submit(),console.log($("input#nls").getVerimailStatus())}$("#nls").on("input",function(){$("input#nls").verimail({messageElement:"div.signUpSent"})});var Comfirm=Comfirm||{};Comfirm.AlphaMail=Comfirm.AlphaMail||{};var Verimail=Comfirm.AlphaMail.Verimail=function(e){this.options={url:"http://jsapi.comfirm.se/verify/v1/",token:null,enforceTld:!0,denyTempEmailDomains:!1,language:"en",richTextMessages:!0,distanceFunction:null};for(key in e)e.hasOwnProperty(key)&&(this.options[key]=e[key]);this.setLanguage(this.options.language,"en"),this.Service={},this.Service.verify=function(e,t){t(Verimail.Status.CorrectSyntax,"It looks OK!")}};Verimail.Status={MxServerDownError:-7,MissingMxRecordsError:-6,DomainError:-5,BlockedError:-4,InvalidPart:-3,SyntaxError:-2,EmptyError:-1,CorrectSyntax:0,Pending:1,EmailExists:2,EmailExistsOnSocialNetworks:3,AcceptAllPolicy:4},Verimail.Language={en:{success:"Email looks OK",typo:"Did you mean <span class='suggestion'>%s</span>?",invalidTld:"Top level domain <span class='tld'>%s</span> does not exist",domainBlocked:"Domain <span class='blocked'>%s</span> is not allowed",invalidFormat:"Email is not correctly formatted",empty:"Email is empty"},sv:{success:"E-postadressen är godkänd",typo:"Menade du <span class='suggestion'>%s</span>?",invalidTld:"Toppdomänen <span class='tld'>%s</span> existerar inte",domainBlocked:"Domänen <span class='domain'>%s</span> är inte tillåten",invalidFormat:"Ogiltig e-postadress",empty:"E-postadressen är tom"}},Verimail.MostCommonEmailDomains={"gmail.com":null,"msn.com":null,"hotmail.com":null,"hotmail.co.uk":null,"yahoo.com":null,"yahoo.co.uk":null,"facebook.com":null,"live.com":null,"mail.com":null,"gmx.com":null,"aol.com":null,"verizon.net":null,"comcast.net":null,"googlemail.com":null,"att.net":null,"mail.com":null,"mac.com":null,"rocketmail.com":null,"ymail.com":null},Verimail.MostCommonTlds={com:null,org:null,edu:null,gov:null,uk:null,net:null,ca:null,de:null,jp:null,fr:null,au:null,us:null,ru:null,ch:null,it:null,nl:null,se:null,dk:null,no:null,es:null,mil:null},Verimail.IANARegisteredTlds={ac:null,ad:null,ae:null,aero:null,af:null,ag:null,ai:null,al:null,am:null,an:null,ao:null,aq:null,ar:null,arpa:null,as:null,asia:null,at:null,au:null,aw:null,ax:null,az:null,ba:null,bb:null,bd:null,be:null,bf:null,bg:null,bh:null,bi:null,biz:null,bj:null,bm:null,bn:null,bo:null,br:null,bs:null,bt:null,bv:null,bw:null,by:null,bz:null,ca:null,cat:null,cc:null,cd:null,cf:null,cg:null,ch:null,ci:null,ck:null,cl:null,cm:null,cn:null,co:null,com:null,coop:null,cr:null,cu:null,cv:null,cw:null,cx:null,cy:null,cz:null,de:null,dj:null,dk:null,dm:null,"do":null,dz:null,ec:null,edu:null,ee:null,eg:null,er:null,es:null,et:null,eu:null,fi:null,fj:null,fk:null,fm:null,fo:null,fr:null,ga:null,gb:null,gd:null,ge:null,gf:null,gg:null,gh:null,gi:null,gl:null,gm:null,gn:null,gov:null,gp:null,gq:null,gr:null,gs:null,gt:null,gu:null,gw:null,gy:null,hk:null,hm:null,hn:null,hr:null,ht:null,hu:null,id:null,ie:null,il:null,im:null,"in":null,info:null,"int":null,io:null,iq:null,ir:null,is:null,it:null,je:null,jm:null,jo:null,jobs:null,jp:null,ke:null,kg:null,kh:null,ki:null,km:null,kn:null,kp:null,kr:null,kw:null,ky:null,kz:null,la:null,lb:null,lc:null,li:null,lk:null,lr:null,ls:null,lt:null,lu:null,lv:null,ly:null,ma:null,mc:null,md:null,me:null,mg:null,mh:null,mil:null,mk:null,ml:null,mm:null,mn:null,mo:null,mobi:null,mp:null,mq:null,mr:null,ms:null,mt:null,mu:null,museum:null,mv:null,mw:null,mx:null,my:null,mz:null,na:null,name:null,nc:null,ne:null,net:null,nf:null,ng:null,ni:null,nl:null,no:null,np:null,nr:null,nu:null,nz:null,om:null,org:null,pa:null,pe:null,pf:null,pg:null,ph:null,pk:null,pl:null,pm:null,pn:null,post:null,pr:null,pro:null,ps:null,pt:null,pw:null,py:null,qa:null,re:null,ro:null,rs:null,ru:null,rw:null,sa:null,sb:null,sc:null,sd:null,se:null,sg:null,sh:null,si:null,sj:null,sk:null,sl:null,sm:null,sn:null,so:null,sr:null,st:null,su:null,sv:null,sx:null,sy:null,sz:null,tc:null,td:null,tel:null,tf:null,tg:null,th:null,tj:null,tk:null,tl:null,tm:null,tn:null,to:null,tp:null,tr:null,travel:null,tt:null,tv:null,tw:null,tz:null,ua:null,ug:null,uk:null,us:null,uy:null,uz:null,va:null,vc:null,ve:null,vg:null,vi:null,vn:null,vu:null,wf:null,ws:null,ye:null,yt:null,za:null,zm:null,zw:null},Verimail.TempEmailDomains={com:{mytrashmail:null,mailmetrash:null,trashymail:null,mailinator:null,mailexpire:null,temporaryinbox:null,rtrtr:null,sharklasers:null,guerrillamailblock:null,guerrillamail:null},net:{guerrillamail:null,tempemail:null},org:{guerrillamail:null,spamfree24:null,jetable:null},fr:{tempomail:null},de:{guerrillamail:null},biz:{guerrillamail:null}},Verimail.getLevenshteinDistance=function(e,t){try{t=!"0"[0]}catch(n){t=!0}return function(n,i){if(n==i)return 0;if(!n.length||!i.length)return i.length||n.length;t&&(n=n.split(""),i=i.split(""));for(var o,r,a,s=n.length+1,l=i.length+1,c=0,u=0,d=[[0]];++u<l;)d[0][u]=u;for(u=0;++u<s;){for(a=r=0,o=n[c],d[u]=[u];++r<l;)d[u][r]=e(d[c][r]+1,d[u][a]+1,d[c][a]+(o!=i[a])),++a;++c}return d[s-1][l-1]}}(Math.min,!1),Verimail.getClosestString=function(e,t,n,i){n=n||.5;var o=Number.MAX_VALUE,r=!1;if(i=i||Verimail.getLevenshteinDistance,!(e in t))for(var a in t){var s=i(e,a);o>s&&s/e.length<n&&(o=s,r=a)}return r},Verimail.getClosestTld=function(e,t,n){return Verimail.getClosestString(e,Verimail.MostCommonTlds,t,n)},Verimail.getClosestEmailDomain=function(e,t,n){return Verimail.getClosestString(e,Verimail.MostCommonEmailDomains,t,n)},Verimail.testEmailFormat=function(e){return/^([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22))*\x40([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d))*$/.test(e)},Verimail.prototype.setLanguage=function(e,t){this.options.language=e&&e in Verimail.Language?e:t},Verimail.prototype.getLanguageText=function(e,t){var n=Verimail.Language[this.options.language][e];return t&&(n=n.replace("%s",t)),this.options.richTextMessages||(n=Verimail.stripHtml(n)),n},Verimail.stripHtml=function(e){if(null!=e&&-1!=e.indexOf("<"))if("undefined"!=typeof document){var t=document.createElement("DIV");t.innerHTML=e,e=t.textContent||t.innerText}else e=e.replace(/(<([^>]+)>)/gi,"");return e},Verimail.getEmailAddressSegments=function(e){for(var t="local",n={local:"",domain:"",tld:""},i=0;i<e.length;++i){var o=e.charAt(i);switch(t){case"local":"@"==o?t="domain":n.local+=o;break;case"domain":"."==o?t="tld":n.domain+=o;break;case"tld":"."==o?(n.domain+="."+n.tld,n.tld=""):n.tld+=o}}return n.fullDomain=n.domain+"."+n.tld,n},Verimail.prototype.verify=function(e,t){e=(e||"").toLowerCase();var n=null,i=null,o=null,r=function(e){return"<span class='correction'>"+e+"</span>"};if(!e||0==e.length||e.replace&&0==e.replace(/(?:(?:^|\n)\s+|\s+(?:$|\n))/g,"").replace(/\s+/g," ").length)n=Verimail.Status.EmptyError,i=this.getLanguageText("empty");else if(Verimail.testEmailFormat(e)){var a=Verimail.getEmailAddressSegments(e);if(this.options.denyTempEmailDomains&&a.tld in Verimail.TempEmailDomains&&a.domain in Verimail.TempEmailDomains[a.tld])n=Verimail.Status.BlockedError,i=this.getLanguageText("domainBlocked",a.fullDomain);else if(this.options.enforceTld)if(a.tld){if(!(a.tld in Verimail.IANARegisteredTlds)){n=Verimail.Status.InvalidPart;var s=Verimail.getClosestTld(a.tld,10,this.options.distanceFunction);if(s){var l=Verimail.getClosestEmailDomain(a.domain+"."+s,.25,this.options.distanceFunction);l?(o=a.local+"@"+l,i=this.getLanguageText("typo",a.local+"@"+r(l))):(o=a.local+"@"+a.domain+"."+s,i=this.getLanguageText("typo",a.local+"@"+a.domain+"."+r(s)))}else i=this.getLanguageText("invalidTld",a.tld)}}else n=Verimail.Status.InvalidPart,i=this.getLanguageText("invalidFormat")}else n=Verimail.Status.SyntaxError,i=this.getLanguageText("invalidFormat");if(null===n||n==Verimail.SyntaxError){var l=Verimail.getClosestEmailDomain(a.domain+"."+a.tld,.3,this.options.distanceFunction);l?(n=Verimail.Status.CorrectSyntax,o=a.local+"@"+l,i=this.getLanguageText("typo",a.local+"@"+r(l))):(n=Verimail.Status.CorrectSyntax,i=i||this.getLanguageText("success"))}t(n,i,o)},function(e){var t=function(t,n){this.element=t,this.$element=e(t),this.options=n};t.prototype={defaults:{messageElement:null,statusElement:null,prefixName:"verimail",onStatusChange:null},init:function(){var t=this,n=this.config=e.extend({},this.defaults,this.options),i=this.instance=new Comfirm.AlphaMail.Verimail(this.config),o=function(r){i.verify(r,function(i,a,s){var l="error",c=n.statusElement?e(n.statusElement):t.$element,u=i==Comfirm.AlphaMail.Verimail.Status.Pending;if(i>=0&&(l=u?"pending":"success"),n.onStatusChange&&n.onStatusChange(n,i,a,s),c.removeClass(n.prefixName+"-success").removeClass(n.prefixName+"-error").removeClass(n.prefixName+"-pending").addClass(n.prefixName+"-"+l),t.isPendingStatus=u,t.$element.data("verimail-status",l),n.messageElement){var d=e("<span>"+a+"</span>").addClass(l);if(s){var h=e("<a />").attr("href","#").click(function(){return r=s,t.$element.val(s),o(s),!1});e("span.suggestion",d).wrap(h)}e(n.messageElement).html(d)}})};return this.$element.val()&&this.$element.val().length>0&&o(this.$element.val()),this.$element.keyup(function(){var n=e(this).val();t.timeoutId&&clearTimeout(t.timeoutId),t.isPendingStatus?t.timeoutId=setTimeout(function(){o(n)},500):o(n)}),this}},t.defaults=t.prototype.defaults,e.fn.verimail=function(e){return this.each(function(){new t(this,e).init()})},e.fn.getVerimailStatus=function(){return this.data("verimail-status")}}(jQuery,window,document);