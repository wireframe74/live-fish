<HTML>
  <HEAD>
    <title></title>
    <link rel="stylesheet" href="dialog.css" type="text/css">
    <script language="javascript" src="../../../include/dialog.js"></script>
      <script>

var language = "";
var design = "";
var objElement;
var win;

function save()
{
  var objElementStyle = objElement.style;
  var width = objElementStyle.width;
  var cellSpacing = objElement.cellSpacing;
  var cellPadding = objElement.cellPadding;
  var border = objElement.border;
  var borderColor = objElement.borderColor;
  var backgroundColor = objElementStyle.backgroundColor; 
  var changed = false;
  
  try {

    // width
    if(document.getElementById("txtWidth").value != "")
      objElementStyle.width = document.getElementById("txtWidth").value;
    else
      objElementStyle.width = "";
    // height
    if(document.getElementById("txtHeight").value != "")
      objElementStyle.height = document.getElementById("txtHeight").value;
    else
      objElementStyle.height = "";

    if(document.getElementById("txtSpacing").value != "") {
      objElement.cellSpacing = document.getElementById("txtSpacing").value;
    } else {
      objElement.cellSpacing = 0;
    }
    if(document.getElementById("txtPadding").value != "") {
      objElement.cellPadding = document.getElementById("txtPadding").value
    } else {
      objElement.cellPadding = 0;
    }

    //float
    if (document.getElementById("left").checked == true)
      objElementStyle.styleFloat = "left";
    else if (document.getElementById("right").checked == true)
      objElementStyle.styleFloat = "right";
    else if (document.getElementById("none").checked == true)
      objElementStyle.styleFloat = "none";
      
   //set border-collapse:collapse (like MS Word)
    if (document.getElementById("txtSpacing").value < 1 )
      objElementStyle.borderCollapse = "collapse";
    else 
      removeAttribute(objElementStyle, "borderCollapse");     

    if(width != objElementStyle.width)
      changed = true;
    if(cellSpacing != objElement.cellSpacing)
      changed = true;
    if(cellPadding != objElement.cellPadding)
      changed = true;
    if(border != objElement.border)
      changed = true;

    if(changed)
      win.__editOnChanged(true);

  } catch(Error) {}

  window.close();
}

function initDialog(param)
{
  params = param;
  
  try {
	  language            = params[0];
	  design              = params[1];
	  mode                = params[2];
	  doc                 = params[4];
	  objElement          = params[5];

    // set language strings
    setStrings();

    var objElementStyle = objElement.style;

		if (objElementStyle.width != "")
	    document.getElementById("txtWidth").value    = objElementStyle.width;
    if (objElementStyle.height != "")
			document.getElementById("txtHeight").value   = objElementStyle.height;

    if(objElement.cellSpacing)
      document.getElementById("txtSpacing").value = objElement.cellSpacing;
    if(objElement.cellPadding)
      document.getElementById("txtPadding").value = objElement.cellPadding;
      
    if (objElementStyle.styleFloat == "left")
      document.getElementById("left").checked = true;
    else if (objElementStyle.styleFloat == "right")
      document.getElementById("right").checked = true;
    else if (objElementStyle.styleFloat == "none" || !objElement.styleFloat )
      document.getElementById("none").checked = true;
            

  } catch(Error) {}

}
</script>
  </HEAD>
  <BODY class="bodypage">
    <fieldset>
      <legend class="head">
        <span id="4006">_Size</span>
      </legend>
      <table cellspacing="0" cellpadding="1" border="0" ID="Table2">
        <tr>
          <td>
            <div id="4000" class="label">_Width:</div>
          </td>
          <td>
            <input type="text" ID="txtWidth" size="5">
          </td>
        </tr>
        <tr>
          <td>
            <div id="4001" class="label">_Height:</div>
          </td>
          <td>
            <input type="text" ID="txtHeight" size="5">
          </td>
        </tr>
      </table>
    </fieldset>
    <fieldset>
      <legend class="head">
        <span id="3363">_Spacing</span>
      </legend>
      <table cellspacing="0" cellpadding="1" border="0" ID="Table3">
        <tr>
          <td nowrap>
            <div id="904" class="label">_Cell spacing:</div>
          </td>
          <td>
            <input type="text" ID="txtSpacing" style="width:20px;">
          </td>
          <td valign="middle">
            <img src="spacing.gif" style="margin-left:29px;"/>
          </td>
        </tr>
        <tr>
          <td nowrap>
            <div id="906" class="label">_Cell padding:</div>
          </td>
          <td>
            <input type="text" ID="txtPadding" style="width:20px;">
          </td>
          <td valign="middle">
            <img src="padding.gif" style="margin-left:29px;" />
          </td>
        </tr>
      </table>
    </fieldset>
  <fieldset>
    <legend class="head">
      <span id="4056">_Float</span>
    </legend>
      <table cellpadding="0" cellspacing="0" border="0">
      <tr style="padding-top:5px;">
        <td >
          <input id="left" name="float" type="radio" />    
        </td>
        <td style="padding-right:12px;">
          <img src="tablefloatleft.gif" />
        </td>
        <td>
          <input id="right" name="float" type="radio" />
        </td>
        <td style="padding-right:12px;">
          <img src="tablefloatright.gif" /></td>
        <td>
          <input id="none" name="float" type="radio" />
        </td>
        <td>
          <span id="4060" class="label">_none</span></td>
      </tr>
      </table>
    </fieldset>    
  </BODY>
</HTML>
