<HEAD>
<title></title>
<LINK href="dialog.css" type="text/css" rel="stylesheet">
<script language="javascript" src="../../../include/dialog.js"></script>
<script language="javascript" src="../../../include/listbox.js"></script>
<SCRIPT>

var curType = "";
var language = "";
var design = "";
var mode = "";
var objElement;
var isDebug = false;
var lbStyle = null;
var lbWidth = null;

function update()
{
  selectColor(parent.parent.objPreview.style.backgroundColor);
}

function colorClick(obj)
{
  if (parent.parent.lbStyleSheet.selectedItem != null) {
    objElementStyle = parent.parent.objPreview.style;
    objElementStyle.backgroundColor = obj.style.backgroundColor;  
    //Update ListItem
    parent.parent.updateListItem();     
    showSelection(obj);
  }
}

function noColorClick(obj)
{
  if (parent.parent.lbStyleSheet.selectedItem != null) {
    objElementStyle = parent.parent.objPreview.style;
    removeAttribute(objElementStyle, "backgroundColor");  
    //Update ListItem
    parent.parent.updateListItem();     
    showSelection(obj);
  }

}

function btnMoreColors()
{
  if (parent.parent.lbStyleSheet.selectedItem != null) {
    selectColorWp(parent.parent.objPreview.style); 
    clearSelection();
  } else {
    selectColorWp(null);
  }
}

function selectColor(color)
{
  var objElement = document.getElementById("tblColor");
  for(var i=0;i<objElement.rows.length;i++) {
	  var tr = objElement.rows[i];
    for (var y=0;y<tr.cells.length;y++) {
	    var curtd = tr.cells[y];
	    if (curtd.style.backgroundColor == color) {
        //alert();
        curtd.style.borderLeftColor = "blue"
        curtd.style.borderTopColor = "blue"
        curtd.style.borderBottomColor = "blue"
        curtd.style.borderRightColor = "blue"
      } else {
        curtd.style.borderLeftColor = "white"
        curtd.style.borderTopColor = "white"
        curtd.style.borderBottomColor = "white"
        curtd.style.borderRightColor = "white"        
      }                
	  }
  }      
}


function showSelection(obj) 
{
  try {
    var objElement = document.getElementById("tblColor");
    for(var i=0;i<objElement.rows.length;i++) {
	    var tr = objElement.rows[i];
      for (var y=0;y<tr.cells.length;y++) {
	      var curtd = tr.cells[y];
	      if (curtd == obj) {
          curtd.style.borderLeftColor = "blue"
          curtd.style.borderTopColor = "blue"
          curtd.style.borderBottomColor = "blue"
          curtd.style.borderRightColor = "blue"
        } else {
          curtd.style.borderLeftColor = "white"
          curtd.style.borderTopColor = "white"
          curtd.style.borderBottomColor = "white"
          curtd.style.borderRightColor = "white"        
        }                
	    }
    }      
  } catch(Error) {}
}

function clearSelection() 
{
  try {
    var objElement = document.getElementById("tblColor");
    for(var i=0;i<objElement.rows.length;i++) {
	    var tr = objElement.rows[i];
      for (var y=0;y<tr.cells.length;y++) {
	      var curtd = tr.cells[y];
        curtd.style.borderLeftColor = "white"
        curtd.style.borderTopColor = "white"
        curtd.style.borderBottomColor = "white"
        curtd.style.borderRightColor = "white"        
	    }
    }      
  } catch(Error) {}

}

function save()
{
  try {
    var objElementStyle = objElement.style;
    var changed = false;
    var win = params[11];
    var bgColor = objElementStyle.backgroundColor;

    if (document.getElementById("preview").style.backgroundColor != "") 
      objElementStyle.backgroundColor = document.getElementById("preview").style.backgroundColor;
    
    if(bgColor != objElementStyle.backgroundColor)
      changed = true;

    if(changed) {
      win.__editOnChanged(true);
    }
  } catch(Error) {
    if(isDebug)
      alert("An error occured in input page: " + Error);
  }
}

function initDialog(param)
{

  params = param;

  try {
	  language            = params[0];
	  design              = params[1];
	  mode                = params[2];
	  doc                 = params[4];
	  objElement          = params[5];
	  win                 = params[11];	  
	  userMode            = params[21];

    // set language strings
    setStrings();
    document.getElementById("lblMoreColors").value = getLanguageString("", 4087);
    
  } catch(Error) {}
} 

</SCRIPT> 
</HEAD>
<BODY class="bodypage">
        <fieldset>
          <legend class="head">
            <span id="4084" class="label">_color</span>
          </legend>   
          <div style="width:260px; height:150px; overflow:hidden; margin:0px; " id="border" align="left">   
          <table style="width:151px; " border="0" cellpadding="0" cellspacing="0" id="tblColor">
            <tr>
              <td colspan="8" style="font-size:5px; padding-bottom:5px;">&nbsp;</td>
            </tr>  
            <tr>
              <td colspan="8" align="center" style="background-color:#E0E0E0; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="noColorClick(this);"><span id="4086" class="label">_noColor</span>
              </td>
            </tr>
            <tr style="height:17px;">
              <td style="width:17px; background-color:#000000; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="colorClick(this);">&nbsp;
              </td>             
              <td style="width:17px; background-color:#993300; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="colorClick(this);">&nbsp;
              </td>
              <td style="width:17px; background-color:#333300; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="colorClick(this);">&nbsp;
              </td>
              <td style="width:17px; background-color:#003300; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="colorClick(this);">&nbsp;
              </td>
              <td style="width:17px; background-color:#003366; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="colorClick(this);">&nbsp;
              </td>
              <td style="width:17px; background-color:#000080; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="colorClick(this);">&nbsp;
              </td>
              <td style="width:17px; background-color:#333399; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="colorClick(this);">&nbsp;
              </td>
              <td style="width:17px; background-color:#333333; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="colorClick(this);">&nbsp;
              </td>                                                                                            
            </tr> 
            <tr style="height:17px;">
              <td style="background-color:#800000; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="colorClick(this);">&nbsp;
              </td>             
              <td style="background-color:#FF6600; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="colorClick(this);">&nbsp;
              </td>
              <td style="background-color:#808000; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="colorClick(this);">&nbsp;
              </td>
              <td style="background-color:#008000; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="colorClick(this);">&nbsp;
              </td>
              <td style="background-color:#008080; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="colorClick(this);">&nbsp;
              </td>
              <td style="background-color:#0000FF; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="colorClick(this);">&nbsp;
              </td>
              <td style="background-color:#666699; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="colorClick(this);">&nbsp;
              </td>
              <td style="background-color:#808080; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="colorClick(this);">&nbsp;
              </td>                                                                                            
            </tr> 
            <tr style="height:17px;">
              <td style="background-color:#FF0000; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="colorClick(this);">&nbsp;
              </td>             
              <td style="background-color:#FF9900; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="colorClick(this);">&nbsp;
              </td>
              <td style="background-color:#99CC00; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="colorClick(this);">&nbsp;
              </td>
              <td style="background-color:#339966; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="colorClick(this);">&nbsp;
              </td>
              <td style="background-color:#33CCCC; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="colorClick(this);">&nbsp;
              </td>
              <td style="background-color:#3366FF; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="colorClick(this);">&nbsp;
              </td>
              <td style="background-color:#800080; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="colorClick(this);">&nbsp;
              </td>
              <td style="background-color:#999999; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="colorClick(this);">&nbsp;
              </td>                                                                                            
            </tr>   
            <tr style="height:17px;">
              <td style="background-color:#FF00FF; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="colorClick(this);">&nbsp;
              </td>             
              <td style="background-color:#FFCC00; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="colorClick(this);">&nbsp;
              </td>
              <td style="background-color:#FFFF00; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="colorClick(this);">&nbsp;
              </td>
              <td style="background-color:#00FF00; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="colorClick(this);">&nbsp;
              </td>
              <td style="background-color:#00FFFF; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="colorClick(this);">&nbsp;
              </td>
              <td style="background-color:#00CCFF; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="colorClick(this);">&nbsp;
              </td>
              <td style="background-color:#993366; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="colorClick(this);">&nbsp;
              </td>
              <td style="background-color:#C0C0C0; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="colorClick(this);">&nbsp;
              </td>                                                                                            
            </tr>  
            <tr style="height:17px;">
              <td style="background-color:#FF99CC; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="colorClick(this);">&nbsp;
              </td>             
              <td style="background-color:#FFCC99; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="colorClick(this);">&nbsp;
              </td>
              <td style="background-color:#FFFF99; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="colorClick(this);">&nbsp;
              </td>
              <td style="background-color:#CCFFCC; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="colorClick(this);">&nbsp;
              </td>
              <td style="background-color:#CCFFFF; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="colorClick(this);">&nbsp;
              </td>
              <td style="background-color:#99CCFF; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="colorClick(this);">&nbsp;
              </td>
              <td style="background-color:#CC99FF; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="colorClick(this);">&nbsp;
              </td>
              <td style="background-color:#FFFFFF; border-left:solid 1px white; border-top:solid 1px white; border-right:solid 1px white; border-bottom:solid 1px white;" onclick="colorClick(this);">&nbsp;
              </td>                                                                                            
            </tr>  
            <tr>
              <td colspan="8" style="font-size:8px;">&nbsp;</td>
            </tr>   
            <tr>
              <td colspan="8" align="left">
                <input type="button" onclick="btnMoreColors();" id="lblMoreColors" value="_moreColors" />
              </td>
            </tr>                                        
          </table>
          
              </div>
          </fieldset>

</BODY>
