/*
Modification or decryption of this file is strictly forbidden - Pintexx GmbH
*/
var __comm;var __data;function Comm(target){this.comboid="";this.target=target;};Comm.prototype.execute=function(key,para,para2,para3){var html="";var url="";var iframe=null;if(this.target=="")return;if(this.target.toUpperCase().indexOf("HTTP")==0){url=this.target;}else{url=__editGetEditorUrl()+this.target;}html+="<html>";html+="<body>";html+="<form name='frmComm' id='frmComm' method ='POST' action='"+url+"'>";html+="<input type='hidden' id='key' name='key'>";html+="<input type='hidden' id='para' name='para'>";html+="<input type='hidden' id='para2' name='para2'>";html+="<input type='hidden' id='para3' name='para3'>";html+="</form>";html+="</body>";html+="</html>";if(!document.getElementById("__remote_frame")){iframe=document.createElement("IFRAME");iframe.id="__remote_frame";iframe.style.position="absolute";iframe.style.top=0;iframe.style.left=0;iframe.style.visibility="hidden";iframe.src="dummy.html";document.body.appendChild(iframe);}else{iframe=document.getElementById("__remote_frame");}var doc=iframe.contentWindow.document;doc.open();doc.write(html);doc.close();doc.getElementById("key").value=key;doc.getElementById("para").value=para;doc.getElementById("para2").value=para2;doc.getElementById("para3").value=para3;doc.getElementById("frmComm").submit();};Comm.prototype.executeSave=function(text,url){var html="";var pageUrl="";if(this.target=="")return;if(this.target.indexOf("..")==0 || this.target.toUpperCase().indexOf("HTTP")==0)pageUrl=this.target;else pageUrl=__editGetEditorUrl()+this.target;html="<html>";html+="<body>";html+="<form name='frmComm' id='frmComm' name='frmComm' method ='POST' action='"+pageUrl+"'>";html+="<input type='hidden' id='key' name='key' value=''>";html+="<input type='hidden' id='para' name='para' value=''>";html+="<input type='hidden' id='para2' name='para2' value=''>";html+="<input type='hidden' id='html' name='html' value=''>";html+="<input type='hidden' id='url' name='url' value=''>";html+="<input type='hidden' id='basepath' name='basepath' value=''>";html+="<input type='hidden' id='baseurl' name='baseurl' value=''>";if(globalSaveValue!="")html+="<input type='hidden' id='custom' name='custom' value=''>";html+="</form>";html+="</body>";html+="</html>";if(!document.getElementById("__remote_frame")){iframe=document.createElement("IFRAME");iframe.src="dummy.html";document.body.appendChild(iframe);iframe.id="__remote_frame";iframe.style.visibility="hidden";iframe.style.position="absolute";iframe.style.left=0;iframe.style.top=0;}else{iframe=document.getElementById("__remote_frame");}var doc=document.getElementById("__remote_frame").contentWindow.document;doc.open();doc.write(html);doc.close();doc.getElementById("html").value=text;doc.getElementById("url").value=url;doc.getElementById("key").value="SAVE";doc.getElementById("para").value=url;doc.getElementById("para2").value=text;var baseUrl="";var basePath="";if(globalDocumentUrlAbsolute==""){baseUrl=__editGetEditorWeb()+globalDocDir+"/";basePath=globalRootPath!="" ?(globalRootPath+globalDocDir+"/"): "";}else{baseUrl=globalDocumentUrlAbsolute;basePath=globalDocumentPathAbsolute;}doc.getElementById("basepath").value=basePath;doc.getElementById("baseurl").value=baseUrl;if(globalSaveValue!="")doc.getElementById("custom").value=globalSaveValue;doc.getElementById("frmComm").submit();};Comm.prototype.receive=function(key){if(key=='SAVE'){if(__data!=""){if(__data!="OK"){alert(__data);}else{if(__editReloadAfterSave){editLoad(__currentURLTemp);__editReloadAfterSave=false;}__editChanged=false;}eventOnAfterSave();}document.getElementById('__remote_frame').src='dummy.html';}if(key=='GETTEXT'){var aTexts=__data.split("~");var combo=null;try{combo=document.getElementById(__comm.comboid);}catch(Error){};if(combo!=null){while(combo.length){combo.remove(0);}for(var i=0;i<aTexts.length-1;i++){var aText=aTexts[i].split("|");var item=document.createElement("option");item.text=aText[0];item.value=aText[1];if(browser.ie)combo.add(item);else combo.add(item,null);}}document.getElementById('__remote_frame').src='dummy.html';eventOnProcessTM(aTexts);}if(key=='SETTEXT'){editGetTextModule(__comm.comboid);}if(key=='REMOVETEXT'){editGetTextModule(__comm.comboid);}if(key=='INTELLI'){__intelliProcess(__data);}if(key=='DOCX'){if(__data=="")alert("pinDocX not properly installed !");else editLoad(__data);}};Comm.prototype.loadFile=function(url){var iframe=null;if(!document.getElementById("__remote_frame_snip")){iframe=document.createElement("IFRAME");iframe.id="__remote_frame_snip";iframe.style.position="absolute";iframe.style.top=0;iframe.style.left=0;iframe.style.visibility="hidden";iframe.src="dummy.html";document.body.appendChild(iframe);if(browser.ie){iframe.attachEvent("onload",__editLoadSnippet);}else{iframe.addEventListener("load",__editLoadSnippet,false);}}else{iframe=document.getElementById("__remote_frame_snip");}iframe.src=url;__currentURL=url;};function __editLoadSnippet(){var iframe=document.getElementById("__remote_frame_snip");var html=iframe.contentWindow.document.body.innerHTML;editInsertHtml(html);}/*
Modification or decryption of this file is strictly forbidden - Pintexx GmbH
*/
function __NotSupportedByMozilla(){if(!browser.ie){alert("This feature is currently not supported !");return true;}else{return false;}};function callbackMozilla(mode,para1,para2){try{if(mode=="WEBIMAGE"){if(para1!="0"&&para1!=null){editRelativeCreateImage(para1);}}if(mode=="OPENDOC"){if(para1!="0"&&para1!=null){editLoad(para1);}}if(mode=="SAVEDOC"){editSave(para1);}if(mode=="OPENIMAGE"){if(para1!="0"&&para1!=null){editRelativeCreateImage(para1);}}if(mode=="TEXTMODULE"){__editCreateTextModule(para1);}if(mode=="FLASH"){if(para1!="0"&&para1!=null){var html="<table id='__embed' style='border: 1px solid #c0c0c0'><tr><td><EMBED style='height:100%;width:100%;' src='"+__editRelativeGetRelFromAbs(para1,"LINK")+"' type='application/x-shockwave-flash' pluginspage='http://www.macromedia.com/go/getflashplayer' loop='false' menu='false' quality='high' play='true'></td></tr></table>";editInsertHtml(html);__editRelativePrepareObject("EMBED",false);}}if(mode=="MEDIA"){if(para1!="0"&&para1!=null){var html="<table id='__embed' style='border: 1px solid #c0c0c0'><tr><td><EMBED style='height:100%;width:100%;' src='"+__editRelativeGetRelFromAbs(para1,"LINK")+"' type='application/x-mplayer2' pluginspage='http://download.microsoft.com/download/winmediaplayer/nsplugin/6.4/WIN98/EN-US/wmpplugin.exe'></td></tr></table>";editInsertHtml(html);__editRelativePrepareObject("EMBED",false);}}if(mode=="ANCHOR"){if(para1!="0"&&para1!=null){editInsertHtml("<a name='"+para1+"'></a>&nbsp;",false);__editShowSymbols();}}if(mode=="CSS"){editSetExternalStyleSheet(para1);}if(mode=="AUTOTEXT"){__comm=new Comm("");__comm.loadFile(para1);}}catch(Error){}};function __MozillaInsertLink(url){execute('createlink',false,url);};function __MozillaInsertNodeAtSelection(insertNode){__editOnChanged(true);var sel=getWindow().getSelection();var range=sel.getRangeAt(0);sel.removeAllRanges();range.deleteContents();var container=range.startContainer;var pos=range.startOffset;range=document.createRange();if(container.nodeType==3&&insertNode.nodeType==3){container.insertData(pos,insertNode.nodeValue);range.setEnd(container,pos+insertNode.length);range.setStart(container,pos+insertNode.length);}else{var afterNode;if(container.nodeType==3){var textNode=container;container=textNode.parentNode;var text=textNode.nodeValue;var textBefore=text.substr(0,pos);var textAfter=text.substr(pos);var beforeNode=document.createTextNode(textBefore);var afterNode=document.createTextNode(textAfter);container.insertBefore(afterNode,textNode);container.insertBefore(insertNode,afterNode);container.insertBefore(beforeNode,insertNode);container.removeChild(textNode);}else{afterNode=container.childNodes[pos];container.insertBefore(insertNode,afterNode);}range.setEnd(afterNode,0);range.setStart(afterNode,0);}sel.addRange(range);};function __MozillaInnerHTML(html){var sel=getWindow().getSelection();var range=sel.getRangeAt(0);sel.removeAllRanges();range.deleteContents();var insertNode=range.createContextualFragment(html);var container=range.startContainer;var pos=range.startOffset;range=document.createRange();if(container.nodeType==3&&insertNode.nodeType==3){container.insertData(pos,insertNode.nodeValue);range.setEnd(container,pos+insertNode.length);range.setStart(container,pos+insertNode.length);}else{var afterNode;if(container.nodeType==3){var textNode=container;container=textNode.parentNode;var text=textNode.nodeValue;var textBefore=text.substr(0,pos);var textAfter=text.substr(pos);var beforeNode=document.createTextNode(textBefore);var afterNode=document.createTextNode(textAfter);container.insertBefore(afterNode,textNode);container.insertBefore(beforeNode,afterNode);container.insertBefore(insertNode,afterNode);container.removeChild(textNode);}else{afterNode=container.childNodes[pos];container.insertBefore(insertNode,afterNode);}range.setEnd(afterNode,0);range.setStart(afterNode,0);}sel.addRange(range);};/*
Modification or decryption of this file is strictly forbidden - Pintexx GmbH
*/
var __editRelSeparator=";";function __editRelativePrepare(style){var modifyStyle=(style==false)?false : true;if(globalImagePathRelative!="")__editRelativePrepareObject('IMAGE');if(globalLinkPathRelative!=""){if(modifyStyle&&globalLinkPathRelative!=globalDefaultRelativePath)__editRelativePrepareObject('STYLE');__editRelativePrepareObject('LINK');__editRelativePrepareObject('EMBED');__editRelativePrepareObject('AREA');}};function __editRelativePrepareObject(mode,ai){var tag="";var attribute="";var afterInsert=ai?true:false;if(browser.ie&&mode=="EMBED")afterInsert=true;if(mode=="IMAGE"){tag="img";attribute="src";}else if(mode=="LINK"){tag="a";attribute="href";}else if(mode=="STYLE"){tag="link";attribute="href";}else if(mode=="EMBED"){tag="embed";attribute="src";}else if(mode=="AREA"){tag="area";attribute="href";}else{return;}var aObjects=getDoc().getElementsByTagName(tag);if(aObjects.length<=0)return;for(var i=0;i<aObjects.length;i++){var obj=aObjects[i];var saveid=obj.id;obj.id="__TEMP"+i;var html=obj.parentNode.innerHTML;var url="";var reg=new RegExp("<"+tag+"[^>]+>","gi");var result=html.match(reg);for(var j=0;j<result.length;j++){var tmp=result[j];tmp=tmp.replace(/&amp;/gi,"&");if(tmp.indexOf("__TEMP"+i)>0){if(afterInsert)var temp=new RegExp("<"+tag+"[^>]+"+attribute+"=([^ ]+) ","gi");else var temp=new RegExp("<"+tag+"[^>]+"+attribute+"=\"([^\"]+)\"","gi");temp.exec(tmp);url=RegExp.$1;url=url.replace(/ /gi,"%20");}}obj.id=saveid;if(url!=""){if(obj.id==""){obj.id="D#"+url;}else{if(obj.id.indexOf("D#")!=0&&obj.id.indexOf("I#")!=0)obj.id="I#"+__editRelSeparator+obj.id+__editRelSeparator+url;}absurl=__editRelativeGetAbsUrl(url,mode);try{if(mode=="LINK")savetext=obj.innerHTML;eval("obj."+attribute+"=absurl");if(mode=="LINK")obj.innerHTML=savetext;}catch(Error){}}else{if(obj.id=="")obj.removeAttribute("id","",0);}}if(afterInsert)getDoc().body.innerHTML=getDoc().body.innerHTML;};function __editRelativeGetAbsUrl(rel,mode){if(mode=="IMAGE"){url=globalImagePathRelative;}else if(mode=="LINK"||mode=="STYLE"||mode=="EMBED"||mode=="AREA"){url=globalLinkPathRelative;}else{return;}if(rel.substring(0,2)==".\/"){rel=rel.substring(2);}if(rel.substring(0,2)==".."){var result=rel.match(/../);var newBase=__editRelativeGetBase(url,result.length);var newRel=rel.substring(3*result.length);return newBase+newRel;}else if(rel.substring(0,1)=="\/"){if(globalRootUrl!=""){return globalRootUrl+rel.substring(1);}else{if(url.substring(url.length-1,url.length)=="/")return url+rel.substring(1);else return url+rel;}}else if(rel.toLowerCase().indexOf("http:")==0||rel.toLowerCase().indexOf("https:")==0||rel.toLowerCase().indexOf("ftp:")==0||rel.toLowerCase().indexOf("mailto:")==0||rel.toLowerCase().indexOf("file:")==0){return rel;}else if(rel.toLowerCase().indexOf("www.")==0){return "http://"+rel;}else if(rel.toLowerCase().indexOf("#")==0){return rel;}else if(rel.toLowerCase().indexOf("javascript")==0){return rel;}else if(rel.toLowerCase().indexOf("<!--")==0){return rel;}else{return url+rel;}};function __editRelativeGetBase(url,count){var pos=url.length;var temp=url.substring(0,pos-1);if(pos==0)return "";for(var i=0;i<count;i++){while(temp.charCodeAt(pos)!=47){pos--;if(pos==0)return "";}temp=temp.substring(0,pos);}return temp+"/";};function Position(html,start,end){this.html=html;this.start=start;this.end=end;};function __editRelativeHtml(htmlin){var ret=htmlin;if(globalImagePathRelative!="")ret=__editRelativeHtmlObject(ret,'IMAGE');if(globalLinkPathRelative!=""){ret=__editRelativeHtmlObject(ret,'LINK');ret=__editRelativeHtmlObject(ret,'STYLE');ret=__editRelativeHtmlObject(ret,'EMBED');ret=__editRelativeHtmlObject(ret,'AREA');}return ret;};function __editRelativeHtmlObject(html,mode){var tag="";var attribute="";var id="";if(mode=="IMAGE"){tag="img";attribute="src";}else if(mode=="LINK"){tag="a";attribute="href";}else if(mode=="STYLE"){tag="link";attribute="href";}else if(mode=="EMBED"){tag="embed";attribute="src";}else if(mode=="AREA"){tag="area";attribute="href";}else{return;}var arAll=new Array();var reg=new RegExp("<"+tag+" [^>]+>","gi");while((arr=reg.exec(html))!=null){id="";if(browser.ie){allIdxStart=RegExp.index;allIdxEnd=RegExp.lastIndex;}else{try{allIdxStart=arr.index;allIdxEnd=reg.lastIndex;}catch(Error){}}var obj=html.substring(allIdxStart,allIdxEnd);var ido=obj.toLowerCase().indexOf(" id=\"");if(ido>0){var idReg=new RegExp("id=\"([^\"]+)\"","gi");var idArr=idReg.exec(obj);id=RegExp.$1;if(id!=""){if(browser.ie){idIdxStart=RegExp.index+4;idIdxEnd=RegExp.lastIndex-1;}else{try{idIdxStart=idArr.index+4;idIdxEnd=idReg.lastIndex-1;}catch(Error){}}}}else{var ido=obj.toLowerCase().indexOf(" id=");if(ido>0){var tmp=obj.substring(ido+4);ido2=tmp.indexOf(" ");id=tmp.substring(0,ido2);if(id!=""){idIdxStart=ido+4;idIdxEnd=idIdxStart+ido2;}}}var urlReg=new RegExp(attribute+"=\"([^\"]+)\"","gi");var urlArr=urlReg.exec(obj);url=RegExp.$1;if(url!=""){if(browser.ie){urlIdxStart=RegExp.index+(attribute.length+2);urlIdxEnd=RegExp.lastIndex-1;}else{try{urlIdxStart=urlArr.index+(attribute.length+2);urlIdxEnd=urlReg.lastIndex-1;}catch(Error){}}if(id=="")newid="D#"+url;else newid="I#"+__editRelSeparator+id+__editRelSeparator+url;newurl=__editRelativeGetAbsUrl(url,mode);if(obj.toLowerCase().indexOf(attribute+"=\"")<obj.toLowerCase().indexOf("id=\"")){if(id!=""){temp=obj.substring(0,idIdxStart)+newid+obj.substring(idIdxEnd);}else{temp="<"+tag+" id=\""+newid+"\" "+obj.substring(tag.length+2);}temp=temp.substring(0,urlIdxStart)+newurl+temp.substring(urlIdxEnd);}else{temp=obj.substring(0,urlIdxStart)+newurl+obj.substring(urlIdxEnd);if(id!=""){temp=temp.substring(0,idIdxStart)+newid+temp.substring(idIdxEnd);}else{temp="<"+tag+" id=\""+newid+"\" "+temp.substring(tag.length+2);}}var pos=new Position(temp,allIdxStart,allIdxEnd);arAll[arAll.length]=pos;}}htmlnew=html;if(arAll.length>0){for(var i=arAll.length-1;i>=0;i--){var pos=arAll[i];htmlnew=htmlnew.substring(0,pos.start)+pos.html+htmlnew.substring(pos.end);}}if(globalRemoveCRLF){htmlnew=htmlnew.replace(/\r/gi,"");htmlnew=htmlnew.replace(/\n/gi,"");}return htmlnew;};function __editRelativeGetUrl(obj){var id=obj.id;if(id.indexOf("D#")==0){return id.substring(2);}else if(id.indexOf("I#")==0){var aTemp=id.split(__editRelSeparator);return aTemp[2];}else{if(obj.tagName.toUpperCase()=="IMG")return obj.src;else if(obj.tagName.toUpperCase()=="A")return obj.href;}};function __editRelativeGetUrl2(obj,attribute){var id=obj.id;if(id.indexOf("D#")==0){return id.substring(2);}else if(id.indexOf("I#")==0){var aTemp=id.split(__editRelSeparator);return aTemp[2];}else{return eval("obj."+attribute);}};function __editRelativeSetUrl(obj,url){if(url=="")return;if(obj.id.indexOf("D#")==0){obj.id="D#"+url;}else if(obj.id.indexOf("I#")==0){var aTemp=obj.id.split(__editRelSeparator);obj.id="I#"+__editRelSeparator+aTemp[1]+__editRelSeparator+url;}else if(obj.id==""){obj.id="D#"+url;}else{obj.id="I#"+__editRelSeparator+obj.id+__editRelSeparator+url;}if(obj.tagName.toUpperCase()=="IMG")obj.src=__editRelativeGetAbsUrl(url,"IMAGE");else if(obj.tagName.toUpperCase()=="A")obj.href=__editRelativeGetAbsUrl(url,"LINK");__editOnChanged(true);};function editRelativeCreateImage(url){url=url.replace(/ /gi,"%20");var absurl=__editRelativeGetAbsUrl(url,"IMAGE");if(url.toUpperCase().indexOf(globalImagePathRelative.toUpperCase())==0)relurl=url.substring(globalImagePathRelative.length);else relurl=url;var image=null;var border="";if(globalXHtmlType==0)border=" border=0 ";if(globalImagePathRelative!=""){editInsertHtml("<img id='D#"+relurl+"' src='"+absurl+"' alt='' "+border+">");image=getDoc().getElementById("D#"+relurl);}else{editInsertHtml("<img id='__tmpImage' src='"+absurl+"' alt='' "+border+">");image=getDoc().getElementById("__tmpImage");image.removeAttribute("id");}return image;};function __editRelativeGetRelFromAbs(url,mode){if(mode=="IMAGE"){if(url.toUpperCase().indexOf(globalImagePathRelative.toUpperCase())==0)relurl=url.substring(globalImagePathRelative.length);else relurl=url;}if(mode=="LINK"){if(url.toUpperCase().indexOf(globalLinkPathRelative.toUpperCase())==0)relurl=url.substring(globalLinkPathRelative.length);else relurl=url;}return relurl;};function __editRelativeSetId(obj,id){var url=__editRelativeGetUrl(obj);if(id=="")obj.id="D#"+url;else obj.id="I#"+__editRelSeparator+id+__editRelSeparator+url;};function __editRelativeGetId(obj){var id=obj.id;var value=id;if(id=="")return "";if(id.substring(0,2)=="D#"){value="";}else if(id.substring(0,2)=="I#"){id=id.split(__editRelSeparator);value=id[1];}return value;};function __editRelativeGetHtml(htmlin){var ret=htmlin;if(globalImagePathRelative!="")ret=__editRelativeGetHtmlObject(ret,'IMAGE');if(globalLinkPathRelative!=""){ret=__editRelativeGetHtmlObject(ret,'LINK');ret=__editRelativeGetHtmlObject(ret,'STYLE');ret=__editRelativeGetHtmlObject(ret,'EMBED');ret=__editRelativeGetHtmlObject(ret,'AREA');}return ret;};function __editRelativeGetHtmlObject(html,mode){var tag="";var attribute="";var useIDHigh=false;var useUrlHigh=false;if(mode=="IMAGE"){tag="img";attribute="src";useIDHigh=false;useUrlHigh=true;}else if(mode=="LINK"){tag="a";attribute="href";useIDHigh=false;useUrlHigh=true;}else if(mode=="STYLE"){tag="link";attribute="href";useIDHigh=false;useUrlHigh=true;}else if(mode=="EMBED"){tag="embed";attribute="src";useIDHigh=false;useUrlHigh=false;}else if(mode=="AREA"){tag="area";attribute="href";useIDHigh=false;useUrlHigh=true;}else{return;}if(!browser.ie){useIDHigh=true;useUrlHigh=true;}var arAll=new Array();html=html.replace(/-->/,"--&gt;");var reg=new RegExp("<"+tag+" [^>]+>","gi");while((arr=reg.exec(html))!=null){if(browser.ie){allIdxStart=RegExp.index;allIdxEnd=RegExp.lastIndex;}else{try{allIdxStart=arr.index;allIdxEnd=reg.lastIndex;}catch(Error){}}var obj=html.substring(allIdxStart,allIdxEnd);if(useIDHigh)var idReg=new RegExp("id=\"([^\"]+)\"","gi");else var idReg=new RegExp("id=([^ ]+)","gi");var idArr=idReg.exec(obj);id=RegExp.$1;if(id.substring(id.length-1,id.length)=="\"")id=id.substring(0,id.length-1);if(id.indexOf("\"")==0)id=id.substring(1);if(id.indexOf("D#")==0||id.indexOf("I#")==0){if(browser.ie){idIdxStart=RegExp.index;idIdxEnd=RegExp.lastIndex;}else{try{idIdxStart=idArr.index;idIdxEnd=idReg.lastIndex;}catch(Error){}}if(useUrlHigh)var urlReg=new RegExp(attribute+"=\"([^\"]+)\"","gi");else var urlReg=new RegExp(attribute+"=([^ ]+)","gi");var urlArr=urlReg.exec(obj);url=RegExp.$1;if(url!=""){var soffset=useUrlHigh?(attribute.length+2):(attribute.length+1);var eoffset=useUrlHigh?-1 : 0;if(browser.ie){urlIdxStart=RegExp.index+soffset;urlIdxEnd=RegExp.lastIndex+eoffset;}else{try{urlIdxStart=urlArr.index+soffset;urlIdxEnd=urlReg.lastIndex+eoffset;}catch(Error){}}var newurl="";if(id.indexOf("D#")==0){newurl=id.substring(2);id="";}else if(id.indexOf("I#")==0){var aTemp=id.split(__editRelSeparator);newurl=aTemp[2];id=aTemp[1];}temp=obj.substring(0,urlIdxStart)+newurl+obj.substring(urlIdxEnd);if(id==""){temp=temp.substring(0,idIdxStart)+temp.substring(idIdxEnd);}else{temp=temp.substring(0,idIdxStart+3)+"'"+id+"'"+temp.substring(idIdxEnd);}var pos=new Position(temp,allIdxStart,allIdxEnd);arAll[arAll.length]=pos;}}}htmlnew=html;if(arAll.length>0){for(var i=arAll.length-1;i>=0;i--){var pos=arAll[i];htmlnew=htmlnew.substring(0,pos.start)+pos.html+htmlnew.substring(pos.end);}}htmlnew=htmlnew.replace(/--\&gt;/,"-->");return htmlnew;};/*
Modification or decryption of this file is strictly forbidden - Pintexx GmbH
*/
function editOpen(mode,localPath){var editorUrl=__editGetEditorUrl();var type="OPEN";var filter="";var width=710;var height=500;if(mode==0){parent.editFile.click();}if(mode==1 || mode==4 || mode==5 || mode==6 || mode==7 || mode==8){__editPrepareParams();if(mode==1){type="OPEN";filter=globalDialogFilterDoc;}else if(mode==4){type="OPEN";filter="swf;";}else if(mode==5){type="OPEN";filter="avi;wmv;mov;mp3;mpeg;";}else if(mode==6){type="OPEN";filter="htm;html;";__editMozParam[16]=globalTemplateUrlAbsolute;__editMozParam[17]=globalTemplatePathAbsolute;}else if(mode==7){type="OPEN";filter="htm;html;snip;";__editMozParam[16]=globalAutoTextUrlAbsolute;__editMozParam[17]=globalAutoTextPathAbsolute;}else if(mode==8){type="OPEN";filter="css;";__editMozParam[16]="";__editMozParam[17]="";try{__editMozParam[16]=globalStyleUrlAbsolute;__editMozParam[17]=globalStylePathAbsolute;}catch(Error){}if(__editMozParam[16]=="")__editMozParam[16]=globalDocumentUrlAbsolute;if(__editMozParam[17]=="")__editMozParam[17]=globalDocumentPathAbsolute;}__editMozParam[2]=type;__editMozParam[9]=filter;__editMozParam[19]=mode;__editMozParam[20]=__editSelectedDialogPath[mode];if(browser.ie){var path=window.showModalDialog(editorUrl+"server/"+globalTechnology+"/dialog.html",__editMozParam,"dialogHeight:"+height+"px;dialogWidth:"+width+"px;resizable:1;status:0;scroll:0");if(path!="0" && path!=null){if(mode==1){if(path.toLowerCase().indexOf(".docx")>0){__comm=new Comm("server/aspx/docx.aspx");__comm.execute("DOCX",path,globalDocumentUrlAbsolute,globalDocumentPathAbsolute);}else{editLoad(path);}}else if(mode==4){var html="<embed id=\"__tmp_flash\" src=\""+__editRelativeGetRelFromAbs(path,"LINK")+"\" contenteditable=\"false\" type='application/x-shockwave-flash' wmode=\"transparent\" pluginspage='http://www.macromedia.com/go/getflashplayer' loop='false' menu='false' quality='high' play='true'>";editInsertHtml(html);var flash=getDoc().getElementById("__tmp_flash");flash.removeAttribute("id","",0);__editRelativePrepareObject("EMBED",true);try{eventOnAfterInsertObject("FLASH",flash);}catch(Error){}}else if(mode==5){var html="<embed id=\"__tmp_media\" src=\""+__editRelativeGetRelFromAbs(path,"LINK")+"\" type='application/x-mplayer2' pluginspage='http://download.microsoft.com/download/winmediaplayer/nsplugin/6.4/WIN98/EN-US/wmpplugin.exe'>";editInsertHtml(html);var media=getDoc().getElementById("__tmp_media");media.removeAttribute("id","",0);__editRelativePrepareObject("EMBED",true);try{eventOnAfterInsertObject("MEDIA",media);}catch(Error){}}else if(mode==6){editLoad(path);}else if(mode==7){__comm=new Comm("");__comm.loadFile(path);}else if(mode==8){editSetExternalStyleSheet(path);}}}else{var left=screen.width/2-width/2;var top=screen.height/2-height/2;window.open(editorUrl+"server/"+globalTechnology+"/dialog.html","color","modal=1,left="+left+",top="+top+",height="+height+",width="+width+",resizable=1,status=0,scrollbars=0");}}if(mode==2){setPropertyValue("editPath",localPath);invokeMethodInModel("onLoad");}if(mode==3){__editPrepareParams();__editMozParam[2]="IMAGE";__editMozParam[19]=mode;__editMozParam[20]=__editSelectedDialogPath[mode];if(browser.ie){var path=window.showModalDialog(editorUrl+"server/"+globalTechnology+"/dialog.html",__editMozParam,"dialogHeight:"+height+"px;dialogWidth:"+width+"px;resizable:1;status:0;scroll:0");if(path!="0" && path!=null){var image=editRelativeCreateImage(path);__editOnChanged(true);try{eventOnAfterInsertObject("IMAGE",image);}catch(Error){}}}else{var left=screen.width/2-width/2;var top=screen.height/2-height/2;window.open(editorUrl+"server/"+globalTechnology+"/dialog.html","color","modal=1,left="+left+",top="+top+",height="+height+",width="+width+",resizable=1,status=0,scrollbars=0");}}if(mode==9){var width=800;var height=400;var left=screen.width/2-width/2;var top=screen.height/2-height/2;window.open(__editGetEditorUrl()+"server/"+globalTechnology+"/autotext."+globalTechnology+"?lg="+language+"&st="+design+"&iu="+globalImageUrlAbsolute+"&ip="+globalImagePathAbsolute+"&au="+globalAutoTextUrlAbsolute+"&ap="+globalAutoTextPathAbsolute,"color","modal=1,left="+left+",top="+top+",height="+height+",width="+width+",resizable=1,status=0,scrollbars=0");return;}if(browser.ie)editSetFocus();};function editSaveDialog(html,mode){var editorUrl=__editGetEditorUrl();var width=400;var height=500;__editPrepareParams();__editMozParam[2]="SAVE";__editMozParam[9]=globalDialogFilterDoc;__editMozParam[19]=(mode==null ? 1:mode);__editMozParam[20]=__editSelectedDialogPath[(mode==null ? 1:mode)];if(browser.ie){var path=window.showModalDialog(editorUrl+"server/"+globalTechnology+"/dialog.html",__editMozParam,"dialogHeight:"+height+"px;dialogWidth:"+width+"px;resizable:1;status:0;scroll:0");if(path!="0" && path!=null){__currentURLTemp=path;__editReloadAfterSave=true;editSave(path,html);}}else{var left=screen.width/2-width/2;var top=screen.height/2-height/2;window.open(editorUrl+"server/"+globalTechnology+"/dialog.html","color","modal=1,left="+left+",top="+top+",height="+height+",width="+width+",resizable=1,status=0,scrollbars=0");}};function editLink(param){var editorUrl=__editGetEditorUrl();var dialogUrl="";var curObject=null;var mode=(param > 0)? 1:0;if(globalUserMode=="0")dialogUrl=editorUrl+"mode/html/dialogs/frame.html";else dialogUrl=editorUrl+"mode/wp/dialogs/frame.html";try{if(__editActiveObject.tagName.toUpperCase()=="HTML")__editActiveObject=getDoc().body;__editPrepareParams();__editMozParam[2]="LINK";__editMozParam[9]=globalDialogFilterLink;var selType=editGetSelectionType();if(selType=="NONE"){curObject=__editActiveObject;var aTags=__editGetTagHierarchy(curObject,1);for(var i=0;i<aTags.length;i++){if(aTags[i].tagName.toLowerCase()=="a"){curObject=aTags[i];break;}}if(curObject.tagName.toLowerCase()!="a"){alert(getLanguageString(language,3012));return false;}__editMozParam[3]="0";__editMozParam[5]=curObject;}else if(selType=="CONTROL"){if(browser.ie){var range=getDoc().selection.createRange();if(range.length > 1){alert("Please select only one object !");return false;}else{if(range(0).tagName.toUpperCase()!="IMG"){alert("You can set links only to images !");return false;}}}curObject=__editActiveObject;var aTags=__editGetTagHierarchy(__editActiveObject,1);for(var i=0;i<aTags.length;i++){if(aTags[i].tagName.toLowerCase()=="a"){curObject=aTags[i];break;}}if(curObject.tagName.toLowerCase()=="a")__editMozParam[3]="0";else __editMozParam[3]="1";__editMozParam[5]=curObject;}else{if(browser.ie){var curLink=null;var range=getDoc().selection.createRange();var parentElement=range.parentElement();if(parentElement.tagName.toLowerCase()=="a"){curLink=parentElement;}else{var allChilds=parentElement.getElementsByTagName("*");for(var i=0;i<allChilds.length;i++){if(allChilds[i].tagName.toLowerCase()=="a"){curLink=allChilds[i];var rangeOfLink=getDoc().body.createTextRange();rangeOfLink.moveToElementText(curLink);if(range.inRange(rangeOfLink))break;}}if(curLink){var rangeOfLink=getDoc().body.createTextRange();rangeOfLink.moveToElementText(curLink);if(!range.inRange(rangeOfLink)){curLink=null;}}if(curLink==null){var aTags=__editGetTagHierarchy(parentElement,1);for(var i=0;i<aTags.length;i++){if(aTags[i].tagName.toLowerCase()=="a"){curLink=aTags[i];break;}}}}if(curLink){__editMozParam[3]="0";__editMozParam[5]=curLink;editSelectText(curLink);}else{__editMozParam[3]="1";__editMozParam[5]=range;}}else{var curLink=null;var sel=getWindow().getSelection();var range=sel.getRangeAt(0);var parentNode=range.commonAncestorContainer;if(parentNode.nodeType==3){var aTags=__editGetTagHierarchy(parentNode.parentNode,1);for(var i=0;i<aTags.length;i++){if(aTags[i].tagName.toLowerCase()=="a"){curLink=aTags[i];break;}}}else{var allNodes=parentNode.getElementsByTagName("*");for(var i=0;i<allNodes.length;i++){if(allNodes[i].tagName.toLowerCase()=="a"){if(range.compareNode(allNodes[i])==3){curLink=allNodes[i];break;}}}}if(curLink){__editMozParam[3]="0";__editMozParam[5]=curLink;range.selectNodeContents(curLink);}else{__editMozParam[3]="1";__editMozParam[5]=null;}}}if(mode==0){if(browser.ie){var values=window.showModalDialog(dialogUrl,__editMozParam,"dialogHeight:"+(400+globalDialogOffset)+"px;dialogWidth:400px;resizable:0;status:0;scroll:0");editSetFocus();}else{var left=screen.width/2-400/2;var top=screen.height/2-400/2;window.open(dialogUrl,"color","modal=1,left="+left+",top="+top+",height=350,width=400,resizable=0,status=0,scrollbars=0");}}}catch(error){};return true;};function editProperties(type,inFile,inAttribute,width,height){var editorUrl=__editGetEditorUrl();var file="";var attribute="";objSelected=editGetActiveObject();__editPrepareParams();if(type==6){if(__NotSupportedByMozilla())return;__editMozParam[2]="IFRAME";__editMozParam[5]=objSelected;file=editorUrl+"mode/html/dialogs/iframe.html";if(inFile)file=inFile;attribute="dialogHeight:"+(200+globalDialogOffset)+"px;dialogWidth:300px;resizable:0;status:0;scroll:0";if(inAttribute)attribute=inAttribute;var values=window.showModalDialog(file,__editMozParam,attribute);editSetFocus();return;}if(type==8){if(globalUserMode=="0")file=editorUrl+"mode/html/dialogs/anchor.html";else file=editorUrl+"mode/wp/dialogs/anchor.html";if(inFile)file=inFile;__editMozParam[2]="ANCHOR";__editMozParam[5]=objSelected.id;if(browser.ie){attribute="dialogHeight:"+(120+globalDialogOffset)+"px;dialogWidth:400px;resizable:0;status:0;scroll:0";if(inAttribute)attribute=inAttribute;var values=window.showModalDialog(file,__editMozParam,attribute);}else{var left=screen.width/2-400/2;var top=screen.height/2-120/2;window.open(file,"anchor","modal=1,left="+left+",top="+top+",height=120,width=400,resizable=0,status=0,scrollbars=0");}if(browser.ie)editSetFocus();return;}if(type==12){if(__NotSupportedByMozilla())return;__editMozParam[2]="FLASH";__editMozParam[5]=objSelected;file=editorUrl+"mode/html/dialogs/flash.html";if(inFile)file=inFile;attribute="dialogHeight:"+(396+globalDialogOffset)+"px;dialogWidth:290px;resizable:0;status:0;scroll:0";if(inAttribute)attribute=inAttribute;var values=window.showModalDialog(file,__editMozParam,attribute);editSetFocus();return;}if(type==0){__editMozParam[2]="TABLE";__editMozParam[5]=__editCurrentTable;}if(type==2){__editPrepareTableObjects();__editMozParam[2]="CELL";__editMozParam[5]=currentCol;}if(type==3){__editMozParam[2]="IMAGE";__editMozParam[5]=objSelected;}if(type==4){__editMozParam[2]="BODY";__editMozParam[5]=getDoc().body;}if(type==5){__editMozParam[2]="DIV";__editMozParam[5]=objSelected;}if(type==7){__editMozParam[2]="P";__editMozParam[5]=objSelected;}if(type==9){__editMozParam[2]="FORM";__editMozParam[5]=objSelected;}if(type==10){__editMozParam[2]="INPUT";__editMozParam[5]=objSelected;}if(type==11){__editMozParam[2]="SELECT";__editMozParam[5]=objSelected;}if(type==13){__editMozParam[2]="TEXTAREA";__editMozParam[5]=objSelected;}if(type==14){__editMozParam[2]="CHAR";__editMozParam[5]=objSelected;}if(type==15){__editMozParam[2]="BORDER";__editMozParam[5]=objSelected;}if(type==18){__editMozParam[2]="HR";__editMozParam[5]=objSelected;}if(globalUserMode=="0")file=editorUrl+"mode/html/dialogs/frame.html";else file=editorUrl+"mode/wp/dialogs/frame.html";if(type==19){__editMozParam[2]="OL";__editMozParam[5]=objSelected;file=editorUrl+"dialogs/listframe.html";}if(type==20){__editMozParam[2]="UL";__editMozParam[5]=objSelected;file=editorUrl+"dialogs/listframe.html";}if(inFile)file=inFile;if(browser.ie){attribute="dialogHeight:"+((height!=null ? height:420)+globalDialogOffset)+"px;dialogWidth:"+(width!=null ? width:400)+"px;resizable:0;status:0;scroll:0";if(inAttribute)attribute=inAttribute;var values=window.showModalDialog(file,__editMozParam,attribute);}else{var left=screen.width/2-(width!=null ? width:420)/2;var top=screen.height/2-(height!=null ? height:400)/2;var win=window.open(file,"table","modal=1,left="+left+",top="+top+",height="+(height!=null ? height:420)+",width="+(width!=null ? width:400)+",resizable=0,status=0,scrollbars=0");win.focus();}};function editStyleSheet(){var editorUrl=__editGetEditorUrl();var height=430;var width=600;__editPrepareParams();if(globalUserMode=="0")file=editorUrl+"mode/html/dialogs/css.html";else file=editorUrl+"mode/wp/dialogs/css.html";if(browser.ie){var values=window.showModalDialog(file,__editMozParam,"dialogHeight:"+((height!=null ? height:420)+globalDialogOffset)+"px;dialogWidth:"+(width!=null ? width:400)+"px;resizable:0;status:0;scroll:0;");}else{var left=screen.width/2-(width!=null ? width:420)/2;var top=screen.height/2-(height!=null ? height:400)/2;var win=window.open(file,"table","modal=1,left="+left+",top="+top+",height="+(height!=null ? height:420)+",width="+(width!=null ? width:400)+",resizable=0,status=0,scrollbars=0");win.focus();}};function editUpload(path,url,mode,insert){if(insert){insert="1";}else{insert="0";}var web=__editGetEditorUrl();var width=400;var height=125;if(globalUsePinUpload && insert=="0"){width=660;height=330;}var left=screen.width/2-width/2;var top=screen.height/2-height/2;var baseUrl="";var basePath="";if(path!=""){basePath=path;baseUrl=url;}else{if(mode==0){if(globalImageUrlAbsolute==""){baseUrl=__editGetEditorWeb()+globalImageDir+"/";basePath=globalRootPath!="" ?(globalRootPath+globalImageDir+"/"): "";}else{baseUrl=globalImageUrlAbsolute;basePath=globalImagePathAbsolute;}}if(mode==1){if(globalDocumentUrlAbsolute==""){baseUrl=__editGetEditorWeb()+globalDocDir+"/";basePath=globalRootPath!="" ?(globalRootPath+globalDocDir+"/"): "";}else{baseUrl=globalDocumentUrlAbsolute;basePath=globalDocumentPathAbsolute;}}}__editPrepareParams();__editMozParam[2]=insert;__editMozParam[6]=baseUrl;__editMozParam[7]=basePath;if(mode==1)__editMozParam[9]=globalDialogFilterDoc;__editUploadMode=mode;__editUploadUrl=baseUrl;__editUploadPath=basePath;if(!globalUsePinUpload || insert=="1"){if(globalTechnology.toLowerCase()=="aspx")window.open(web+"server/"+globalTechnology+"/upload.aspx","","modal=1,left="+left+",top="+top+",height="+height+",width="+width+",resizable=0,status=0,scrollbars=0");else window.open(web+"server/"+globalTechnology+"/upload.html","","modal=1,left="+left+",top="+top+",height="+height+",width="+width+",resizable=0,status=0,scrollbars=0");}else{var lng="";if(language.toLowerCase()=="de"){lng="de";}else{lng="en";}var docfilter=globalDialogFilterDoc.replace(/;/gi,",");var imgfilter=globalDialogFilterImage.replace(/;/gi,",");var params="?lng="+lng+"&edurl="+web+"&path="+basePath+"&url="+baseUrl+"&docfilter="+docfilter+"&imgfilter="+imgfilter;window.open(web+"server/"+globalTechnology+"/pupload."+globalTechnology+params,"","modal=1,left="+left+",top="+top+",height="+height+",width="+width+",resizable=0,status=0,scrollbars=0");}};function editUploadInsert(path,url,mode){editUpload(path,url,mode,1);};function callback_editUpload(file,newUrl){if(newUrl!=null && newUrl!=__editUploadUrl){__editUploadUrl=newUrl;}__editUploadedFile=__editUploadUrl+file;if(__editUploadMode==0){editRelativeCreateImage(__editUploadedFile);}else{var absurl=__editRelativeGetAbsUrl(__editUploadedFile,"LINK");eventOnAfterInsertDocument(absurl);}};function editChar(){var dialogUrl=__editGetEditorUrl()+"dialogs/char.html";__editPrepareParams();if(browser.ie){window.showModalDialog(dialogUrl,__editMozParam,"dialogHeight:"+(344+globalDialogOffset)+"px;dialogWidth:520px;resizable:0;status:0;scroll:0");}else{var left=screen.width/2-520/2;var top=screen.height/2-355/2;window.open(dialogUrl,"color","modal=1,left="+left+",top="+top+",height=355,width=520,resizable=0,status=0,scrollbars=0");}}/*
Modification or decryption of this file is strictly forbidden - Pintexx GmbH
*/
var __xhtml="";function __editGetXHtmlBody(nodoctype){return editGetXHtml("1",nodoctype);};function __editGetXHtml(mode,nodoctype,isUpdated){try{__xhtml="";var isHtmlUpdated=isUpdated ? true:false;var doc=getDoc();if(__intisetemp)__editLave();if(editGetMode()=="HTML"){if(!isHtmlUpdated)__editUpdateFromHTMLArea();}if(!browser.ie){var doc=getDoc();doc.body.style.backgroundColor=null;if(doc.body.style.cssText=="")doc.body.removeAttribute("style");}var head=doc.getElementsByTagName("head")[0];if(head){if(head.firstChild==null){var title=doc.createElement("title");head.appendChild(title);}}__editSetSpaceInTables(true);__editAddParagraphSpace();__editHideSymbols();__editRemoveMSMetaTag();var childs;if(mode==1){childs=doc.body.childNodes;}else{__editRemoveMSMetaTag();childs=doc.childNodes;}var len=childs.length;for(var i=0;i<len;i++){__editXHtmlProcessNode(childs[i],nodoctype);}if(nodoctype){a=1;}else{if(__xhtml.toUpperCase().indexOf("!DOCTYPE HTML PUBLIC")< 0)__xhtml=globalXHtmlDocType+__xhtml;}__xhtml=__xhtml.replace(/\r/,"");__xhtml=__xhtml.replace(/\n/,"");if(browser.ie){__xhtml=__editRemovePlaceHolder(__xhtml);}else{var reg=new RegExp("<br id=\"_ph_\">","gi");__xhtml=__xhtml.replace(reg,"");}if(globalConvertChar)__xhtml=__editConvertCode(__xhtml);var data=__xhtml;document.getElementById('__editData').value=data;__editSetSpaceInTables(false);__editShowSymbols();__editSetPlaceHolders();__editSetBodyBackground();}catch(Error){if(globalDebug){alert("__editGetXHtml: "+Error);}}return data;};function __editXHtmlProcessNode(node,nodoctype){switch(node.nodeType){case 1: if(node.nodeName=="!"){__xhtml=__xhtml+node.text;break;}var name=node.nodeName;if(node.nodeName=="")name="unknown";name=name.toLowerCase();if(browser.ie){if(node.scopeName=="HTML"){name=name.toLowerCase();}else{name=node.scopeName+":"+name;}}var showTag=true;if(name=="tbody" &&!globalShowTBodyTag){showTag=false;}if(!browser.ie && name=="br"){if(node.id=="_ph_"){showTag=false;}}if(showTag){__xhtml=__xhtml+"<"+name;var attributes=node.attributes;var len=attributes.length;var tagName=node.tagName.toLowerCase();if(tagName!="option" && tagName!="br" && tagName!="html"){for(var j=0;j<len;j++){var attributeNode=attributes[j];var attribName=attributeNode.nodeName.toLowerCase();var attribValue="";try{attribValue=node.getAttribute(attribName);}catch(Error){attribValue=node.nodeValue;}if(tagName=="body" && attribName=="contenteditable"){}else{if(!browser.ie && attribName.indexOf("_moz")>=0){a=1;}else{if(attributeNode.specified){if(!browser.ie && tagName=="input" && attribName=="type"){if((node.type=="checkbox" || node.type=="radio")&& node.checked)__xhtml=__xhtml+" checked=\"checked\"";if(node.type=="text" && node.value!="")__xhtml=__xhtml+" value=\""+node.value+"\"";}if(tagName=="input" && attribName=="checked"){if(attribValue)__xhtml=__xhtml+" checked=\"checked\"";}else{__getAttributes(attributeNode,node);}}else{switch(tagName){case "input": if(attribName=="value" || attribName=="type" || attribName=="name")__getAttributes(attributeNode,node);break;case "img": if(attribName=="vspace" && attribValue!="0")__getAttributes(attributeNode,node);break;case "area": if(attribName=="coords" || attribName=="shape")__getAttributes(attributeNode,node);break;default: break;}if(attribValue!=null)switch(attribName){case "onload","onmouseup","onmousedown","onkeypress","onkeyup","onkeydown","onmouseout","onmouseover","onmousemove","ondblclick","onchange","onselect","onclick": __getAttributes(attributeNode,node);default: break;}}}}}}else if(tagName=="br"){}else if(tagName=="html"){__xhtml=__xhtml+" xmlns=\"http://www.w3.org/1999/xhtml\"";}else{try{var value=node.getAttribute("value");__xhtml=__xhtml+" value=\""+__checkAttribute(value)+"\"";if(node.getAttribute("selected"))__xhtml=__xhtml+" selected";}catch(Error){}}if(node.canHaveChildren || node.hasChildNodes()){__xhtml=__xhtml+">";var __childs=node.childNodes;len=__childs.length;for(var j=0;j<len;j++)__editXHtmlProcessNode(__childs[j],nodoctype);__xhtml=__xhtml+"</"+name+">";}else if(name=="script"){__xhtml=__xhtml+">"+node.text+"</"+name+">";}else if(name=="title" || name=="style" || name=="comment" || name=="head"){if(name=="title")__xhtml=__xhtml+">"+editReplaceSpecialChar(node.innerHTML)+"</"+name+">";else __xhtml=__xhtml+">"+node.innerHTML+"</"+name+">";}else{if(nodoctype)__xhtml=__xhtml+">";else __xhtml=__xhtml+" />";}}break;case 3: var value=node.nodeValue;temp=value.replace(/<!--/g,":::lt:::");temp=temp.replace(/-->/g,":::gt:::");value=editReplaceSpecialChar(temp);value=value.replace(/:::lt:::/g,"<!--");value=value.replace(/:::gt:::/g,"-->");__xhtml=__xhtml+value;break;case 4: __xhtml=__xhtml+"<![CDA"+"TA[\n"+node.nodeValue+"\n]"+"]>";break;case 8: var temp="";if(browser.ie){temp=node.text;}else{temp="<!-- "+node.nodeValue+" -->";}__xhtml=__xhtml+temp;break;case 9: var curChilds=node.childNodes;len=curChilds.length;for(var j=0;j<len;j++)__editXHtmlProcessNode(curChilds[j],nodoctype);break;default: __xhtml=__xhtml;}};function __checkAttribute(s){return String(s).replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/\"/g, "&quot;");};function __checkText(s){var temp=s;temp=temp.replace(/\&/g,"&amp;");temp=temp.replace(/</g,"&lt;");temp=temp.replace(/>/g,"&gt;");return temp;};function __getAttributes(attributeNode,node){var tagName=node.tagName.toLowerCase();var attribName=attributeNode.nodeName.toLowerCase();var name=attributeNode.nodeName;var value=attributeNode.nodeValue;if((tagName=="img" && name.toLowerCase()=="id")||(tagName=="a" && name.toLowerCase()=="id")||(tagName=="link" && name.toLowerCase()=="id")||(tagName=="embed" && name.toLowerCase()=="id")||(tagName=="area" && name.toLowerCase()=="id")){if(value.substring(0,2)=="D#"){return;}else if(value.substring(0,2)=="I#"){value=value.split(__editRelSeparator);value=value[1];}}if((tagName=="img" && name.toLowerCase()=="src")||(tagName=="a" && name.toLowerCase()=="href")||(tagName=="link" && name.toLowerCase()=="href")||(tagName=="embed" && name.toLowerCase()=="src")||(tagName=="area" && name.toLowerCase()=="href")){var id=node.id;if(id.substring(0,2)=="D#"){value=id.substring(2);}else if(id.substring(0,2)=="I#"){id=id.split(__editRelSeparator);value=id[2];}}if(name!="style"){if(!isNaN(value))value=node.getAttribute(name);__xhtml=__xhtml+" "+(attributeNode.expando ? name : name.toLowerCase())+"=\""+__checkAttribute(value)+"\"";}else{var css=node.style.cssText.toLowerCase();if(css.indexOf("rgb")>=0){var startPos=0;var newCSS=css;while(newCSS.indexOf("rgb",startPos)>=0){startPos=newCSS.indexOf("rgb");var endPos=newCSS.indexOf(")",startPos);var color=newCSS.substring(startPos,endPos+1);var hex=rgbToHex(color);newCSS=newCSS.substring(0,startPos)+hex+newCSS.substring(endPos+1);}css=newCSS;}__xhtml=__xhtml+" style=\""+__checkAttribute(css).toLowerCase()+"\"";}};/*
Modification or decryption of this file is strictly forbidden - Pintexx GmbH
*/
function __editPrepareTableObjects(){try{currentRow=null;currentCol=null;var curObject=editGetActiveObject();var aTags=__editGetTagHierarchy(curObject,1);for(var i=0;i<aTags.length;i++){var tag=aTags[i].tagName.toLowerCase();curObject=aTags[i];if(tag=="th"||tag=="td"||tag=="tr"||tag=="table"){if(tag=="th"||tag=="td"||tag=="tr"){var parent=curObject;while(parent.tagName!="TABLE"){parent=parent.parentNode;}__editCurrentTable=parent;}if(tag=="th"||tag=="td"){currentRow=curObject.parentNode;currentCol=curObject;}if(tag=="tr")currentRow=curObject;if(tag=="table"){__editCurrentTable=curObject;}return true;}}return false;}catch(Error){return false;}};function editCreateTable(row,col){var temp="";var style="";var space="";var table="";if(!browser.ie)space="<br id='_ph_'>";if(globalStaticTables)table="table-layout:fixed;";if(globalUserMode=="0"){temp="<table style='"+table+"width:200px' cellspacing='1' cellpadding='0' border='1'>";style="valign='top'";}else{temp="<table style='"+table+"border-collapse:collapse;border:1px solid black;width:200px' cellspacing='0' cellpadding='0' border='0'>";style="valign='top' style='border: 1px solid black'";}for(var i=0;i<row;i++){temp+="<tr>";for(var j=0;j<col;j++){if(globalFirstTableRowIsHeader&&i==0){temp+="<th "+style+">"+space+"</th>";}else{temp+="<td "+style+">"+space+"</td>";}}temp+="</tr>";}temp+="</table>";if(browser.ie){editInsertBlockHtml(temp);}else{editInsertHtml(temp);}__editOnChanged(true);};function __editInsertRow(mode){try{if(!__editPrepareTableObjects())return;var space="";if(!browser.ie)space="<br id='_ph_'>";var newRow=currentRow.cloneNode(true);var aCells=currentRow.cells;for(var i=0;i<aCells.length;i++){aCells[i].innerHTML=space;}if(mode==1)currentRow.parentNode.insertBefore(newRow,currentRow);else currentRow.parentNode.insertBefore(newRow,currentRow.nextSibling);}catch(Error){};__editOnChanged(true);__editHidePopup();};function __editDeleteRow(){try{if(!__editPrepareTableObjects())return;currentRow.parentNode.removeChild(currentRow);}catch(Error){};__editOnChanged(true);__editHidePopup();};function __editConvertRow(){try{if(!__editPrepareTableObjects())return;for(var i=0;i<currentRow.cells.length;i++){var cell=currentRow.cells[i];if(cell.tagName=="TD"){var th=getDoc().createElement("th");th.innerHTML=cell.innerHTML;currentRow.replaceChild(th,cell);}if(cell.tagName=="TH"){var td=getDoc().createElement("td");td.innerHTML=cell.innerHTML;currentRow.replaceChild(td,cell);}}__editOnChanged(true);}catch(Error){};__editHidePopup();};function __editInsertColumn(mode){try{if(!__editPrepareTableObjects())return;index=currentCol.cellIndex;var space="";if(!browser.ie)space="<br id='_ph_'>";for(var i=0;i<__editCurrentTable.rows.length;i++){var tr=__editCurrentTable.rows[i];var curtd=tr.cells[index];var newtd=curtd.cloneNode(true);newtd.id="__tmpTD";newtd.innerHTML=space;if(mode==0)tr.insertBefore(newtd,curtd);else tr.insertBefore(newtd,curtd.nextSibling);}var newTD=getDoc().getElementById("__tmpTD");newTD.removeAttribute("id","",0);editSelectText(newTD);}catch(Error){};__editOnChanged(true);__editHidePopup();};function __editDeleteColumn(){try{if(!__editPrepareTableObjects())return;var index=currentCol.cellIndex;for(var i=0;i<__editCurrentTable.rows.length;i++){var tr=__editCurrentTable.rows[i];var curtd=tr.cells[index];tr.removeChild(curtd);}if(__editCurrentTable.rows[0].cells.length>0){editSelectText(__editCurrentTable.rows[0].cells[index]);}var isColumn=false;for(var i=0;i<__editCurrentTable.rows.length;i++){if(__editCurrentTable.rows[i].cells.length>0){isColumn=true;}}if(!isColumn){__editRemoveNode(__editCurrentTable);__editCurrentTable=null;}}catch(Error){};__editOnChanged(true);__editHidePopup();};function __editDeleteCell(){try{if(!__editPrepareTableObjects())return;currentRow.removeChild(currentCol);}catch(Error){};__editOnChanged(true);__editHidePopup();};function __editColSpan(){try{if(!__editPrepareTableObjects())return;var colspan1=__editCurrentTable.rows[currentRow.rowIndex].cells[currentCol.cellIndex].colSpan;var colspan2=__editCurrentTable.rows[currentRow.rowIndex].cells[currentCol.cellIndex+1].colSpan;__editCurrentTable.rows[currentRow.rowIndex].cells[currentCol.cellIndex].innerHTML=__editCurrentTable.rows[currentRow.rowIndex].cells[currentCol.cellIndex].innerHTML+__editCurrentTable.rows[currentRow.rowIndex].cells[currentCol.cellIndex+1].innerHTML;__editCurrentTable.rows[currentRow.rowIndex].deleteCell(currentCol.cellIndex+1);__editCurrentTable.rows[currentRow.rowIndex].cells[currentCol.cellIndex].colSpan=(colspan1+colspan2);}catch(Error){};__editOnChanged(true);__editHidePopup();};function __editDivideCell(){if(!__editPrepareTableObjects())return;__editBuildTableMatrix();try{var space="";if(!browser.ie)space="<br id='_ph_'>";if(currentCol.colSpan>1){currentCol.colSpan=currentCol.colSpan-1;var newtd=getDoc().createElement("td");newtd.innerHTML=space;currentRow.insertBefore(newtd,currentCol);}else{var index=currentCol.cellIndex;for(var i=0;i<__editCurrentTable.rows.length;i++){var tr=__editCurrentTable.rows[i];if(currentRow.rowIndex==i){var newtd=getDoc().createElement("td");newtd.innerHTML=currentCol.innerHTML;tr.insertBefore(newtd,currentCol);currentCol.innerHTML="";}else{var el=__editGetMatrixElement(i,index);var curtd=tr.cells[el];curtd.colSpan=curtd.colSpan+1;}}}}catch(Error){};__editOnChanged(true);__editHidePopup();};function __editRemoveTable(){try{if(!__editPrepareTableObjects())return;var range=getDoc().createRange();var referenceNode=getDoc().body;range.selectNode(referenceNode);__editCurrentTable.parentNode.removeChild(__editCurrentTable);}catch(Error){};__editOnChanged(true);__editHidePopup();};function __editRowSpan(){try{if(!__editPrepareTableObjects())return;var rowspan=__editCurrentTable.rows[currentRow.rowIndex].cells[currentCol.cellIndex].rowSpan;var html=__editCurrentTable.rows[currentRow.rowIndex+rowspan].cells[currentCol.cellIndex].innerHTML;__editCurrentTable.rows[currentRow.rowIndex+rowspan].deleteCell(currentCol);__editCurrentTable.rows[currentRow.rowIndex].cells[currentCol.cellIndex].rowSpan=rowspan+1;var curHtml=__editCurrentTable.rows[currentRow.rowIndex].cells[currentCol.cellIndex].innerHTML;__editCurrentTable.rows[currentRow.rowIndex].cells[currentCol.cellIndex].innerHTML=curHtml+html;}catch(Error){};__editOnChanged(true);__editHidePopup();};function __editAddCell(){try{if(!__editPrepareTableObjects())return;var cells=__editCurrentTable.rows[currentRow.rowIndex].cells.length;if(currentRow.rowIndex>=1){var cellAll=__editCurrentTable.rows[currentRow.rowIndex-1].cells.length;if(cellAll>cells)__editCurrentTable.rows[currentRow.rowIndex].insertCell(cells);}else if(__editCurrentTable.rows.length-1>currentRow.rowIndex){var cellAll=__editCurrentTable.rows[__editCurrentTable.rows.length-1].cells.length;if(cellAll>cells)__editCurrentTable.rows[currentRow.rowIndex].insertCell(cells);}}catch(Error){};__editOnChanged(true);__editHidePopup();};var __editTableMatrix=null;function __editBuildTableMatrix(){__editTableMatrix=new Array(__editCurrentTable.rows.length-1);for(var i=0;i<__editCurrentTable.rows.length;i++){var tr=__editCurrentTable.rows[i];var aCell=new Array();var curCol=0;for(var j=0;j<tr.cells.length;j++){var colspan=tr.cells[j].colSpan;if(colspan==1){aCell[curCol]=j;curCol++;}else{for(var k=0;k<colspan;k++){aCell[curCol]=j;curCol++;}}}__editTableMatrix[i]=aCell;}};function __editGetMatrixElement(row,col){var cells=__editTableMatrix[row];return cells[col];};function __editSetTableBorder(value){try{var currentTable=editGetActiveObject();if(globalUserMode=="0"){currentTable.border=value?"1":"0";editSetTableHighlight(!value);}else{if(value){for(var j=0;j<currentTable.rows.length;j++){var currentRow=currentTable.rows[j];for(var k=0;k<currentRow.cells.length;k++){var curCell=currentRow.cells[k];curCell.style.borderStyle="solid";curCell.style.borderColor="black";curCell.style.borderWidth="1px";}}currentTable.style.borderStyle="solid";currentTable.style.borderColor="black";currentTable.style.borderWidth="1px";}else{for(var j=0;j<currentTable.rows.length;j++){var currentRow=currentTable.rows[j];for(var k=0;k<currentRow.cells.length;k++){var curCell=currentRow.cells[k];curCell.style.borderStyle="dotted";curCell.style.borderColor=globalHighlightColor;curCell.style.borderWidth="1px";}}currentTable.style.borderStyle="";currentTable.style.borderColor="";currentTable.style.borderWidth="";}}__editOnChanged(true);}catch(Error){if(globalDebug){alert("__editSetTableBorder: "+Error);}}};function editTableHighlight(value){__editTableHighlight=value;};function editSetTableHighlight(value){if(!__editTableHighlight)return;var isActive=value?true: false;var highlightActive=false;try{var aTables=getDoc().getElementsByTagName("table");if(isActive){for(i=0;i<aTables.length;i++){currentTable=aTables[i];highlightActive=false;var hasBorderWidth=(currentTable.style.borderWidth==""||currentTable.style.borderWidth==null||parseInt(currentTable.style.borderWidth)==0)?false:true;if(!hasBorderWidth&&currentTable.border==0){for(var j=0;j<currentTable.rows.length;j++){var currentRow=currentTable.rows[j];for(var k=0;k<currentRow.cells.length;k++){var curCell=currentRow.cells[k];var curBorder="";if(browser.ie)curBorder=editGetCurrentStyle(curCell,"borderTopWidth");else curBorder=editGetCurrentStyle(curCell,"border-top-width");if(curBorder=="medium"||parseInt(curBorder)==0||curBorder==""){__editSetTableHighlightCell(curCell,"borderTop");highlightActive=true;}if(browser.ie)curBorder=editGetCurrentStyle(curCell,"borderLeftWidth");else curBorder=editGetCurrentStyle(curCell,"border-left-width");if(curBorder=="medium"||parseInt(curBorder)==0){__editSetTableHighlightCell(curCell,"borderLeft");highlightActive=true;}if(browser.ie)curBorder=editGetCurrentStyle(curCell,"borderRightWidth");else curBorder=editGetCurrentStyle(curCell,"border-right-width");if(curBorder=="medium"||parseInt(curBorder)==0){__editSetTableHighlightCell(curCell,"borderRight");highlightActive=true;}if(browser.ie)curBorder=editGetCurrentStyle(curCell,"borderBottomWidth");else curBorder=editGetCurrentStyle(curCell,"border-bottom-width");if(curBorder=="medium"||parseInt(curBorder)==0){__editSetTableHighlightCell(curCell,"borderBottom");highlightActive=true;}}}}if(highlightActive){}}if(!browser.ie){if(globalUserMode==1)currentTable.style.borderCollapse="collapse";}}else{if(!browser.ie)currentTable.style.borderCollapse="";for(i=0;i<aTables.length;i++){currentTable=aTables[i];for(var j=0;j<currentTable.rows.length;j++){var currentRow=currentTable.rows[j];for(var k=0;k<currentRow.cells.length;k++){var curCell=currentRow.cells[k];if(browser.ie)color=curCell.style.borderTopColor;else color=(rgbToHex(curCell.style.borderTopColor)).toLowerCase();if(color==globalHighlightColor){curCell.style.borderTopStyle="";curCell.style.borderTopColor="";curCell.style.borderTopWidth="";}if(browser.ie)color=curCell.style.borderLeftColor;else color=(rgbToHex(curCell.style.borderLeftColor)).toLowerCase();if(color==globalHighlightColor){curCell.style.borderLeftStyle="";curCell.style.borderLeftColor="";curCell.style.borderLeftWidth="";}if(browser.ie)color=curCell.style.borderRightColor;else color=(rgbToHex(curCell.style.borderRightColor)).toLowerCase();if(color==globalHighlightColor){curCell.style.borderRightStyle="";curCell.style.borderRightColor="";curCell.style.borderRightWidth="";}if(browser.ie)color=curCell.style.borderBottomColor;else color=(rgbToHex(curCell.style.borderBottomColor)).toLowerCase();if(color==globalHighlightColor){curCell.style.borderBottomStyle="";curCell.style.borderBottomColor="";curCell.style.borderBottomWidth="";}if(curCell.style.cssText==""){curCell.removeAttribute("style");}}}}}var aDiv=getDoc().getElementsByTagName("div");if(isActive){for(i=0;i<aDiv.length;i++){if(parseInt(aDiv[i].style.borderWidth)==0){aDiv[i].style.borderStyle="dotted";aDiv[i].style.borderColor=globalHighlightColor;aDiv[i].style.borderWidth="1px";}}}else{for(i=0;i<aDiv.length;i++){if(aDiv[i].style.borderColor==globalHighlightColor){aDiv[i].style.borderStyle="";aDiv[i].style.borderColor="";aDiv[i].style.borderWidth="";}}}}catch(Error){}};function __editSetTableHighlightCell(curCell,styleName){if(browser.ie){curCell.style[styleName+"Style"]="dotted";curCell.style[styleName+"Color"]=globalHighlightColor;curCell.style[styleName+"Width"]="1px";}else{eval("curCell.style."+styleName+"Style='dotted'");eval("curCell.style."+styleName+"Color='"+globalHighlightColor+"'");eval("curCell.style."+styleName+"Width='1px'");}};/*
Modification or decryption of this file is strictly forbidden - Pintexx GmbH
*/
function __editGetEditorId(){return window.frameElement.id;};function __editGetEditorUrl(){if(globalEditorUrl!=""){return globalEditorUrl;}else{var url=document.location.href;var pos=url.toLowerCase().indexOf("/editor/");return url.substring(0,pos+8);}};function __editGetEditorWeb(){if(globalRootUrl!=""){return globalRootUrl;}else{var url=document.location.href;var pos=url.indexOf("/editor/");return url.substring(0,pos+1);}};function __editGetServer(){try{return document.location.protocol+"//"+document.location.host;}catch(Error){return "";}};function globalGetPositonY(obj){var y=0;var parent=obj;while(parent.tagName.toUpperCase()!="BODY"){y=y+parent.offsetTop;parent=parent.offsetParent;}return y;};function globalGetPositonX(obj){var x=0;var parent=obj;while(parent.tagName.toUpperCase()!="BODY"){x=x+parent.offsetLeft;parent=parent.offsetParent;}return x;};function __editGetIframePositionX(iframe){if(iframe.style.position.toUpperCase()=="ABSOLUTE"){return parseInt(iframe.style.left);}else{var parent=iframe;var x=0;while(parent.tagName.toUpperCase()!="BODY"){x=x+parent.offsetLeft;parent=parent.offsetParent;}return parseInt(x);}};function __editGetIframePositionY(iframe){if(iframe.style.position.toUpperCase()=="ABSOLUTE"){return parseInt(iframe.style.top);}else{var parent=iframe;var y=0;while(parent.tagName.toUpperCase()!="BODY"){y=y+parent.offsetTop;parent=parent.offsetParent;}return parseInt(y);}};function __editGetObjectWidth(obj){if(browser.ie){return obj.offsetWidth;}else{return obj.offsetWidth;}};function __editGetObjectHeight(obj){if(browser.ie){return obj.offsetHeight;}else{return obj.offsetHeight;}};function MakeString(){this.pos=0;this.add=__string_add;this.get=__string_get;this.aString=new Array();};function __string_add(sString){if(sString=="")return;this.aString[this.pos++]=String(sString);};function __string_get(){return this.aString.join("");};function Pair(key,value){this.name=key;this.key=key;this.value=value;};function Triple(key,value,value2){this.name=key;this.key=key;this.value=value;this.value2=value2;};function Quad(name,key,value,value2){this.name=name;this.key=key;this.value=value;this.value2=value2;};function UndoStruct(html,range){this.html=html;this.range=range;};function StyleStruct(displayName,className,displayHtml){this.displayName=displayName;this.className=className;this.displayHtml=displayHtml;};function ReturnStruct4(para1,para2){this.para1=para1;this.para2=para2;};/*
Modification or decryption of this file is strictly forbidden - Pintexx GmbH
*/
function Selection(doc){this.doc=doc;this.hasP=false;this.textOnly=false;this.callback=null;this.selectedObjects=null;this.selectedTag="";this.selectedFull=false;this.debug=false;this.getSelection=n_4;this.getRange=_p0;this.createRange=$9C;this.getParent=DfD8;this.clear=R5_5;this.getType=qK9h5;this.prepareTypeDetails=$v27;this.getSelectedHtml=N3205;this.insertHtml=L41;this.getSelectedText=j7483;this.getActiveObject=m0i;this.getSelectedObjects=IFP;this.prepareSelection=U9303;this.selectObject=n95k;this.setCursorToObject=a5c4;this.setCursorToText=WIT9;this.unselect=Hn1R;this.processEnter=nM1u2;this.Lb7=Bqy1;this.A3629=_2Bv;this.__getTagHierarchy=m41;this.__replace_text_object=C0i7;this.__replace_text_objects=P90Ow;this.__selection_divide=_$LK_;this.__selection_reset=__selection_reset;this.__replace_node=n_1e;this.__remove_node=_58;this.__setMarkers=Si9$;this.__iterate=s8MN;this.__iterate_node=hT4;this.__cb_selected_objects=PLV4;this.__cb_selection_prepare=S493;this.__prepare_paragraph=k29b;this._8475=(navigator.userAgent.toLowerCase().indexOf("msie")!=-1);this.type=this.getType();this.initCallback=0;this.startSelectionNode=null;this.endSelectionNode=null;};function Hn1R(){try{var i8w60=this.getSelection();if(this._8475){i8w60.empty();}else{i8w60.removeAllRanges();var range=this.createRange();range.selectNode(this.doc.body.firstChild);range.collapse(true);i8w60.removeAllRanges();i8w60.addRange(range);}}catch(Error){if(this.debug){alert("unselect Range: "+Error);}}};function n_4(){try{if(this._8475)return this.doc.selection;else return document.getElementById('pinEdit').contentWindow.getSelection();}catch(Error){if(this.debug){alert("getSelection: "+Error);}}};function _p0(){try{if(this._8475)return this.getSelection().createRange();else return this.getSelection().getRangeAt(0);}catch(Error){if(this.debug){alert("getRange: "+Error);}}};function $9C(){try{if(this._8475)return this.doc.body.createTextRange();else return this.doc.createRange();}catch(Error){if(this.debug){alert("createRange: "+Error);}}return null;};function R5_5(){try{if(this._8475){if(this.type!="NONE")this.getSelection().clear();}else{var i8w60=this.getSelection();for(var i=0;i<i8w60.rangeCount;i++ ){i8w60.getRangeAt(i).deleteContents();}}}catch(Error){if(this.debug){alert("clear: "+Error);}}};function DfD8(){try{var L2T2=null;if(this._8475){var X9b09=this.getRange();var fv8=this.getSelectedHtml();var MmIe=fv8.toLowerCase().split("<p");if(MmIe.length > 1){L2T2=X9b09.parentElement();if(L2T2.tagName.toLowerCase()!="body")L2T2=L2T2.parentNode;}else{L2T2=X9b09.parentElement();}}else{var i8w60=this.getSelection();if(i8w60.anchorNode==i8w60.focusNode){L2T2=i8w60.anchorNode.parentNode;}else{var range=this.getRange();if(i8w60.anchorNode.parentNode.tagName.toLowerCase()=="body"){L2T2=this.doc.body;}else if(i8w60.focusNode.parentNode.tagName.toLowerCase()=="body"){L2T2=this.doc.body;}else{var ri64=this.__getTagHierarchy(i8w60.anchorNode.parentNode);var P83=this.__getTagHierarchy(i8w60.focusNode.parentNode);var $2C4U=false;for(var i=0;i<ri64.length;i++){for(var y74S=0;y74S<P83.length;y74S++){if(ri64[i]==P83[y74S]){L2T2=ri64[i];$2C4U=true;break;}}if($2C4U)break;}if(!L2T2)L2T2=this.doc.body;}}}}catch(Error){if(this.debug){alert("getParent: "+Error);}}return L2T2;};function qK9h5(){try{var type="";if(this._8475){type=this.getSelection().type.toUpperCase();if(type=="TEXT"){var I0n=this.getRange().text;if(I0n==""){type="NONE";}}}else{var i8w60=this.getSelection();if(i8w60!=""){type="TEXT";}else{if(i8w60.rangeCount > 0){var range=i8w60.getRangeAt(0);if(range.startContainer.nodeType!=1){type="NONE";}else if(range.startContainer==range.endContainer){if((range.endOffset-range.startOffset)==1){type="CONTROL";}else{type="NONE";}}else{type="NONE";}}}}}catch(Error){type="NONE";}return type;};function $v27(){try{var html=this.getSelectedHtml();if(html.indexOf("<")< 0 && html.indexOf(">")< 0){this.textOnly=true;}else{this.textOnly=false;}if(html.toLowerCase().indexOf("<p")>=0){this.hasP=true;}else{this.hasP=false;}}catch(Error){}};function N3205(){var html="";try{if(this.type=="NONE")return "";if(this._8475){if(this.type=="CONTROL"){html=this.getActiveObject().outerHTML;}else{var range=this.doc.selection.createRange();html=range.htmlText;}}else{var Y17=document.createElement("div");var range=this.getRange().cloneRange();var WG_ly=range.cloneContents();Y17.appendChild(WG_ly);html=Y17.innerHTML;}}catch(Error){if(this.debug){alert("getSelectedHtml: "+Error);}}document.getElementById('__editData').value=html;return html;};function j7483(){var text="";if(this._8475){if(this.type=="TEXT"){text=this.getRange().text;}}else{}return text;};function L41(html){try{if(this._8475){this.clear();var range=this.getRange();range.pasteHTML(html);}else{var Y17=this.doc.createElement("div");var i8w60=this.getSelection();var range=this.getRange();Y17.innerHTML=html;range.deleteContents();var _2$X=this.doc.createRange();_2$X.selectNodeContents(Y17);var WG_ly=_2$X.cloneContents();range.insertNode(WG_ly);range.detach();}}catch(Error){if(this.debug){alert("insertHtml: "+Error);}}};function m0i(L15){var Jt_X=null;var tagName=L15 ? L15 : "";try{if(this.type=="CONTROL"){if(this._8475){var X9b09=this.getRange();Jt_X=X9b09(0);}else{var i8w60=this.getSelection();Jt_X=i8w60.anchorNode.childNodes[i8w60.anchorOffset];}if(tagName){if(Jt_X.tagName.toLowerCase()!=tagName){var IAF=this.__getTagHierarchy(Jt_X);for(var i=0;i<IAF.length;i++){if(IAF[i].tagName.toLowerCase()==tagName){Jt_X=IAF[i];break;}}}}}else if(this.type=="NONE"){Jt_X=this.getParent();if(tagName){var IAF=this.__getTagHierarchy(Jt_X);for(var i=0;i<IAF.length;i++){if(IAF[i].tagName.toLowerCase()==tagName){Jt_X=IAF[i];break;}}}}}catch(Error){if(this.debug){alert("getActiveObject: "+Error);}}return Jt_X;};function m41(Jt_X){var O7w9=new Array();try{while(Jt_X.tagName.toLowerCase()!="body"){O7w9[O7w9.length]=Jt_X;Jt_X=Jt_X.parentNode;}}catch(Error){}return O7w9;};function IFP(bCdf,L15){var o8$=new Array();var QQ1=bCdf ? true:false;var tagName=L15 ? L15 : "";try{var tK23=this.type;if(tK23=="CONTROL"){var Jt_X=this.getActiveObject();o8$[o8$.length]=Jt_X;var XNs=Jt_X.getElementsByTagName("*");if(XNs.length > 0){for(var i=0;i<XNs.length;i++){o8$[o8$.length]=XNs[i];}}}else if(tK23=="NONE"){return o8$;}else{var range=this.getRange();var L2T2=this.getParent();var L2j=L2T2.getElementsByTagName("*");var inRange=this.createRange();if(this._8475){inRange.moveToElementText(L2T2);if(range.isEqual(inRange)){if(tagName!=""){if(tagName==L2T2.tagName.toLowerCase())o8$[o8$.length]=L2T2;}else{o8$[o8$.length]=L2T2;}for(var i=0;i<L2j.length;i++){if(tagName!=""){if(tagName==L2j[i].tagName.toLowerCase())o8$[o8$.length]=L2j[i];}else{o8$[o8$.length]=L2j[i];}}return o8$;}var inRange=this.createRange();for(var i=0;i<L2j.length;i++){inRange.moveToElementText(L2j[i]);if(range.inRange(inRange)){if(tagName!=""){if(tagName==L2j[i].tagName.toLowerCase())o8$[o8$.length]=L2j[i];}else{o8$[o8$.length]=L2j[i];}}else{if(QQ1){if(range.compareEndPoints("StartToEnd",inRange)=="-1" && range.compareEndPoints("EndToStart",inRange)=="1"){if(tagName!=""){if(tagName==L2j[i].tagName.toLowerCase())o8$[o8$.length]=L2j[i];}else{o8$[o8$.length]=L2j[i];}}}}}}else{this.selectedObjects=new Array();this.selectedTag=tagName;this.selectedFull=QQ1;this.callback=this.__cb_selected_objects;this.__setMarkers();this.__iterate();this.__selection_reset();o8$=this.selectedObjects;this.selectedObjects=new Array();}}}catch(Error){if(this.debug){alert("getSelectedObjects: "+Error);}}return o8$;};function PLV4(ST3){var E_tx3=this.doc.getElementById("__tmp_end");if(ST3==E_tx3)return true;if(ST3.nodeType!=3){if(this.selectedTag!=""){if(this.selectedTag==ST3.tagName.toLowerCase())this.selectedObjects[this.selectedObjects.length]=ST3;}else{this.selectedObjects[this.selectedObjects.length]=ST3;}}return false;};function Si9$(){try{var y3NdW=null;var ll23=null;var O1OT="#";if(this._8475){var range=this.getRange();var TA0e=range.duplicate();TA0e.collapse(true);TA0e.pasteHTML("<span id='__tmp_start'>"+O1OT+"</span>");y3NdW=this.doc.getElementById("__tmp_start");var PXx0=range.duplicate();PXx0.collapse(false);PXx0.pasteHTML("<span id='__tmp_end'>"+O1OT+"</span>");ll23=this.doc.getElementById("__tmp_end");}else{var i8w60=this.getSelection();var range=null;var TA0e=null;var PXx0=null;if(i8w60.rangeCount > 1){TA0e=i8w60.getRangeAt(0).cloneRange();PXx0=i8w60.getRangeAt(i8w60.rangeCount-1).cloneRange();}else{range=this.getRange();TA0e=range.cloneRange();PXx0=range.cloneRange();}if((i8w60.anchorNode==i8w60.focusNode)&& i8w60.anchorNode.nodeType==3 && i8w60.focusNode.nodeType==3){var I42=range.startContainer;var text=I42.nodeValue.substring(range.startOffset,range.endOffset);var WG_ly=this.doc.createDocumentFragment();var _pD=this.doc.createElement("span");_pD.id="__tmp_start";_pD.innerHTML=O1OT;WG_ly.appendChild(_pD);var textNode=this.doc.createTextNode(text);WG_ly.appendChild(textNode);var E_tx3=this.doc.createElement("span");E_tx3.id="__tmp_end";E_tx3.innerHTML=O1OT;WG_ly.appendChild(E_tx3);this.clear();range.insertNode(WG_ly);}else{var _pD=this.doc.createElement("span");_pD.id="__tmp_start";_pD.innerHTML=O1OT;if(TA0e.startContainer.nodeType!=3 && TA0e.startContainer.tagName.toLowerCase()=="tr"){var currentRow=TA0e.startContainer;var cell=currentRow.cells[TA0e.startOffset];var R0L84=cell.firstChild;if(R0L84!=null){cell.insertBefore(_pD,R0L84);}else{cell.appendChild(_pD);}}else{TA0e.collapse(true);TA0e.insertNode(_pD);}var E_tx3=this.doc.createElement("span");E_tx3.id="__tmp_end";E_tx3.innerHTML=O1OT;if(PXx0.endContainer.nodeType!=3 && PXx0.endContainer.tagName.toLowerCase()=="p"){PXx0.endContainer.appendChild(E_tx3);}else if(PXx0.endContainer.nodeType!=3 && PXx0.endContainer.tagName.toLowerCase()=="tr"){var currentRow=PXx0.endContainer;var cell=currentRow.cells[PXx0.startOffset];cell.appendChild(E_tx3);}else{PXx0.collapse(false);PXx0.insertNode(E_tx3);}}}}catch(Error){if(this.debug){alert("setMarkers: "+Error);}}};function S493(ST3){var E_tx3=this.doc.getElementById("__tmp_end");if(ST3==E_tx3)return true;if(ST3.nodeType==3){var text=ST3.nodeValue;text=text.replace(/\n/,"");text=text.replace(/\r/,"");if(text=="")return false;if(text=="\xA0")return false;}this.selectedObjects[this.selectedObjects.length]=ST3;return false;};function U9303(XKO6n){try{var _12A=XKO6n ? true : false;this.selectedObjects=new Array();this.callback=this.__cb_selection_prepare;this.__setMarkers();this.__iterate();var cmk=new Array();for(var i=0;i<this.selectedObjects.length;i++){var c1X=true;var ST3=this.selectedObjects[i];if(ST3.nodeType==3){var parent=ST3.parentNode;if(parent.tagName.toLowerCase()=="span"){if(parent.childNodes.length==1 && parent.firstChild.nodeType==3){c1X=false;}else{var _sCQp=this.__selection_divide(parent,ST3);c1X=false;cmk[cmk.length]=_sCQp;}}if(c1X){var _sCQp=this.__replace_text_object(ST3,true);cmk[cmk.length]=_sCQp;}}else{if(ST3.tagName.toLowerCase()=="span" || ST3.tagName.toLowerCase()=="li")cmk[cmk.length]=ST3;}}var range=this.createRange();if(!_12A)this.__selection_reset(range);this.selectedObjects=new Array();}catch(Error){if(this.debug){alert("Error in __selection_prepare: "+Error);}}return cmk;};function C0i7(ST3,mode){var w20=mode ? true:false;var R1G=this.doc.createElement("span");var text=ST3.nodeValue;text=text.replace(/\n/,"");text=text.replace(/\r/,"");if(text!=""){if(text.substring(0,1)==" ")R1G.innerHTML="&nbsp;"+text.substring(1);else R1G.innerHTML=text;if(w20)this.__replace_node(ST3,R1G);return R1G;}return null;};function P90Ow(y3NdW,ll23){var o8$=new Array();var ST3=y3NdW.nextSibling;while(ST3!=ll23){var $v67$=ST3.nextSibling;if(ST3.nodeType==3){var XV6g$=this.__replace_text_object(ST3,true);if(XV6g$!=null)o8$[o8$.length]=XV6g$;}else if(ST3.nodeType==1){o8$[o8$.length]=ST3;}ST3=$v67$;}return o8$;};function hn$3(y3NdW,ll23){var ST3=y3NdW;while(ST3!=ll23){if(ST3.nodeType!=3)return true;ST3=ST3.nextSibling;}return false;};function _$LK_(parent,Jt_X){var E063h=parent.style.cssText;var WGG7=null;var id=parent.id;try{var WG_ly=this.doc.createDocumentFragment();for(var i=0;i<parent.childNodes.length;i++){var ST3=parent.childNodes[i];if(ST3.nodeType==3){var _sCQp=this.__replace_text_object(ST3,false);}else{_sCQp=ST3.cloneNode(true);}if(_sCQp!=null){WG_ly.appendChild(_sCQp);if(E063h!="")_sCQp.style.cssText=E063h;if(parent.className!=""){_sCQp.className=parent.className;}if(id!=""){if(_sCQp.id!="__tmp_start" && _sCQp.id!="__tmp_end")_sCQp.id=id;}}if(ST3==Jt_X)WGG7=_sCQp;}this.__replace_node(parent,WG_ly);}catch(Error){alert(Error)}return WGG7;};function __selection_reset(range){try{if(!range || range=="undefined")range=this.createRange();var startSelectionNode=this.doc.getElementById("__tmp_start");if(!startSelectionNode)return;var endSelectionNode=this.doc.getElementById("__tmp_end");if(!endSelectionNode)return;if(this._8475){var L3m1=this.doc.body.createTextRange();L3m1.moveToElementText(startSelectionNode);var Q1_M6=this.doc.body.createTextRange();Q1_M6.moveToElementText(endSelectionNode);range.setEndPoint("StartToStart",L3m1);range.setEndPoint("EndToEnd",Q1_M6);range.select();}else{var i8w60=this.getSelection();var range=this.createRange();var ks1=startSelectionNode;var Q41=endSelectionNode;range.setStart(ks1,0);range.setEnd(Q41,0);i8w60.addRange(range);}}catch(Error){if(this.debug){alert("SelectionReset: "+Error);}}this.__remove_node(startSelectionNode);this.__remove_node(endSelectionNode);};function _58(jk1){try{if(jk1){if(this._8475)jk1.removeNode(true);else jk1.parentNode.removeChild(jk1);}}catch(Error){if(this.debug){alert("RemoveNode: "+Error);}}};function n95k(object,mode){try{if(this._8475){if(mode==0){var range=this.doc.body.createControlRange();range.add(object);range.select();}if(mode==1){var range=this.createRange();range.moveToElementText(object);range.select();}}else{var i8w60=this.getSelection();var range=this.createRange();range.selectNode(object);i8w60.removeAllRanges();i8w60.addRange(range);}}catch(Error){}};function a5c4(object){try{if(this._8475){var range=this.createRange();var add=false;if(object.innerHTML==""){object.innerHTML="&zwnj;";add=true;}range.moveToElementText(object);this.getSelection().clear();range.collapse(false);range.select();if(add)object.innerHTML="";}else{var i8w60=this.getSelection();var range=this.createRange();if(object.innerHTML=="")object.innerHTML="<br id='_ph_'>";range.selectNodeContents(object);range.collapse(true);i8w60.removeAllRanges();i8w60.addRange(range);}}catch(Error){if(this.debug){alert("setCursorToObject: "+Error);}}};function WIT9(object){try{var ch96=object;while(ch96.firstChild){ch96=ch96.firstChild;while(ch96.nodeType==3 && ch96.nodeValue==""){if(ch96.nextSibling)ch96=ch96.nextSibling;else break;}}if(ch96.nodeType==3){ch96=ch96.parentNode;}else if(ch96.tagName.toLowerCase()=="br"){ch96=ch96.parentNode;}this.setCursorToObject(ch96);}catch(Error){if(this.debug){alert("setCursorToText: "+Error);}}};function n_1e(jk1,replaceNode){try{if(this._8475)jk1.replaceNode(replaceNode);else jk1.parentNode.replaceChild(replaceNode,jk1);}catch(Error){}};function s8MN(){try{y3NdW=this.doc.getElementById("__tmp_start");ll23=this.doc.getElementById("__tmp_end");var ST3=null;if(y3NdW.nextSibling)ST3=y3NdW.nextSibling;else ST3=y3NdW.parentNode.nextSibling;if(this.callback){if(!this.callback(ST3)){this.__iterate_node(ST3);}}}catch(Error){if(this.debug){alert("Error in __selection_iterate: "+Error);}}};function hT4(jk1){try{while(jk1){var L2j=jk1.childNodes;for(var i=0;i<L2j.length;i++){if(this.callback){if(this.callback(L2j[i]))return true;}if(L2j[i].canHaveChildren || L2j[i].hasChildNodes()){if(this.__iterate_node(L2j[i]))return true;}}if(jk1.nextSibling){jk1=jk1.nextSibling;}else{var parent=jk1.parentNode;if(this.selectedFull){if(this.callback){if(this.callback(parent))return true;}}jk1=parent.nextSibling;while(jk1==null){if(parent.tagName.toLowerCase()=="body")return true;parent=parent.parentNode;jk1=parent.nextSibling;}}if(this.callback){if(this.callback(jk1))return true;}}}catch(Error){if(this.debug){alert("Error in __selection_iterate_node: "+Error);}}};function nM1u2(mode){try{var range=this.getRange();var ch96=range.startContainer;if(ch96.nodeType==3){var text=ch96.nodeValue;if(text==""){if(this.debug){alert("Text == NULL: "+ch96.parentNode.innerHTML);}return false;}else{var W_k8=this.doc.createElement("span");W_k8.id="__marker__";W_k8.innerHTML="#";range.insertNode(W_k8);W_k8=this.doc.getElementById("__marker__");var S32=W_k8.parentNode.tagName.toLowerCase();var IAF=this.__getTagHierarchy(W_k8);for(var i=0;i<IAF.length;i++){var L15=IAF[i].tagName.toLowerCase();if(L15=="li"){this.__remove_node(W_k8);return false;}}if(S32=="body" || S32=="div" || S32=="td" || S32=="th"){var previous=(W_k8.previousSibling && W_k8.previousSibling.nodeType==3 && W_k8.previousSibling.nodeValue!="");var next=(W_k8.nextSibling && W_k8.nextSibling.nodeType==3 && W_k8.nextSibling.nodeValue!="");var _JNY=this.__prepare_paragraph(mode,W_k8,previous,W_k8.previousSibling);var A_3J=this.__prepare_paragraph(mode,W_k8,next,W_k8.nextSibling);var _2p=this.doc.createDocumentFragment();_2p.appendChild(_JNY);_2p.appendChild(A_3J);this.__replace_node(W_k8,_2p);this.setCursorToText(A_3J);return true;}else{var IAF=this.__getTagHierarchy(W_k8);var XV6g$=null;var g72=false;for(var i=0;i<IAF.length;i++){var L15=IAF[i].tagName.toLowerCase();if(L15=="p" || L15.substring(0,1).toLowerCase()=="h"){if(mode=="wp"){IAF[i].style.marginTop=0;IAF[i].style.marginBottom=0;}var TE8=IAF[i].cloneNode(true);if(IAF[i].nextSibling!=null){XV6g$=IAF[i].parentNode.insertBefore(TE8,IAF[i].nextSibling);}else{XV6g$=IAF[i].parentNode.appendChild(TE8);}g72=true;break;}if(L15=="td" || L15=="th" || L15=="div"){var _pD=IAF[i-1];var TE8=_pD.cloneNode(true);var _JNY=this.doc.createElement("p");if(mode=="wp"){_JNY.style.marginTop=0;_JNY.style.marginBottom=0;}_JNY.appendChild(_pD.cloneNode(true));var tk7i8=_JNY.getElementsByTagName("span");for(var i=0;i<tk7i8.length;i++){if(tk7i8[i].id=="__marker__"){W_k8=tk7i8[i];break;}}var A_3J=this.doc.createElement("p");if(mode=="wp"){A_3J.style.marginTop=0;A_3J.style.marginBottom=0;}A_3J.appendChild(TE8);var _2p=this.doc.createDocumentFragment();_2p.appendChild(_JNY);_2p.appendChild(A_3J);this.__replace_node(_pD,_2p);XV6g$=A_3J;g72=true;__editAddParagraphPlaceHolder(_JNY);__editAddParagraphPlaceHolder(A_3J);break;}}if(!g72){if(this.debug){alert("No P !!");}var s0536=this.doc.getElementById("__marker__");this.__remove_node(s0536);return true;}W_k8.id="__marker_orig__";var bT3l4=this.doc.getElementById("__marker_orig__");var parent=bT3l4.parentNode;while(bT3l4.nextSibling){this.__remove_node(bT3l4.nextSibling);}this.__remove_node(bT3l4);__editAddParagraphPlaceHolder(parent);var H9UX=this.doc.getElementById("__marker__");var parent=H9UX.parentNode;while(H9UX.previousSibling){this.__remove_node(H9UX.previousSibling);}this.__remove_node(H9UX);__editAddParagraphPlaceHolder(parent);this.setCursorToText(XV6g$);}}}else{if(ch96.tagName.toLowerCase()!="p"){var IAF=this.__getTagHierarchy(ch96);for(var i=0;i<IAF.length;i++){var L15=IAF[i].tagName.toLowerCase();if(L15=="p"){ch96=IAF[i];break;}}}var TE8=ch96.cloneNode(true);var XV6g$=null;if(ch96.nextSibling!=null){XV6g$=ch96.parentNode.insertBefore(TE8,ch96.nextSibling);}else{XV6g$=ch96.parentNode.appendChild(TE8);}ch96.innerHTML="";__editAddParagraphPlaceHolder(ch96);this.setCursorToText(XV6g$);}}catch(Error){if(this.debug){alert("processEnter: "+Error);}}return true;};function k29b(mode,ch96,y0337,s08){var ylH=null;try{ylH=this.doc.createElement("p");if(mode=="wp"){ylH.style.marginTop=0;ylH.style.marginBottom=0;}if(y0337){ylH.appendChild(s08.cloneNode(true));this.__remove_node(s08);}else{__editAddParagraphPlaceHolder(ylH);}}catch(Error){if(this.debug){alert("prepare_paragraph: "+Error);}}return ylH;};function Bqy1(){try{var fonts=this.doc.getElementsByTagName("font");for(var i=0;i<fonts.length;i++){if(fonts[i].id=="__cursor__"){this.__remove_node(fonts[i]);}}this.insertHtml("<font id='__cursor__'></font>");}catch(Error){if(this.debug){alert("setCursorMarker: "+Error);}}}function _2Bv(){try{var fonts=this.doc.getElementsByTagName("font");for(var i=0;i<fonts.length;i++){if(fonts[i].id=="__cursor__"){this.setCursorToObject(fonts[i]);this.__remove_node(fonts[i]);}}}catch(Error){if(this.debug){alert("setCursorToMarker: "+Error);}}}/*
Modification or decryption of this file is strictly forbidden - Pintexx GmbH
*/
var globalAutoRelativeBase=false;function Browser(){var agent=navigator.userAgent.toLowerCase();this.ns=((agent.indexOf('mozilla')!=-1)&&((agent.indexOf('spoofer')==-1)&&(agent.indexOf('compatible')==-1)));this.ie=(agent.indexOf("msie")!=-1);this.safari=(agent.indexOf("safari")!=-1);};var browser=new Browser();function __externalSetFocus(){editSetFocus();};function controlResize(){try{var docWidth=__editGetDocumentWidth();document.getElementById("docContainer").style.width=docWidth;}catch(Error){}};function __editStartup(){eventOnStartup();if(__editToolbarString==""){if(design=="5"){if(globalTechnology=="desk")__editToolbarString="T97020365SE04SE057680SE64SE0607086177SE0910TEDITS4911601213141516176257;T9619562021222324512526SE2728293098SE31323334SE3536;T828384SE858687SE9091SE92SE93SE9495TEDIDITS48783752587218;B535455;L7559383940414243444563464748";else __editToolbarString="T01SE02SE03SE65SE73SE04SE05SE76SE80SE64SE66SE06SE07SE08SE61SE77SE09SE10TEDITS49SE11SE60SE12SE13SE14SE15SE16SE17SE62SE57SE67SE70SE71TE;T50SE96TEDI19562021DITS22SE23SE24SE51SE25SE26SE27SE28SE29SE30SE98SE31SE32SE33SE34SE3536TE;T82SE83SE84SE85SE86SE87SE90SE91SE92SE93SE94SE95TEDITS81TEDITS48SE78SE37SE526818SE58SE72TE;B53SE54SE55;L7559383940414243444563464748";}else{if(globalTechnology=="desk")__editToolbarString="T97020365SE04SE057680SE64SE0607086177SE0910TEDITS4911601213141516176257;T9619562021222324512526SE2728293098SE31323334SE3536;T828384SE858687SE9091SE92SE93SE9495TEDIDITS48783752587218;B535455;L7559383940414243444563464748";else __editToolbarString="T0102036573SE04SE057680SE6466SE0607086177SE0910TEDITS4911601213141516176257677071;T509619562021222324512526SE2728293098SE31323334SE3536;T828384SE858687SE9091SE92SE93SE9495TEDITS81TEDITS4878375268587218;B535455;L7559383940414243444563464748";}}if(globalTechnology!="desk"){try{eval("parent.editOnInit_"+__editDynEvent+"()");}catch(Error){};try{eval("__editToolbarXMLString=parent.editOnToolbar_"+__editDynEvent+"()");}catch(Error){};try{window.frameElement.onresize=controlResize;}catch(Error){}}globalDocumentView=__editDocumentView > 0 ? true:false;if(globalToolbarColor==""){if(design=="3"){globalToolbarColor="#9EBEF5";globalToolbarBorder=false;}else if(design=="4"){globalToolbarColor="#E8E8F0";globalToolbarBorder=false;}else if(design=="5"){globalToolbarColor="#D5E4F3";globalToolbarBorder=false;globalDocumentBackColor="#84A7D3";globalRulerColor="#D5E4F3";}else{globalToolbarColor="buttonFace";globalToolbarBorder=true;}}if(__readOnly){globalSingleMode=true;globalMenuVisible=false;globalAttributeAreaVisible=false;globalHierarchyBarVisible=false;globalRulerVisible=false;editSetReadOnlyStatus(true);}__editBuildEditor();editSetUserCode(__userCode);try{__toolbar_setmode(__mode);}catch(Error){};if(globalLanguageDetect){if(browser.ie)__lng=navigator.userLanguage;else __lng=navigator.language;if(__lng.indexOf("de")>-1)language="DE";if(__lng.indexOf("es")>-1)language="ES";if(__lng.indexOf("pt")>-1)language="PT";if(__lng.indexOf("nl")>-1)language="NL";if(__lng.indexOf("se")>-1)language="SE";if(__lng.indexOf("no")>-1)language="NO";if(__lng.indexOf("en")>-1)language="EN";}if(browser.ie){document.oncontextmenu=oncontext;}if(globalDebug){try{checkSettings();}catch(error){}}try{spellSetLanguage(language);spellSetDictFile(globalSpellDictPath);spellSetUserDictFile(globalSpellUserDictPath);spellSetLicense(globalSpellLicenseKey);}catch(Error){}setTimeout("__init_delay()",50);};function __init_delay(){if(!browser.ie){document.body.innerHTML=__tmp_st_html;}eventOnInit();if(!globalSingleMode){if(globalMenuVisible){document.body.style.marginTop=22;CreateMenu(__userCode);}else{document.body.style.marginTop=1;}}else{document.body.style.marginTop=1;}document.getElementById("body").style.backgroundColor=globalToolbarColor;if(globalHierarchyBarVisible)document.getElementById("hierarchyBar").style.backgroundColor=globalRulerColor;editSetHierachyBarVisible(globalHierarchyBarVisible);if(__loadFile!=""){editLoad(__loadFile);}else{__editInitStatus=1;}try{RaiseControlEvent("LOADED");}catch(Error){};try{if(!__readOnly && globalTechnology=="desk" && __editToolbarXMLString!=""){document.getElementById("toolbar_top").src="toolbar/pinToolbar.html";document.getElementById("toolbar_bottom").src="toolbar/pinToolbar.html";}}catch(Error){}callParent();};function __window_r_loaded(){__editShowWindowRight();};function __window_l_loaded(){};function __editOnResize(){};function __moz_OnLoad(){try{__editHTMLAreaUsed=false;__editDocumentLoadedFlag=true;__editLoading=false;var doc=document.getElementById('__moz_load').contentWindow.document;__currentURL=doc.location.href;var cut=__currentURL.indexOf("?");if(cut > 0)__currentURL=__currentURL.substring(0,cut);var html=doc.documentElement.innerHTML;editWrite(html,2);}catch(Error){}};function __editOnLoad(){if(__editInitStatus==3){if(globalLinkPathRelative=="")globalLinkPathRelative=globalDefaultRelativePath;}if(globalDocumentView && globalDocumentPageWidth!=""){if(browser.ie && globalScrollMode==0)document.getElementById("scroll2").style.height=getDoc().body.scrollHeight+"px";}__editHTMLAreaUsed=false;__editDocumentLoadedFlag=true;__editLoading=false;__editActiveObject=getDoc().body;if(__editInitStatus==2 || __editInitStatus==3 || __editInitStatus==5){__editSetSpaceInTables(false);__editSetPlaceHolders();}if(__editInitStatus==1){var doc=getDoc();if(!__readOnly){if(browser.ie){doc.body.contentEditable=true;}else{doc.designMode="on";}}if(globalBreakMode=="p" || globalBreakMode=="wp"){try{doc.body.innerHTML="<p id='__temp__'></p>";var p=doc.getElementById("__temp__");if(globalBreakMode=="wp"){p.style.marginTop=0;p.style.marginBottom=0;}var sel=new Selection(doc);if(globalAutoFocus)sel.setCursorToObject(p);p.removeAttribute("id");}catch(Error){}}else{doc.body.innerHTML="";}if(browser.ie){__editInitEvents();if(globalAutoFocus)editSetFocus();}else{__editInitEvents();__editSetBodyBackground();}return;}if(__editInitStatus==2){if(browser.ie)__currentURL=document.getElementById('pinEdit').contentWindow.document.location.href;var cut=__currentURL.indexOf("?");if(cut > 0)__currentURL=__currentURL.substring(0,cut);}if(__currentURL.indexOf(globalEditorPageName)> 0 || __currentURL.indexOf("dummy.html")> 0)__currentURL="";if(globalAutoRelativeBase){if(__editInitStatus==2){globalImagePathRelative_save=globalImagePathRelative;globalLinkPathRelative_save=globalLinkPathRelative;for(var i=__currentURL.length-1;i>0;i--){if(__currentURL.substring(i,i+1)=="/"){globalImagePathRelative=__currentURL.substring(0,i+1);globalLinkPathRelative=globalImagePathRelative;break;}}if(__editInitStatus!=2){if(globalImagePathRelative_save!="")globalImagePathRelative=globalImagePathRelative_save;if(globalLinkPathRelative_save!="")globalLinkPathRelative=globalLinkPathRelative_save;}}}if(browser.ie){__editInitEvents();if(__editInitStatus==2)__editRelativePrepare(true);__editShowSymbols();editRefresh(getDoc(),editGetMode());}else{__editInitEvents();__editRelativePrepare(true);__editShowSymbols();}if(!__readOnly){if(browser.ie){document.getElementById('pinEdit').contentWindow.document.body.contentEditable=true;}}__editOnChanged(false,true);if(globalAutoFocus && browser.ie)editSetFocus();if((__editInitStatus==2 && __currentURL!="")|| __editInitStatus==3 || __editInitStatus==4 || __editInitStatus==5){setTimeout("__delay_style_sheet()",200);}};function __editOnLoadHtml(){__editInitEvents(2);};function __delay_style_sheet(){editSetStyleSheetRules();try{__eventOnFileLoaded();}catch(Error){}if(__intisetemp){__editLave();}if(__editInitStatus==2 && __currentURL!=""){editSetCursorHome(getDoc());}if(!browser.ie){__editSetBodyBackground();}eventOnEditorReady();};function __editLave(){var div=getDoc().createElement("div");div.id="__l"+"ave";div.style.position="absolute";div.style.left=10;div.style.top=0;div.style.color="red";div.style.fontFamily="Arial";div.style.fontSize=10;div.innerHTML="pinEdit "+(globalUserMode=="1" ? " WP ":"")+"Evaluation "+editGetVersion();if(!getDoc().getElementById("__l"+"ave")){getDoc().body.appendChild(div);}};function callParent(){if(globalTechnology!="desk"){if(browser.ie){try{if(parent==null){window.setTimeout("callParent()",50);return;}if(parent.document.readyState.toUpperCase()!="COMPLETE"){window.setTimeout("callParent()",50);return;}}catch(error){window.setTimeout("callParent()",50);return;}}if(globalSaveContent!=""){editWrite(globalSaveContent);globalSaveContent="";}else{if(__editDynEvent!=""){try{eval("parent.editStartup_"+__editDynEvent+"(window,window.frameElement.id)");}catch(Error){};}else{try{parent.editOnEditorLoadedIntern(window,window.frameElement.id);}catch(Error){};try{parent.editOnEditorLoaded(window,window.frameElement.id);}catch(Error){};}}}if(__startupMode=="H"){setMode("HTML");}else if(__startupMode=="P"){setMode("PREVIEW");}if(globalDocumentView && globalDocumentPageWidth!=""){if(browser.ie && globalScrollMode==0){var x=document.getElementById('scroll1');x.onscroll=scrollHandler;}}if(globalXHtmlType==0)globalXHtmlDocType=globalXHtml10Transitionl;if(globalXHtmlType==1)globalXHtmlDocType=globalXHtml10Strict;if(globalXHtmlType==2)globalXHtmlDocType=globalXHtml11;eventOnEditorLoaded();};function scrollHandler(e){var y=document.getElementById('scroll1').scrollTop;frames["pinEdit"].scrollTo(0,y);return true;};function __editShowWindowRight(){__editPrepareParams();__editMozParam[2]="BODY";__editMozParam[5]=getDoc().body;__editMozParam[13]=globalAttributeAreaTabDesign;__editMozParam[15]="1";try{document.getElementById("windowRight").contentWindow.initDialog(__editMozParam);}catch(Error){}};function __toolbar_loaded(iframe){try{if(__startupMode=="H"){editSetActiveMode("HTML");}else if(__startupMode=="P"){editSetActiveMode("PREVIEW");}else if(__startupMode=="S"){}else{}__editToolbarReady=true;editRefresh(getDoc(),editGetMode());setTimeout("__RefreshToolbar()","100");}catch(Error){}if(iframe.src.indexOf("pinToolbar")>=0)eventOnToolbarLoaded();};function __RefreshToolbar(){eventOnChangeToolbar(__editBuildToolbarStatus());};var __tmp_st_html="";function __editBuildEditor(){var docViewStyle="";var html="";if(globalSupportHttps && browser.ie)var isHttps=" src='dummy.html' ";else var isHttps="";if(globalSideBarVisible)globalLeftAreaVisible=true;var startupMode="";var saveHB=false;if(__startupMode=="H" || __startupMode=="P" || __startupMode=="S"){startupMode="display: none";}var rulerImage="";if(globalRulerUnit=="0")rulerImage="ruler-pixel.gif";if(globalRulerUnit=="1")rulerImage="ruler-mm.gif";if(globalRulerUnit=="2")rulerImage="ruler-inch.gif";html+="<div id='helpline' onmouseup='onmouseupPINEDIT()' style='visibility:hidden;position:absolute;z-Index:5001;left:50;top:0;width:1px;height:1000px;border-left:1px dotted red'></div>";html+="<TEXTAREA style='position:absolute;top:0px;left:0px;display:none' id='__editData' NAME='__editData'></TEXTAREA>";html+="<TEXTAREA style='position:absolute;top:0px;left:0px;display:none' id='__externalParam1' NAME='__externalParam1'></TEXTAREA>";html+="<TEXTAREA style='position:absolute;top:0px;left:0px;display:none' id='__externalParam2' NAME='__externalParam2'></TEXTAREA>";html+="<TEXTAREA style='position:absolute;top:0px;left:0px;display:none' id='__externalParam3' NAME='__externalParam3'></TEXTAREA>";html+="<table width='100%' height='100%' border=0 cellspacing='0' cellpadding='0'>";html+="<tr>";var colspan=2;if(globalLeftAreaVisible &&!globalAttributeAreaVisible)colspan=2;if(!globalLeftAreaVisible && globalAttributeAreaVisible)colspan=2;if(globalLeftAreaVisible && globalAttributeAreaVisible)colspan=3;html+="<td colspan='"+colspan+"' unselectable='on' id='toolbartop'>";if(!globalSingleMode){if(globalTechnology=="desk" && __editToolbarXMLString!=""){html+="<iframe src='' onload='javascript:__toolbar_loaded(this);' unselectable='on' id='toolbar_top' style='HEIGHT: 84px; width:100%;"+startupMode+"' frameBorder='0'></iframe>";}else{html+="<iframe src='toolbar/pinToolbar.html' onload='javascript:__toolbar_loaded(this);' unselectable='on' id='toolbar_top' style='HEIGHT: 84px; width:100%;"+startupMode+"' frameBorder='0'></iframe>";}}html+="<td>";html+="</tr>";html+="<tr>";if(globalLeftAreaVisible && globalHierarchyBarVisible){html+="<td style='width:"+globalLeftAreaWidth+"' rowspan=3>";html+="<iframe onload='__window_l_loaded()' src='"+globalLeftAreaUrl+"' id='windowLeft' height='100%' style='width:"+globalLeftAreaWidth+"' frameborder='0'></iframe>";html+="</td>";}if(globalLeftAreaVisible &&!globalHierarchyBarVisible){html+="<td style='width:"+globalLeftAreaWidth+"'rowspan=2>";html+="<iframe onload='__window_l_loaded()' src='"+globalLeftAreaUrl+"' id='windowLeft' height='100%' style='width:"+globalLeftAreaWidth+";' frameborder='0'></iframe>";html+="</td>";}if(globalHierarchyBarVisible)html+="<td id='hierarchyBar' style='padding-left:2px'><div  style='padding-right:3px'><table style='font-size:11px;font-family:arial;width:100%;border-width:1px;border-style: solid;border-left-color:  buttonShadow;  border-right-color:  buttonHighlight;  border-top-color:  buttonShadow;  border-bottom-color:buttonHighlight;' cellspacing=0 cellpadding=1 border=0><tr><td>&nbsp;</td></tr></table></div></td>";if(globalAttributeAreaVisible && globalHierarchyBarVisible){html+="<td style='width:"+globalAttributeAreaWidth+"' rowspan=2>";html+="<iframe onload='__window_r_loaded()' src='"+globalAttributeAreaUrl+"' id='windowRight' name='attribute' height='100%' style='width:"+globalAttributeAreaWidth+";"+startupMode+"' frameborder='0'></iframe>";html+="</td>";}html+="</tr>";html+="<tr>";if(globalDocumentView && globalDocumentPageWidth!=""){html+="<td width='100%' height='100%'>";if(browser.ie)docViewStyle="style='border-left-width:1px;border-left-style: solid;border-left-color: black; border-top-width: 1px;border-top-style: solid;border-top-color: black;border-right-width:1px;border-right-style: solid;border-right-color: black;'";var docWidth=0;if(globalTechnology=="desk"){docWidth=globalControlWidth-(globalAttributeAreaVisible ? parseInt(globalAttributeAreaWidth):0)-(globalLeftAreaVisible ? parseInt(globalLeftAreaWidth):0)-18-2-2;}else{docWidth=__editGetDocumentWidth();}html+="<div id='editContainer' style='height:100%'>";html+="<table style='width:100%;height:100%' border=0 cellpadding=0 cellspacing=0><tr><td width='100%' height='100%'>";if(browser.ie)html+="<div id='docContainer' style='height:100%;width:"+docWidth+";overflow-y:hidden;overflow-x:auto;'>";else html+="<div id='docContainer' style='height:100%;width:100%;overflow-y:hidden;overflow-x:auto;'>";html+="<table id='docContainerInside' style='height:100%;width:100%;' border=0 cellpadding=0 cellspacing=0>";html+="<tr>";if(globalRulerVisible)html+="<td id='ruler' style='background-color:"+globalRulerColor+";padding-top:4px;padding-bottom:2px;padding-left:"+globalDocumentMargin+"'><div style='height:15px;width:100%;BACKGROUND-REPEAT: no-repeat;background-image:url(design/image/"+rulerImage+")' border=0></div></td>";else html+="<td id='ruler'></td>";html+="</tr>";html+="<tr>";if(browser.ie && globalScrollMode==0)html+="<td align='center' style='height:100%;padding-top: "+globalDocumentMargin+";padding-left:"+globalDocumentMargin+";padding-right:"+globalDocumentMargin+";padding-bottom:0px;background-color: "+globalDocumentBackColor+";'><iframe "+docViewStyle+isHttps+" id='pinEdit' name='pinEdit' onload='javascript:__editOnLoad()' onresize='__editOnResize();' onfocus='__editSetFocusStatus(true)' onblur='__editSetFocusStatus(false)' height='100%' width='"+globalDocumentPageWidth+"' frameborder='0' scrolling='no'></iframe></td>";else html+="<td align='center' style='height:100%;padding-top: "+globalDocumentMargin+";padding-left:"+globalDocumentMargin+";padding-right:"+globalDocumentMargin+";padding-bottom:0px;background-color: "+globalDocumentBackColor+";'><iframe "+docViewStyle+isHttps+" id='pinEdit' name='pinEdit' onload='javascript:__editOnLoad()' onresize='__editOnResize();' onfocus='__editSetFocusStatus(true)' onblur='__editSetFocusStatus(false)' height='100%' width='"+globalDocumentPageWidth+"' frameborder='0'></iframe></td>";html+="</tr>";html+="</table>";html+="</div>";html+="</td>";if(browser.ie && globalScrollMode==0){html+="<td height='100%'>";html+="<div style='overflow:scroll;width:18px; height:100%' id='scroll1'><div id='scroll2' style='width:1px; height:1px; overflow:hidden;'></div></div>";html+="</td>";}html+="</tr></table>";html+="</div>";html+="<iframe "+docViewStyle+isHttps+" id='pinEditPreview' name='pinEditPreview' onfocus='__editSetFocusStatus(true)' onblur='__editSetFocusStatus(false)' height='100%' width='100%' style='display: none' frameborder='0'></iframe>";html+="<iframe "+docViewStyle+isHttps+" id='pinEditHtml' onload='javascript:__editOnLoadHtml()' name='pinEditHtml' onfocus='__editSetFocusStatus(true)' onblur='__editSetFocusStatus(false)'  height='100%' width='100%' style='display: none;' frameborder='0'></iframe>";}else if(globalDocumentView && globalDocumentPageWidth==""){html+="<td width='100%' height='100%' style='padding-left:"+globalDocumentMargin+";padding-top:"+globalDocumentMargin+";background-color: "+globalDocumentBackColor+"'>";if(browser.ie)docViewStyle="style='border-left-width:1px;border-left-style: solid;border-left-color: black; border-top-width: 1px;border-top-style: solid;border-top-color: black'";html+="<iframe "+docViewStyle+isHttps+" id='pinEdit' name='pinEdit' onload='javascript:__editOnLoad()' onresize='__editOnResize();' onfocus='__editSetFocusStatus(true)' onblur='__editSetFocusStatus(false)' height='100%' width='100%' frameborder='0'></iframe>";html+="<iframe "+docViewStyle+isHttps+" id='pinEditPreview' name='pinEditPreview' onfocus='__editSetFocusStatus(true)' onblur='__editSetFocusStatus(false)' height='100%' width='100%' style='display: none' frameborder='0'></iframe>";html+="<iframe "+docViewStyle+isHttps+" id='pinEditHtml' name='pinEditHtml'  onload='javascript:__editOnLoadHtml()' onfocus='__editSetFocusStatus(true)' onblur='__editSetFocusStatus(false)'  height='100%' width='100%' style='display: none;' frameborder='0'></iframe>";}else{html+="<td width='100%' height='100%'>";html+="<div id='editContainer' style='height:100%'>";html+="<table style='width:100%;height:100%' border=0 cellpadding=0 cellspacing=0><tr>";if(globalRulerVisible)html+="<td id='ruler' style='background-color:"+globalRulerColor+";padding-top:4px;padding-bottom:2px;padding-left:0px'><div style='height:15px;width:100%;BACKGROUND-REPEAT: no-repeat;background-image:url(design/image/"+rulerImage+")' border=0></div></td>";else html+="<td id='ruler'></td>";html+="</tr>";html+="<tr>";html+="<td width='100%' height='100%' style='background-color: "+globalDocumentBackColor+"'>";html+="<iframe tabIndex=0 "+docViewStyle+isHttps+" id='pinEdit' name='pinEdit' onload='javascript:__editOnLoad()' onresize='__editOnResize();' onfocus='__editSetFocusStatus(true)' onblur='__editSetFocusStatus(false)' height='100%' width='100%' frameborder='0'></iframe>";html+="</td></tr></table>";html+="</div>";html+="<iframe "+docViewStyle+isHttps+" id='pinEditPreview' name='pinEditPreview' onfocus='__editSetFocusStatus(true)' onblur='__editSetFocusStatus(false)' height='100%' width='100%' style='display: none' frameborder='0'></iframe>";html+="<iframe "+docViewStyle+isHttps+" id='pinEditHtml' name='pinEditHtml'  onload='javascript:__editOnLoadHtml()' onfocus='__editSetFocusStatus(true)' onblur='__editSetFocusStatus(false)'  height='100%' width='100%' style='display: none;' frameborder='0'></iframe>";}html+="</td>";if(globalAttributeAreaVisible &&!globalHierarchyBarVisible){html+="<td style='width:"+globalAttributeAreaWidth+"'>";html+="<iframe onload='__window_r_loaded()' src='"+globalAttributeAreaUrl+"' id='windowRight' height='100%' style='width:"+globalAttributeAreaWidth+";"+startupMode+"' frameborder='0'></iframe>";html+="</td>";}html+="</tr>";html+="<tr>";html+="<td  colspan='2' unselectable='on' id='toolbarbottom'>";if(globalUserMode=="0"){if(!globalSingleMode){if(globalTechnology=="desk" && __editToolbarXMLString!=""){html+="<iframe unselectable='on' id='toolbar_bottom' style='z-Index:5002;HEIGHT: 28px; width:100%' src='' frameBorder='0'></iframe>";}else{html+="<iframe unselectable='on' id='toolbar_bottom' style='z-Index:5002;HEIGHT: 28px; width:100%' src='toolbar/pinToolbar.html' frameBorder='0'></iframe>";}}}else{if(!globalSingleMode){if(globalTechnology=="desk" && __editToolbarXMLString!=""){html+="<iframe unselectable='on' id='toolbar_bottom' style='z-Index:5003;HEIGHT: 1px; width:100%' src='' frameBorder='0'></iframe>";}else{html+="<iframe unselectable='on' id='toolbar_bottom' style='z-Index:5003;HEIGHT: 1px; width:100%' src='toolbar/pinToolbar.html' frameBorder='0'></iframe>";}}}html+="<td>";html+="</tr>";html+="</table>";__tmp_st_html=html;if(browser.ie)document.body.innerHTML=html;};function oncontext(){return false;};function editGetXHtmlBody(nodoctype){return __editGetXHtml("1",nodoctype);};function editGetXHtml(mode,nodoctype,isUpdated){return __editGetXHtml(mode,nodoctype,isUpdated);};function __editSev(){__intisetemp=false;};/*
Modification or decryption of this file is strictly forbidden - Pintexx GmbH
*/
var __origWidth;var __origHeight;var __tmpObjectMove=false;var __cmGo=false;var __cmMoveCell=false;var __cmTable=null;var __cmCell=null;var __cmLeft=0;function onfocusoutPINEDIT(){try{eventOnLostFocus();}catch(Error){}};function onfocusinPINEDIT(){try{eventOnGotFocus();}catch(Error){}};function ondblclickPINEDIT(e){var evt=__getEventObject(e);if(eventOnDblClick(evt)){__editCancelEvent(evt);return;}try{if(browser.ie){var range=getDoc().selection.createRange();var text=range.text;var space=text.substring(text.length-1,text.length);if(space==" " || space.charCodeAt(0)=="160"){range.moveEnd("character",-1);range.select();}}}catch(Error){}};function onclickPINEDIT(e){};function onchangePINEDIT(){try{__intelliHide();}catch(Error){}__editActiveObject=editRetrieveActiveObject();var temp=__editBuildToolbarStatus();eventOnChangeToolbar(temp);__editUpdateScrollBar();};function oncontextmenuPINEDIT(e){var evt=__getEventObject(e);if(__editNoEdit){__editCancelEvent(evt);return;}__editActiveObject=__getSourceElement(e);editPopup(evt);__editCancelEvent(evt);return false;};function onmouseoverPINEDIT(e){var sourceElement=__getSourceElement(e);var evt=__getEventObject(e);try{var aHierarchy=__editGetTagHierarchy(sourceElement,1);for(var i=0;i<aHierarchy.length;i++){var curObject=aHierarchy[i];if(curObject.tagName.toLowerCase()=="a"){if(curObject.name==""){curObject.setAttribute("__orig__title",curObject.title);var href=curObject.href;if(href.indexOf("about:blank")>=0){href=href.substring(11);}if(!browser.ie){if(href.substring(href.length-1,href.length)=="/"){href=href.substring(0,href.length-1);}href="("+href+") ";}if(href.substring(0,1)=="#")curObject.title=getString("7023")+"\n\r "+href;else curObject.title=href+"\n\r"+getString("7022");if(evt.ctrlKey &&!evt.altKey &&!evt.shiftKey){if(browser.ie)curObject.ownerDocument.body.style.cursor="hand";}}break;}}}catch(Error){}};function __editTableReleaseAssistant(){};function __editTableActivateAssistant(){var tableAss=getDoc().getElementById("__ta__");__editRemoveNode(tableAss);};function __editTableAssistantMove(){var tableAss=getDoc().getElementById("__ta__");tableAss.style.cursor="hand";};function onmouseoutPINEDIT(e){try{var sourceElement=__getSourceElement(e);var aHierarchy=__editGetTagHierarchy(sourceElement,1);for(var i=0;i<aHierarchy.length;i++){var curObject=aHierarchy[i];if(curObject.tagName.toLowerCase()=="a"){var origTitle=curObject.getAttribute("__orig__title");if(origTitle!=null){curObject.removeAttribute("__orig__title");if(origTitle!="")curObject.title=origTitle;else curObject.removeAttribute("title");if(browser.ie)curObject.ownerDocument.body.style.cursor="auto";}}}}catch(Error){}};function onmousedownPINEDIT(e){var evt=__getEventObject(e);if(eventOnMouseDown(evt)){__editCancelEvent(evt);return;}if(__cmGo){var evt=getWindow().event;__cmMoveCell=true;if(__cmTable.style.borderCollapse.toLowerCase()!="collapse"){try{var range=getDoc().body.createTextRange();range.moveToPoint(evt.x-3,evt.y);__cmCell=range.parentElement();}catch(Error){__cmMoveCell=false;}}__cmLeft=globalGetPositonX(__cmCell);__cmTable.onmouseup=onmouseupPINEDIT;}if(__editLoading)return;__editUpdateScrollBar();if(!browser.ie){editSetFocus();try{popup.style.visibility="hidden";}catch(Error){};try{if(toolbarsTop)toolbarsTop.reset();if(objMenuBar){var objMenu=objMenuBar.getActiveBarItem();if(objMenu)objMenu.reset();}}catch(Error){};__editActiveObject=e.target;var temp=__editBuildToolbarStatus();if(eventOnChangeToolbar(temp))return;}else{__editActiveObject=evt.srcElement;__editUpdateStyles(false);}__editBuildTagHierarchy();if(!browser.ie)onmouseupPINEDIT(e);if(browser.ie){if(globalImageRatioConstrain){if(__editActiveObject.tagName.toLowerCase()=="img"){__editActiveObject.onresizeend=__onImageResizeEnd;__editActiveObject.onresizestart=__onImageResizeStart;}}var tag=__editActiveObject.tagName.toLowerCase();if(__editActiveObject.style.position=="absolute"){__editActiveObject.onmove=__onObjectMove;__editActiveObject.onmovestart=__onObjectMoveStart;__editActiveObject.onmoveend=__onObjectMoveEnd;__editActiveObject.onresize=__onObjectResize;}}};function __onObjectMoveStart(){editHelpLineVisible(true);};function __onObjectMoveEnd(){__tmpObjectMove=false;editHelpLineVisible(false);var evt=getWindow().event;var sourceElement=getWindow().event.srcElement;try{editStatusBarSetText(parseInt(sourceElement.style.left)+"/"+parseInt(sourceElement.style.top));}catch(Error){}__editOnChanged(true);};function __onObjectMove(){var evt=getWindow().event;var sourceElement=getWindow().event.srcElement;__tmpObjectMove=true;editHelpLineMove(parseInt(sourceElement.style.left));editStatusBarSetText(parseInt(sourceElement.style.left));};function __onObjectResize(){var evt=getWindow().event;var sourceElement=getWindow().event.srcElement;editStatusBarSetText(parseInt(evt.x)+"/"+parseInt(evt.offsetY));};function __onImageResizeStart(){var evt=getWindow().event;var sourceElement=getWindow().event.srcElement;__origWidth=sourceElement.style.width;__origHeight=sourceElement.style.height;};function __onImageResizeEnd(){var evt=getWindow().event;var sourceElement=getWindow().event.srcElement;try{var height=parseInt(sourceElement.style.width)/(parseInt(__origWidth)/ parseInt(__origHeight));sourceElement.style.height=height;}catch(Error){}setTimeout("__onResizeEnd_delay()",50);};function __onResizeEnd_delay(){try{editStatusBarSetText(parseInt(__editActiveObject.style.width)+" px/"+parseInt(__editActiveObject.style.height)+" px");}catch(Error){}__editOnChanged(true);};function onmousemovePINEDIT(e){var sourceElement=__getSourceElement(e);if(__tmpObjectMove ||!browser.ie)return;var parentElement=null;var evt=__getEventObject(e);if(__cmMoveCell){editHelpLineMove(evt.x);try{headTD=__cmTable.rows[0].cells[__cmCell.cellIndex];headTD.style.width=evt.x-__cmLeft;editStatusBarSetText(headTD.style.pixelWidth);__cmTable.style.cursor="hand";}catch(Error){}return;}else{var range=getDoc().body.createTextRange();var tagName=sourceElement.tagName.toLowerCase();try{var isTable=false;var hit=false;if(tagName=="table" && sourceElement.style.borderCollapse.toLowerCase()!="collapse"){__cmTable=sourceElement;range.moveToPoint(evt.x-3,evt.y);parentElement=range.parentElement();if(parentElement.tagName.toLowerCase()=="td")hit=true;}if(tagName=="td"){__cmTable=sourceElement.parentNode.parentNode.parentNode;__cmCell=sourceElement;parentElement=sourceElement;rightCorner=globalGetPositonX(__cmCell)+__cmCell.offsetWidth;if(evt.x >(rightCorner-2)&& evt.x <(rightCorner+1))hit=true;}if(hit &&(parentElement.cellIndex < __cmTable.rows[0].cells.length-1)){editHelpLineVisible(true);editHelpLineMove(evt.x);__cmGo=true;__cmTable.unselectable="on";__cmTable.style.cursor="hand";}else{if(__cmTable)__cmTable.removeAttribute("unselectable");editHelpLineVisible(false);__cmGo=false;__cmTable.style.cursor="";}}catch(Error){}}};function onmouseupPINEDIT(e){var evt=__getEventObject(e);var sourceElement=__getSourceElement(e);try{if(eventOnMouseUp(evt)){__editCancelEvent(evt);return;}}catch(Error){}if(__editLoading)return;if(evt.ctrlKey &&!evt.altKey &&!evt.shiftKey){var aHierarchy=__editGetTagHierarchy(sourceElement,1);for(var i=0;i<aHierarchy.length;i++){var curObject=aHierarchy[i];if(curObject.tagName.toLowerCase()=="a"){if(curObject.name==""){var href=curObject.href;setTimeout(function(){window.open(href);},50);if(browser.ie){var range=getDoc().body.createTextRange();range.moveToElementText(curObject);range.collapse(true);range.select();}return;}}}}if(__cmMoveCell){__cmGo=false;__cmMoveCell=false;editHelpLineVisible(false);__editOnChanged(true);return;}if(globalAttributeAreaVisible){__editPrepareParams();var tagName=__editActiveObject.tagName.toLowerCase();if(tagName=="body")__editMozParam[2]="BODY";else if(tagName=="table")__editMozParam[2]="TABLE";else if(tagName=="td" || tagName=="th")__editMozParam[2]="CELL";else if(tagName=="form")__editMozParam[2]="FORM";else if(tagName=="img")__editMozParam[2]="IMAGE";else if(tagName=="a"){__editMozParam[3]="0";__editMozParam[2]="LINK";__editMozParam[9]=globalDialogFilterLink;}else if(tagName=="select")__editMozParam[2]="SELECT";else if(tagName=="input")__editMozParam[2]="INPUT";else if(tagName=="textarea")__editMozParam[2]="TEXTAREA";else if(tagName=="div" || tagName=="span" || tagName=="p")__editMozParam[2]="DIV";else __editMozParam[2]="UNKNOWN";__editMozParam[5]=__editActiveObject;__editMozParam[13]=globalAttributeAreaTabDesign;__editMozParam[15]="1";try{if(__editMozParam[2]!="UNKNOWN")document.getElementById("windowRight").contentWindow.updateDialog(__editMozParam);}catch(Error){}}};function onkeydownPINEDIT(e){var evt=__getEventObject(e);if(__editNoEdit){if(__editCheckAllowedKeys(evt)){__editCancelEvent(evt);return;}}if(eventOnKeyDown(evt)){__editCancelEvent(evt);if(globalTechnology=="desk"){evt.keyCode=0;}return;}var doc=getDoc();if(globalTechnology=="desk"){if(evt.keyCode==38 || evt.keyCode==40){try{var allP=doc.getElementsByTagName("p");var pTag=null;if(evt.keyCode==38)pTag=allP[0];else pTag=allP[allP.length-1];var curRange=doc.selection.createRange();var range=doc.body.createTextRange();range.moveToElementText(pTag);if(range.inRange(curRange)){__editCancelEvent(evt);return;}}catch(Error){}}}try{for(var i=0;i<globalSuppressedKeys.length;i++){var supressedKey=globalSuppressedKeys[i];if(evt.keyCode==supressedKey.keyCode && evt.ctrlKey==supressedKey.ctrl && evt.altKey==supressedKey.alt){__editCancelEvent(evt);return;}}}catch(Error){}try{if(editGetMode()=="EDIT"){if(evt.keyCode==70 && evt.ctrlKey){editSearch();evt.keyCode=0;__editCancelEvent(evt);return false;}}if(globalTechnology!="desk"){if(evt.keyCode==83 && evt.ctrlKey){eventOnControlS();__editCancelEvent(evt);return false;}}if(evt.keyCode==121 && evt.ctrlKey){if(__intisetemp)alert("pinEdit Evaluation: "+___version);else alert("pinEdit Release: "+___version);}if(evt.keyCode==120 && evt.ctrlKey){if(globalDebug){try{__editShowParameters();}catch(Error){}}else{alert("Please switch to debug mode to run parameter check !");}}try{if(browser.ie){if(globalVerifyKeyWhenNotEditable){if(editIsTagNotEditable()){if(evt.keyCode < 37 || evt.keyCode > 40){__editCancelEvent(evt);return;}}}}}catch(Error){};if(evt.keyCode==46 ||(evt.keyCode==86 && evt.ctrlKey)){__editOnChanged(true);}if(__editControlVDisabled){if((evt.keyCode==86 && evt.ctrlKey)||(evt.keyCode==45 && evt.shiftKey)){try{eventOnControlV();}catch(Error){};try{eventControlV();}catch(Error){};__editCancelEvent(evt);return false;}}else{if((evt.keyCode==86 && evt.ctrlKey)||(evt.keyCode==45 && evt.shiftKey)){try{var checkPaste=globalControlPaste;}catch(Error){}if(checkPaste){__editCancelEvent(evt);setTimeout("__delay_paste()",50);return false;}else{if(browser.ie){if(globalOptimizer){if(eventOnPaste()){}else{__editPasteIntern();}__editCancelEvent(evt);return false;}}}}}}catch(Error){};try{if(__intelliAction())return;}catch(Error){};if(__isIntelli){if(browser.ie){evt.cancelBubble=true;evt.returnValue=false;return;}}try{if(evt.keyCode > 33){if(browser.ie){if(globalPreselect && globalUseStyleFormatting && globalUseOnlyStyleFormatting){globalPreselect=false;var range=doc.selection.createRange();range.pasteHTML("<span id='___tmp_pre___'></span>");var tempObject=doc.getElementById("___tmp_pre___");var pn=tempObject.parentNode;if(pn.tagName.toLowerCase()=="span"){var frag=doc.createDocumentFragment();for(var i=0;i<pn.childNodes.length;i++){var curObject=pn.childNodes[i];var newObject=null;if(curObject.nodeType==3){var newSpan=doc.createElement("span");if(curObject.nodeValue.substring(0,1)==" ")newSpan.innerHTML="&nbsp;"+curObject.nodeValue.substring(1);else newSpan.innerHTML=curObject.nodeValue;if(pn.className!="")newSpan.className=pn.className;if(pn.style.cssText!="")newSpan.style.cssText=pn.style.cssText;newObject=newSpan;}else{newObject=curObject.cloneNode(true);if(pn.className!="")newObject.className=pn.className;if(pn.style.cssText!="")newObject.style.cssText=pn.style.cssText;}frag.appendChild(newObject);}pn.replaceNode(frag);tempObject=doc.getElementById("___tmp_pre___");}if(globalPreselectStatus){if(globalPreselectMode==0){eval("tempObject.style."+globalPreselectStyleName+"='"+globalPreselectStyleValue+"'");}else{tempObject.className=globalPreselectAttribute;}}else{if(globalPreselectMode==0){eval("tempObject.style."+globalPreselectStyleName+"=''");}else{tempObject.className="";}}tempObject.innerHTML="&nbsp;";tempObject.removeAttribute("id");range.moveToElementText(tempObject);range.collapse(false);range.select();tempObject.innerHTML="";globalPreselectStyleName="";globalPreselectStyleValue="";globalPreselectAttribute="";return;}}}}catch(Error){};try{if(evt.keyCode==13 &&!evt.ctrlKey &&!evt.shiftKey &&!evt.altKey){if(browser.ie){if(globalBreakMode=="br"){if(__editActiveObject.tagName.toUpperCase()!="LI"){__editDisableBR=true;var sel=doc.selection;if(sel.type=="Control")return;var r=sel.createRange();r.pasteHTML("<BR>");r.select();r.moveEnd("character",1);r.moveStart("character",1);r.collapse(false);__editCancelEvent(evt);return false;}}else if(globalBreakMode=="wp"){}else{evt.cancelBubble=true;}}else{if(globalBreakMode=="p" || globalBreakMode=="wp"){var sel=new Selection(doc);if(sel.processEnter(globalBreakMode)){__editCancelEvent(evt);}}}}}catch(Error){};if(evt.keyCode==9){try{var parent=__editActiveObject;while(parent.tagName.toUpperCase()!="BODY"){if(parent.tagName.toUpperCase()=="TD"){__editActiveObject=parent;break;}parent=parent.parentNode;}if(__editActiveObject.tagName.toLowerCase()=="td"){var currentRow=__editActiveObject.parentNode;if(evt.shiftKey){if(__editActiveObject.cellIndex > 0){nextCell=currentRow.cells[__editActiveObject.cellIndex-1];}else{if(currentRow.rowIndex >0)var table=currentRow.parentNode;var lastCell=table.rows[currentRow.rowIndex-1].cells.length-1;nextCell=table.rows[currentRow.rowIndex-1].cells[lastCell];}}else{if(currentRow.cells.length-1 > __editActiveObject.cellIndex){nextCell=currentRow.cells[__editActiveObject.cellIndex+1];}else{var idx=currentRow.rowIndex+1;var table=currentRow.parentNode;if(idx <=table.rows.length-1){nextCell=table.rows[idx].cells[0];}else{var row=currentRow.cloneNode(true);currentRow.parentNode.insertBefore(row,currentRow.nextSibling);for(var i=0;i<row.cells.length;i++){if(browser.ie)row.cells[i].innerHTML="";else row.cells[i].innerHTML="<br id='_ph_'>";}nextCell=row.cells[0];__editOnChanged(true);}}}__editActiveObject=nextCell;var sel=new Selection(doc);sel.setCursorToObject(nextCell);__editCancelEvent(evt);}else{if(evt.shiftKey)editOutdent();else editIndent();__editCancelEvent(evt);}}catch(Error){};}if(evt.keyCode==46 || evt.keyCode==8){if(browser.ie){try{var range=getDoc().selection.createRange();var parentElement=range.parentElement();if(parentElement.tagName.toLowerCase()=="p"){if(parentElement.childNodes.length==0){__editRemoveNode(parentElement);__editCancelEvent(evt);return false;}}}catch(Error){}}}if((evt.keyCode==66 || evt.keyCode==73 || evt.keyCode==85)&& evt.ctrlKey){if(globalUseOnlyStyleFormatting){var tb=editGetToolbar("TOP");var status=true;if(evt.keyCode==66){var bold=tb.getElementByTag("BOLD");status=!(bold ? bold.pressed : true);__editFormat(status,"bold","fontWeight","bold","font-weight");}if(evt.keyCode==73){var italic=tb.getElementByTag("ITALIC");status=!(italic ? italic.pressed : true);__editFormat(status,"italic","fontStyle","italic","font-style");}if(evt.keyCode==85){var underlined=tb.getElementByTag("UNDERLINE");status=!(underlined ? underlined.pressed : true);__editFormat(status,"underline","textDecoration","underline","text-decoration");}__editOnChanged(true);__editCancelEvent(evt);return;}}if(evt.keyCode==46){if(browser.ie){try{var sel=new Selection(doc);var range=sel.getRange();if(sel.getType()=="TEXT"){var parentElement=sel.getParent();var parentTag=parentElement.tagName.toLowerCase();if(parentTag=="tbody" || parentTag=="tr" || parentTag=="table"){var aObjects=sel.getSelectedObjects();for(var i=0;i<aObjects.length;i++){var tag=aObjects[i].tagName.toLowerCase();if(tag=="span" || tag=="p"){__editRemoveNode(aObjects[i]);}if(tag=="td"){aObjects[i].innerHTML="";}}__editOnChanged(true);return;}}if(sel.getType()=="CONTROL"){if(__editActiveObject.tagName.toLowerCase()=="hr"){if(__editActiveObject.id=="__PAGEBREAK__"){var previousTable=__editActiveObject.previousSibling;var nextTable=__editActiveObject.nextSibling;if(previousTable.tagName.toLowerCase()=="table" && nextTable.tagName.toLowerCase()=="table"){if(previousTable.rows[previousTable.rows.length-1].cells.length==nextTable.rows[nextTable.rows.length-1].cells.length){if(confirm(getLanguageString("",1098))){var thead=nextTable.getElementsByTagName("thead")[0];var headerRows=0;if(thead){headerRows=thead.getElementsByTagName("tr").length;}else{var ths=nextTable.getElementsByTagName("th");if(ths.length==0){headerRows=0;}else{var k=1;var curIndex=0;var previousIndex=0;for(var j=0;j<ths.length;j++){curIndex=ths[j].parentNode.rowIndex;if(curIndex!=previousIndex){k++;}previousIndex=curIndex;}headerRows=k;}}for(var l=headerRows;l<nextTable.rows.length;l++){var newRow=nextTable.rows[l].cloneNode(true);var curRow=previousTable.rows[previousTable.rows.length-1];curRow.parentNode.insertBefore(newRow,curRow.nextSibling);}__editRemoveNode(nextTable);__editOnChanged(true);}}}}}}}catch(Error){if(globalDebug)alert("onkeydownPINEDIT: "+Error);};}}};function __delay_paste(){editPasteWithControl();};function __editCancelEvent(evt){if(browser.ie){evt.cancelBubble=true;evt.returnValue=false;}else{evt.preventDefault();}};function onkeypressPINEDIT(e){var evt=__getEventObject(e);if(__editNoEdit){if(__editCheckAllowedKeys(evt)){__editCancelEvent(evt);return;}}try{if(eventOnKeyPress(evt)){__editCancelEvent(evt);return;}}catch(Error){}if(__isIntelli){__editCancelEvent(evt);return;}if(evt.keyCode==globalISKey){if(browser.ie){var sel=getDoc().selection;var r=sel.createRange();r.moveStart("character",-1);var text=r.text;var moved=0;while(text.charCodeAt(0)!="32" && text.charCodeAt(0)!="13" && text.charCodeAt(0)!="10"){if(r.moveStart("character",-1)==0)break;text=r.text;}if(text.charCodeAt(0)=="32" || text.charCodeAt(0)=="13" || text.charCodeAt(0)=="10"){text=text.substring(1,text.length);if(text.charCodeAt(0)=="32" || text.charCodeAt(0)=="13" || text.charCodeAt(0)=="10"){text=text.substring(1,text.length);}}for(var i=0;i<text.length+1;i++){r.moveStart("character",1);}__intelliLeft=r.boundingLeft+7;var top=globalGetPositonY(getEdit());__intelliTop=r.boundingTop+r.boundingHeight+top;__comm=new Comm(targetIntellisense);__comm.execute("INTELLI",text,"");}}if(__editDisableBR){__editCancelEvent(evt);}};function onkeyupPINEDIT(e){var evt=__getEventObject(e);try{if(eventOnKeyUp(evt)){__editCancelEvent(evt);return;}}catch(Error){}if(globalSpellByType){try{clearTimeout(globalSpellTimer);}catch(Error){}globalSpellTimer=setTimeout("editSpellByType()",globalSpellDelay);}if(evt.keyCode==90 && evt.ctrlKey){editUndo();__editCancelEvent(evt);return;}if(evt.keyCode==89 && evt.ctrlKey){editRedo();__editCancelEvent(evt);return;}if(evt.keyCode==65 && evt.ctrlKey){if(editGetSelectionType()!="TEXT"){editSelectAll();}return;}if((evt.keyCode==66 || evt.keyCode==73 || evt.keyCode==85)&& evt.ctrlKey){if(globalUseOnlyStyleFormatting){__editCancelEvent(evt);return;}onchangePINEDIT();}try{var kc=parseInt(evt.keyCode);switch(kc){case 8: case 13: case 32: case 226: case 187: case 188: case 189: case 190: case 191: case 219: case 220: case 221: case 46: setTimeout("__editOnChanged(true)",50);break;default: break;}if(evt.ctrlKey){if(kc==66 || kc==73 || kc==85){__editOnChanged(true);}}else if((kc >=48 && kc <=90)||(kc >=96 && kc <=111)){__editChanged=true;eventOnChanged();}}catch(Error){};if(browser.ie &&(evt.keyCode==46 || evt.keyCode==8)){try{var parentNode=getDoc().selection.createRange().parentElement();if(parentNode.tagName.toLowerCase()=="span")parentNode=parentNode.parentNode;__editRemoveEmpty(parentNode);}catch(Error){}}try{if(browser.ie){if(getDoc().selection.createRange().text.length==0){__editActiveObject=getDoc().selection.createRange().parentElement();}}else{var selection=getWindow().getSelection();var range=selection.getRangeAt(0);__editActiveObject=range.commonAncestorContainer;if(__editActiveObject.nodeType=="3"){__editActiveObject=__editActiveObject.parentNode;}var temp=__editBuildToolbarStatus();eventOnChangeToolbar(temp);}if(browser.ie){if(__isIntelli){__editCancelEvent(evt);return;}if(__editDisableBR){__editDisableBR=false;__editCancelEvent(evt);}}}catch(Error){};try{if(evt.keyCode==13){if(browser.ie){if(globalBreakMode=="wp" &&!evt.ctrlKey &&!evt.shiftKey){if(__editActiveObject.tagName.toLowerCase()=="p"){if(__editActiveObject.style.marginTop=="")__editActiveObject.style.marginTop=0;if(__editActiveObject.style.marginBottom=="")__editActiveObject.style.marginBottom=0;}var parent=__editActiveObject;while(parent){if(parent.tagName.toLowerCase()=="p"){if(parent.style.marginTop=="")parent.style.marginTop=0;if(parent.style.marginBottom=="")parent.style.marginBottom=0;break;}parent=parent.parentNode;}if(parent){if(parent.previousSibling.tagName.toLowerCase()=="p"){if(parent.previousSibling.style.marginTop=="")parent.previousSibling.style.marginTop=0;if(parent.previousSibling.style.marginBottom=="")parent.previousSibling.style.marginBottom=0;}}}__editCancelEvent(evt);}else{if(globalBreakMode=="p" || globalBreakMode=="wp"){__editCancelEvent(evt);}}if(globalShowSpecialChar){__editShowSpecialChar(false);__editShowSpecialChar(true);}}}catch(Error){};};function onkeydownPINEDITHtml(e){var evt;if(browser.ie)evt=document.frames('pinEditHtml').window.event;else evt=e;try{if(eventOnHtmlKeyDown(evt))return;}catch(Error){}if(browser.ie){if(evt.keyCode==13){var sel=pinEditHtml.document.selection;if(sel.type=="Control")return;var r=sel.createRange();r.pasteHTML("<BR>");evt.cancelBubble=true;evt.returnValue=false;r.select();r.moveEnd("character",1);r.moveStart("character",1);r.collapse(false);return false;}}};function onmousedownPINEDITHtml(e){var evt;if(browser.ie)evt=document.frames('pinEditHtml').window.event;else evt=e;try{if(eventOnHtmlMouseDown(evt))return;}catch(Error){}};function __NoBr(evt){if(evt.keyCode==13){evt.cancelBubble=true;evt.returnValue=false;return false;}};function oncontextmenuDisabled(){return false;};function ondropPINEDIT(){var evt=getWindow().event;if(__editNoEdit){__editCancelEvent(evt);return;}try{if(eventOnDrop(evt)){__editCancelEvent(evt);return;}__editOnChanged(true);}catch(Error){}};function ondragPINEDIT(){var evt=getWindow().event;try{if(eventOnDrag(evt)){__editCancelEvent(evt);return;}}catch(Error){}};function oncutPINEDIT(){var evt=getWindow().event;if(__editNoEdit){__editCancelEvent(evt);return;}try{if(eventOnCut(evt)){__editCancelEvent(evt);return;}__editOnChanged(true);}catch(Error){}};function oncopyPINEDIT(){var evt=getWindow().event;try{if(eventOnCopy(evt)){__editCancelEvent(evt);return;}}catch(Error){}};function onpastePINEDIT(){var evt=getWindow().event;if(__editNoEdit){__editCancelEvent(evt);return;}try{if(eventOnPaste(evt)){__editCancelEvent(evt);return;}if(!globalOptimizer){__editSetPlaceHolders();}__editOnChanged(true);}catch(Error){}};function onbeforepastePINEDIT(){var evt=getWindow().event;evt.returnValue=false;};function onmousewheelPINEDIT(){if(globalScrollMode==0){var evt=getWindow().event;document.getElementById('scroll1').scrollTop=document.getElementById('scroll1').scrollTop-evt.wheelDelta;}};function __editInitEvents(mode){var useEditHtml=((mode==2)? true:false);var doc=useEditHtml ? getDocHtml(): getDoc();if(browser.ie){if(!useEditHtml){doc.oncontextmenu=oncontextmenuPINEDIT;doc.onselectionchange=onchangePINEDIT;doc.onmousedown=onmousedownPINEDIT;doc.onmouseup=onmouseupPINEDIT;doc.onmousemove=onmousemovePINEDIT;doc.onmouseover=onmouseoverPINEDIT;doc.onmouseout=onmouseoutPINEDIT;doc.onkeydown=onkeydownPINEDIT;doc.onkeypress=onkeypressPINEDIT;doc.onkeyup=onkeyupPINEDIT;doc.ondblclick=ondblclickPINEDIT;doc.body.ondrop=ondropPINEDIT;doc.body.ondrag=ondragPINEDIT;doc.onfocusout=onfocusoutPINEDIT;doc.onfocusin=onfocusinPINEDIT;doc.onclick=onclickPINEDIT;if(globalDocumentView)doc.body.onmousewheel=onmousewheelPINEDIT;doc.body.oncut=oncutPINEDIT;doc.body.oncopy=oncopyPINEDIT;doc.body.onbeforepaste=onbeforepastePINEDIT;doc.body.onpaste=onpastePINEDIT;getDocPreview().oncontextmenu=oncontextmenuDisabled;}else{doc.oncontextmenu=oncontextmenuDisabled;doc.onkeydown=onkeydownPINEDITHtml;doc.onmousedown=onmousedownPINEDITHtml;}}else{if(!useEditHtml){doc.addEventListener("mouseup",onmouseupPINEDIT,false);doc.addEventListener("mousedown",onmousedownPINEDIT,false);doc.addEventListener("mousemove",onmousemovePINEDIT,false);doc.addEventListener("mouseover",onmouseoverPINEDIT,false);doc.addEventListener("mouseout",onmouseoutPINEDIT,false);doc.addEventListener("contextmenu",oncontextmenuPINEDIT,false);doc.addEventListener("blur",onfocusoutPINEDIT,false);doc.addEventListener("focus",onfocusinPINEDIT,false);doc.addEventListener("keydown",onkeydownPINEDIT,false);doc.addEventListener("keyup",onkeyupPINEDIT,false);doc.addEventListener("dblclick",ondblclickPINEDIT,false);doc.addEventListener("click",onclickPINEDIT,false);}else{doc.addEventListener("mouseup",onmousedownPINEDITHtml,false);doc.addEventListener("keydown",onkeydownPINEDITHtml,false);}}};function __eventOnFileLoaded(){eventOnFileLoaded();__eventOnFileLoaded_Delay();};function __eventOnFileLoaded_Delay(){if(!globalSingleMode){if(__editStylesAvailable &&!__editToolbarReady){setTimeout("__eventOnFileLoaded_Delay()",100);return;}}__editUpdateStyles(true);for(var i=0;i<__editStylesFormat.length;i++){if(globalSingleMode)eventOnChangeFormatDelay(__editStylesFormat[i],__editStylesFormatHtml[i]);else eventOnChangeFormat(__editStylesFormat[i],__editStylesFormatHtml[i]);}};function eventOnAddStyleDelay(name,html){setTimeout("eventOnAddStyleDelay2(\""+name+"\",\""+html+"\")",300);};function eventOnAddStyleDelay2(name,html){eventOnAddStyle(name,html);};function eventOnChangeFormatDelay(name,html){setTimeout("eventOnChangeFormatDelay2(\""+name+"\",\""+html+"\")",400);};function eventOnChangeFormatDelay(name,html){eventOnChangeFormat(name,html);};function __editCheckAllowedKeys(evt){var kc=parseInt(evt.keyCode);switch(kc){case 33: return false;case 34: return false;case 35: return false;case 36: return false;case 37: return false;case 38: return false;case 39: return false;case 40: return false;break;case 65: if(evt.ctrlKey &&!evt.altKey &&!evt.shiftKey){return false;}break;case 67: if(evt.ctrlKey &&!evt.altKey &&!evt.shiftKey){return false;}break;default: break;}return true;};function __getEventObject(e){if(browser.ie)return getWindow().event;else return e;};function __getSourceElement(e){if(browser.ie){return getWindow().event.srcElement;}else{return e.target;}};function eventOnStartup(){if(globalTechnology=="desk"){if(typeof(editOnStartup)=="function")editOnStartup(window);RaiseInternalEvent("INIT");}else{if(typeof(parent.editOnStartup)=="function")parent.editOnStartup(window);}};function eventOnEditorLoaded(){if(typeof(parent.editOnEditorLoaded)=="function")return parent.editOnEditorLoaded(window);};function eventOnEditorReady(){if(typeof(parent.editOnEditorReady)=="function")return parent.editOnEditorReady(window);};function eventOnToolbarLoaded(){if(globalTechnology=="desk"){RaiseInternalEvent("TOOLBAR_READY");}else{if(typeof(parent.editOnToolbarLoaded)=="function")return parent.editOnToolbarLoaded(window);}};function eventOnInit(){if(typeof(parent.editOnInit)=="function")return parent.editOnInit(window);editAddSpecialCharReplacement("\x26","&amp;");editAddSpecialCharReplacement("<","&lt;");editAddSpecialCharReplacement(">","&gt;");editAddSpecialCharReplacement("\xA0","&nbsp;");editAddSpecialCharReplacement("\xA9","&copy;");editAddSpecialCharReplacement("\xAE","&reg;");if(language=="DE"){editAddSpecialCharReplacement("\xC4","&Auml;");editAddSpecialCharReplacement("\xD6","&Ouml;");editAddSpecialCharReplacement("\xDC","&Uuml;");editAddSpecialCharReplacement("\xE4","&auml;");editAddSpecialCharReplacement("\xF6","&ouml;");editAddSpecialCharReplacement("\xFC","&uuml;");editAddSpecialCharReplacement("\xDF","&szlig;");}if(language=="SE"){editAddSpecialCharReplacement("\xC4","&Auml;");editAddSpecialCharReplacement("\xD6","&Ouml;");editAddSpecialCharReplacement("\xE4","&auml;");editAddSpecialCharReplacement("\xF6","&ouml;");editAddSpecialCharReplacement("\xC5","&Aring;");editAddSpecialCharReplacement("\xE5","&aring;");}if(language=="FR"){editAddSpecialCharReplacement("\xE1","&aacute;");editAddSpecialCharReplacement("\xC1","&Aacute;");editAddSpecialCharReplacement("\xF3","&oacute;");editAddSpecialCharReplacement("\xD3","&Oacute;");editAddSpecialCharReplacement("\xE9","&eacute;");editAddSpecialCharReplacement("\xC9","&Eacute;");editAddSpecialCharReplacement("\xE0","&agrave;");editAddSpecialCharReplacement("\xC0","&Agrave;");editAddSpecialCharReplacement("\xE8","&egrave;");editAddSpecialCharReplacement("\xC8","&Egrave;");editAddSpecialCharReplacement("\xF2","&ograve;");editAddSpecialCharReplacement("\xD2","&Ograve;");editAddSpecialCharReplacement("\xE2","&acirc;");editAddSpecialCharReplacement("\xC2","&Acirc;");editAddSpecialCharReplacement("\xEA","&ecirc;");editAddSpecialCharReplacement("\xCA","&Ecirc;");editAddSpecialCharReplacement("\xF4","&ocirc;");editAddSpecialCharReplacement("\xD4","&Ocirc;");editAddSpecialCharReplacement("\xCE","&Icirc;");editAddSpecialCharReplacement("\xEE","&icirc;");}};function eventOnCut(){if(typeof(parent.editOnCut)=="function")return parent.editOnCut(window);};function eventOnCopy(){if(typeof(parent.editOnCopy)=="function")return parent.editOnCopy(window);};function eventOnPaste(){if(globalTechnology=="desk"){RaiseInternalEvent('PASTE');}else{if(typeof(parent.editOnPaste)=="function")return parent.editOnPaste(window);}};function eventOnGotFocus(){if(globalTechnology=="desk"){RaiseInternalEvent('GOTFOCUS');}else{if(typeof(parent.editOnGotFocus)=="function")return parent.editOnGotFocus(window);}};function eventOnLostFocus(){if(globalTechnology=="desk"){RaiseInternalEvent('LOSTFOCUS');}else{if(typeof(parent.editOnLostFocus)=="function")return parent.editOnLostFocus(window);}};function eventOnMouseDown(e){try{if(toolbarsTop)toolbarsTop.reset();if(objMenuBar){var objMenu=objMenuBar.getActiveBarItem();if(objMenu)objMenu.reset();}}catch(Error){}if(globalTechnology=="desk"){var x=__editGetIframePositionX(document.getElementById('pinEdit'))+e.clientX;var y=__editGetIframePositionY(document.getElementById('pinEdit'))+e.clientY;if(RaiseEvent("I","MOUSEDOWN",e.button,x,y)=="1")return true;}else{if(typeof(parent.editOnMouseDown)=="function")return parent.editOnMouseDown(window,e);}};function eventOnMouseUp(e){if(globalTechnology=="desk"){var x=__editGetIframePositionX(document.getElementById('pinEdit'))+e.clientX;var y=__editGetIframePositionY(document.getElementById('pinEdit'))+e.clientY;if(RaiseEvent("I","MOUSEUP",e.button,x,y)=="1")return true;}else{if(typeof(parent.editOnMouseUp)=="function")return parent.editOnMouseUp(window,e);}};function eventOnDblClick(e){if(globalTechnology=="desk"){RaiseInternalEvent("DBLCLICK");}else{if(typeof(parent.editOnDblClick)=="function")return parent.editOnDblClick(window,e);}};function eventOnKeyDown(e){if(globalTechnology=="desk"){if(RaiseEvent("I","KEYDOWN",e.keyCode,e.shiftKey,e.ctrlKey,e.altKey)=="1"){return true;}}else{if(typeof(parent.editOnKeyDown)=="function")return parent.editOnKeyDown(window,e);}if(e.keyCode==122 && e.ctrlKey)editFullSize();};function eventOnKeyUp(e){if(globalTechnology=="desk"){if(RaiseEvent("I","KEYUP",e.keyCode,e.ctrlKey,e.altKey)=="1"){return true;}}else{if(typeof(parent.editOnKeyUp)=="function")return parent.editOnKeyUp(window,e);}};function eventOnKeyPress(e){if(typeof(parent.editOnKeyPress)=="function")return parent.editOnKeyPress(window,e);};function eventOnChanged(){if(globalTechnology=="desk"){RaiseInternalEvent("CHANGED");}else{if(typeof(parent.editOnChanged)=="function")return parent.editOnChanged(window);}};function eventOnCreateContextMenu(objMenu,source,aHierarchy,selection,x,y){if(globalTechnology=="desk"){var ret=RaiseEvent("I","ONCONTEXT",x+__editGetIframePositionX(document.getElementById('pinEdit')),y+__editGetIframePositionY(document.getElementById('pinEdit')));if(ret=="1"){return true;}}else{if(typeof(parent.editOnCreateContextMenu)=="function")return parent.editOnCreateContextMenu(window,objMenu,source,aHierarchy,selection,x,y);}};function eventOnContextMenuItemClick(key,value){if(typeof(parent.editOnContextMenuItemClick)=="function")return parent.editOnContextMenuItemClick(key,value);}function eventOnControlV(){if(globalTechnology=="desk")return;if(typeof(parent.editOnControlV)=="function")return parent.editOnControlV(window);};function eventOnControlS(){if(globalTechnology=="desk")return;if(typeof(parent.editOnControlS)=="function")return parent.editOnControlS(window);if(editGetFileUrl()=="")editSaveDialog();else editSave();};function eventOnObjectActivated(object){if(typeof(parent.editOnObjectActivated)=="function")return parent.editOnObjectActivated(window,object);};function eventOnBeforeNew(mode){if(typeof(parent.editOnBeforeNew)=="function")return parent.editOnBeforeNew(window,mode);};function eventOnBeforeLoad(url){if(typeof(parent.editOnBeforeLoad)=="function")return parent.editOnBeforeLoad(window,url);};function eventOnRequireOptimization(){if(globalTechnology=="desk"){if(RaiseEvent("I","OPTIMIZE")=="1")return true;}else{if(typeof(parent.editOnRequireOptimization)=="function")return parent.editOnRequireOptimization(window);}};function eventOnChangeToolbar(data){if(globalSingleMode){if(globalTechnology=="desk"){RaiseEvent("I","TOOLBARUPDATE",data);}else{if(typeof(parent.editOnChangeToolbar)=="function")return parent.editOnChangeToolbar(window,data);}}else{try{var aData=data.split(":");if(btnBold)btnBold.setStatus(aData[0]>0 ? true:false);if(btnItalic)btnItalic.setStatus(aData[1]>0 ? true:false);if(btnUnderline)btnUnderline.setStatus(aData[2]>0 ? true:false);if(btnStrike)btnStrike.setStatus(aData[19]>0 ? true:false);if(btnSuperscript)btnSuperscript.setStatus(aData[3]>0 ? true:false);if(btnSubscript)btnSubscript.setStatus(aData[4]>0 ? true:false);if(btnJustifyLeft)btnJustifyLeft.setStatus(aData[5]>0 ? true:false);if(btnJustifyCenter)btnJustifyCenter.setStatus(aData[6]>0 ? true:false);if(btnJustifyRight)btnJustifyRight.setStatus(aData[7]>0 ? true:false);if(btnJustifyFull)btnJustifyFull.setStatus(aData[8]>0 ? true:false);if(btnInsertOrderedList)btnInsertOrderedList.setStatus(aData[9]>0 ? true:false);if(btnInsertUnorderedList)btnInsertUnorderedList.setStatus(aData[10]>0 ? true:false);if(cmbStyle)cmbStyle.setSelectedText(aData[11]);if(cmbFormat)cmbFormat.setSelectedText(aData[12]);if(cmbFont)cmbFont.setSelectedText(aData[13]);if(cmbFontSize)cmbFontSize.setText(aData[14]);if(btnRowB)btnRowB.setEnabled(aData[17]=="1" ? true:false);if(btnRowA)btnRowA.setEnabled(aData[17]=="1" ? true:false);if(btnRowDelete)btnRowDelete.setEnabled(aData[17]=="1" ? true:false);if(btnColB)btnColB.setEnabled(aData[17]=="1" ? true:false);if(btnColA)btnColA.setEnabled(aData[17]=="1" ? true:false);if(btnColDelete)btnColDelete.setEnabled(aData[17]=="1" ? true:false);if(btnCellDelete)btnCellDelete.setEnabled(aData[17]=="1" ? true:false);if(btnCellAdd)btnCellAdd.setEnabled(aData[17]=="1" ? true:false);if(btnColSpan)btnColSpan.setEnabled(aData[17]=="1" ? true:false);if(btnCellDivide)btnCellDivide.setEnabled(aData[17]=="1" ? true:false);if(btnRowSpan)btnRowSpan.setEnabled(aData[17]=="1" ? true:false);if(btnCellConvert)btnCellConvert.setEnabled(aData[17]=="1" ? true:false);if(btnCellProp)btnCellProp.setEnabled(aData[17]=="1" ? true:false);if(btnTableProp)btnTableProp.setEnabled(aData[18]=="1" ? true:false);}catch(Error){}}};function eventOnAddStyle(name,html,type,useImage,tag){if(globalSingleMode){if(globalTechnology=="desk"){RaiseEvent("I","LISTSTYLES",name,html,type,useImage,tag);}else{if(typeof(parent.editOnAddStyle)=="function")return parent.editOnOnAddStyle(window,name,html,type,useImage,tag);}}else{try{var combo=toolbarsTop.getElementByTag("STYLE");if(name==""){combo.clear();}else{var imagePath=globalEditorImagesFolder;if(type=="img"){combo.add(toolbarsTop.createStyleComboItem(html,imagePath+"image.gif","",name,type,tag));}else if(type=="td"){combo.add(toolbarsTop.createStyleComboItem(html,imagePath+"cell.gif","",name,type,tag));}else if(type=="table"){combo.add(toolbarsTop.createStyleComboItem(html,imagePath+"table.gif","",name,type,tag));}else if(type=="div"){combo.add(toolbarsTop.createStyleComboItem(html,imagePath+"textbox.gif","",name,type,tag));}else if(type=="p"){combo.add(toolbarsTop.createStyleComboItem(html,imagePath+"paragraph.gif","",name,type,tag));}else if(type=="li" || type=="ul" || type=="ol"){combo.add(toolbarsTop.createStyleComboItem(html,imagePath+"unorderedlist.gif","",name,type,tag));}else if(type=="span"){combo.add(toolbarsTop.createStyleComboItem(html,imagePath+"border.gif","",name,type,tag));}else{if(useImage)combo.add(toolbarsTop.createStyleComboItem(html,imagePath+"empty.gif","",name,"",tag));else combo.add(toolbarsTop.createStyleComboItem(html,"","",name,"",tag));}}}catch(error){}}};function eventOnChangeFormat(name,html){if(typeof(parent.editOnChangeFormat)=="function")return parent.editOnChangeFormat(window,name,html);if(!globalSingleMode){try{var combo=cmbFormat;var item=combo.getItemByValue("<"+name+">");item.text=html+item.tag1+"</span>";}catch(error){}}};function eventOnReadOnly(value){if(typeof(parent.editOnReadOnly)=="function")return parent.editOnReadOnly(window,value);if(globalSingleMode){try{if(value){document.getElementById("toolbar_top").style.display="none";document.getElementById("toolbar_bottom").style.display="none";}else{document.getElementById("toolbar_top").style.display="inline";document.getElementById("toolbar_bottom").style.display="inline";}}catch(error){}}};function eventOnFileLoaded(){if(typeof(parent.editOnFileLoaded)=="function")return parent.editOnFileLoaded(window);};function eventOnBeforeSave(content){if(typeof(parent.editOnBeforeSave)=="function")return parent.editOnBeforeSave(window,content);};function eventOnAfterSave(){if(typeof(parent.editOnAfterSave)=="function")return parent.editOnAfterSave(window);};function eventOnBeforeCreateMenu(objMenuBar){if(typeof(parent.editOnBeforeCreateMenu)=="function")return parent.editOnBeforeCreateMenu(window,objMenuBar);};function eventOnAfterCreateMenu(objMenuBar){if(typeof(parent.editOnAfterCreateMenu)=="function")return parent.editOnAfterCreateMenu(window,objMenuBar);};function eventOnCreateTable(row,column){if(globalTechnology=="desk"){if(RaiseEvent("I","CREATETABLE",row,column)=="1")return true;}else{if(typeof(parent.editOnCreateTable)=="function")return parent.editOnCreateTable(window,row,column);}editCreateTable(row,column);};function eventOnAfterInsertObject(type,obj){if(typeof(parent.editOnAfterInsertObject)=="function")return parent.editOnAfterInsertObject(window,type,obj);};function eventOnDrop(evt){var text="";if(browser.ie)text=evt.dataTransfer.getData("Text");if(globalTechnology=="desk"){if(RaiseEvent("I","DROP",text)=="1")return true;}else{if(typeof(parent.editOnDrop)=="function")return parent.editOnDrop(window,text);}};function eventOnDrag(){if(typeof(parent.editOnDrag)=="function")return parent.editOnDrag(window);};function eventOnAfterInsertDocument(absurl){if(typeof(parent.editOnAfterInsertDocument)=="function")return parent.editOnAfterInsertDocument(window,absurl);};function eventOnPreviewBeforePageAdd(pageCount){if(typeof(parent.editOnPreviewBeforePageAdd)=="function")return parent.editOnPreviewBeforePageAdd(window,pageCount);};function eventOnHtmlMouseDown(e){if(typeof(parent.editOnHtmlMouseDown)=="function")return parent.editOnHtmlMouseDown(window,e);};function eventOnHtmlKeyDown(e){if(typeof(parent.editOnHtmlKeyDown)=="function")return parent.editOnHtmlKeyDown(window,e);};function eventOnPDFCreated(name){if(typeof(parent.editOnPDFCreated)=="function")return parent.editOnPDFCreated(window,name,globalPDFOutputUrl);editStatusBarSetText("PDF file created");var url=globalPDFOutputUrl+name;window.open(url);};/*
Modification or decryption of this file is strictly forbidden - Pintexx GmbH
*/
function editMarkCursorPosition(){var sel=new Selection(getDoc());if(sel.type!="NONE"){var range=sel.getRange();range.collapse(true);range.select();}var fonts=getDoc().getElementsByTagName("font");for(var i=0;i<fonts.length;i++){if(fonts[i].id=="__cursor__"){editRemoveNode(fonts[i]);}}editSetFocus();var sel=new Selection(getDoc());sel.insertHtml("<font id='__cursor__'></font>");}function editSetCursorToMarker(){var sel=new Selection(getDoc());sel.setCursorToMarker();}function __editRemovePlaceHolder(html){if(browser.ie){var reg=new RegExp(globalPlaceHolderCharacter,"gi");html=html.replace(reg,"");var replaceChar=String.fromCharCode(8201);var reg=new RegExp(replaceChar,"gi");html=html.replace(reg,"");}else{var reg=new RegExp("<br id=\"_ph_\">","gi");html=html.replace(reg,"");}return html;};function __editReplaceSpanByText(curObject){try{if(curObject.childNodes.length==1 && curObject.firstChild.nodeType==3){if(curObject.style.cssText=="" && curObject.className==""){var text=curObject.innerHTML;text=text.replace(/&nbsp;/," ");text=text.replace(/\n/,"");text=text.replace(/\r/,"");text=text.replace(/&amp;/gi,"&");if(text==""){__editRemoveNode(curObject);}else{var newNode=curObject.ownerDocument.createTextNode(text);__editReplaceNode(curObject,newNode);}}}}catch(Error){if(globalDebug)alert("__editReplaceSpanByText: "+Error)}};function __editSetPlaceHolders(curObject){if(!globalAddPlaceHolders)return;try{if(!curObject)curObject=getDoc().body;var allP=curObject.getElementsByTagName("p");for(var i=0;i<allP.length;i++){var curNode=allP[i];if(curNode.firstChild==null){__editAddParagraphPlaceHolder(curNode);}if(curNode.childNodes.length==1){var firstNode=curNode.firstChild;if(firstNode.nodeType==3){var text=firstNode.nodeValue;text=text.replace(/\r/gi,"");text=text.replace(/\n/gi,"");text=text.replace(/^\s/gi,"");if(text=="" ||(text==String.fromCharCode(160))){__editRemoveNode(firstNode);__editAddParagraphPlaceHolder(curNode);}}}}}catch(Error){}};function __editAddParagraphPlaceHolder(parentNode){if(!globalAddPlaceHolders)return;try{var doc=getDoc();if(browser.ie){if(parentNode.innerText==""){var sp=doc.createTextNode(globalPlaceHolderCharacter);parentNode.appendChild(sp);}}else{var allP=parentNode.getElementsByTagName("br");for(var i=0;i<allP.length;i++){if(allP[i].id=="_ph_"){__editRemoveNode(allP[i]);}}if(parentNode.textContent==""){var br=doc.createElement("br");br.id="_ph_";parentNode.appendChild(br);}}}catch(Error){}};function __editAddParagraphSpace(){if(!globalAddPlaceHolders)return;try{var doc=getDoc();var allP=doc.getElementsByTagName("p");for(var i=0;i<allP.length;i++){var curNode=allP[i];if(browser.ie){if(curNode.childNodes.length==1){if(curNode.firstChild.nodeType==3){if(curNode.firstChild.nodeValue==globalPlaceHolderCharacter){curNode.firstChild.nodeValue=String.fromCharCode(160);}}}}else{if(curNode.childNodes.length==1){var firstNode=curNode.firstChild;if(firstNode.nodeType!=3){if(firstNode.tagName.toLowerCase()=="br"){var textNode=doc.createTextNode(String.fromCharCode(160));if(firstNode.id=="_ph_"){__editReplaceNode(firstNode,textNode);}}}}}}}catch(Error){}};function __editSetSpaceInTables(value){if(!globalAddTableCellSpace)return;try{var aTables=getDoc().getElementsByTagName("table");for(i=0;i<aTables.length;i++){var currentTable=aTables[i];for(var j=0;j<currentTable.rows.length;j++){var currentRow=currentTable.rows[j];for(var k=0;k<currentRow.cells.length;k++){var curCell=currentRow.cells[k];if(value){if(curCell.childNodes.length==1){var firstNode=curCell.firstChild;if(firstNode.nodeType==3){if(firstNode.nodeValue==globalPlaceHolderCharacter){firstNode.nodeValue=String.fromCharCode(160);}}}else if(curCell.innerHTML==""){curCell.innerHTML="&nbsp;";}}else{if(curCell.childNodes.length==1){var firstNode=curCell.firstChild;if(firstNode.nodeType==3){if(firstNode.nodeValue==String.fromCharCode(160)){firstNode.nodeValue=globalPlaceHolderCharacter;}}}else if(curCell.innerHTML==""){curCell.innerHTML=globalPlaceHolderCharacter;}}}}}}catch(Error){}};function editPasteWord(){if(!editPaste())return;editCleanWord();__editOnChanged(true);};function __editReplaceNode(node,replaceNode){try{if(browser.ie)node.replaceNode(replaceNode);else node.parentNode.replaceChild(replaceNode,node);}catch(Error){}};function __editRemoveStyleElement(element,style,styleName){try{if(browser.ie)element.style.removeAttribute(style);else element.style.removeProperty(styleName);}catch(Error){}};function editGetCurrentStyle(curObject,styleName,styleName2){var style=null;if(browser.ie)style=curObject.currentStyle[styleName];else style=getDoc().defaultView.getComputedStyle(curObject,null).getPropertyValue(styleName2);if(style==null || style=="undefined")style="";return style;};function editHighlightWords(value,highlightAll){try{var doc=getDoc();var fontElements=new Array();var allFont=doc.body.getElementsByTagName("font");for(var i=0;i<allFont.length;i++){var color=allFont[i].style.backgroundColor.toLowerCase();if(!browser.ie)color=rgbToHex(color).toLowerCase();if(color==__editHighlightColor){fontElements[fontElements.length]=allFont[i];}}for(var i=0;i<fontElements.length;i++){var curNode=fontElements[i];var frag=curNode.ownerDocument.createDocumentFragment();for(var j=0;j<curNode.childNodes.length;j++){var subNode=curNode.childNodes[j].cloneNode(true);if(subNode.nodeType==3){var newNode=curNode.ownerDocument.createTextNode(subNode.nodeValue);frag.appendChild(newNode);}else{var newNode=subNode;frag.appendChild(newNode);}}if(browser.ie){fontElements[i].replaceNode(frag);}else{fontElements[i].parentNode.replaceChild(frag,fontElements[i]);}}if(!value || value=="")return;value=value.replace(/\/;/gi,"##");var aValues=value.split(__editHighlightSeparator);for(var i=0;i<aValues.length;i++){aValues[i]=aValues[i].replace(/##/gi,";");}var isDone=false;for(var i=0;i<aValues.length;i++){var value=aValues[i];if(value!=""){for(var j=0;j<i;j++){if(aValues[j]==value){isDone=true;break;}}if(!isDone){if(browser.ie){var curRange=doc.body.createTextRange();while(curRange.findText(value,1,__editHighlightCaseSensitive ? 4:0)){try{curRange.select();var currentHtml=curRange.htmlText;if(doc.selection.type.toLowerCase()!='none')doc.selection.clear();var space=curRange.htmlText;curRange.pasteHTML("<font style='background-color:"+__editHighlightColor+"'>"+currentHtml+"</font>"+space);if(!highlightAll)break;}catch(Error){break;}}}else{__editFFFindTextMatches=new Array();__editFFFindText(doc.body,value,!__editHighlightCaseSensitive,false);if(__editFFFindTextMatches.length > 0){__editFFHighlightText(value);}}}}}}catch(Error){}};var __editFFFindTextMatches=new Array();function __editFFFindText(body,query,ignoreCase,wholeWord){__editFFFindTextMatches.length=0;if(ignoreCase)query=query.toLowerCase();var tw=body.ownerDocument.createTreeWalker(body,NodeFilter.SHOW_TEXT,{acceptNode: function(node){return NodeFilter['FILTER_'+(RegExp(query,(ignoreCase ? 'i' : '')).test(node.nodeValue)? 'ACCEPT' : 'REJECT')]}},true);var offsets=[];offsets[-1]=query.length*-1;var totalMatches,trueOffsetDiff;var range=body.ownerDocument.createRange();while(tw.nextNode()){totalMatches=tw.currentNode.nodeValue.split(RegExp(query,(ignoreCase ? 'i' : ''))).length-1;for(var i=0;i < totalMatches;i++){var checkWord=true;if(wholeWord){if(tw.currentNode.nodeValue.length!=query.length)checkWord=false;}if(checkWord){trueOffsetDiff=offsets[offsets.length-1]+query.length;offsets[offsets.length]=tw.currentNode.nodeValue.substr(trueOffsetDiff)[ignoreCase ? 'toLowerCase' : 'toString']().indexOf(query)+trueOffsetDiff;range.selectNode(tw.currentNode);range.setStart(tw.currentNode,offsets[offsets.length-1]);range.setEnd(tw.currentNode,range.startOffset+query.length);__editFFFindTextMatches[__editFFFindTextMatches.length]=range.cloneRange();}}offsets.length=0;}return(tw.currentNode!=body);};function __editFFHighlightText(value){if(__editFFFindTextMatches.length > 0){with(document.getElementById('pinEdit').contentWindow.getSelection()){removeAllRanges();addRange(__editFFFindTextMatches.shift());editInsertHtml("<font style='background-color:"+__editHighlightColor+"'>"+value+"</font>");}return true;}else{return false;}};function editRemoveLink(){if(!browser.ie){try{if(!editHasSelection()){var aHierarchy=__editGetTagHierarchy(__editActiveObject,1);for(var i=0;i<aHierarchy.length;i++){if(aHierarchy[i].tagName.toLowerCase()=="a"){var newNode=getDoc().createTextNode(aHierarchy[i].innerHTML);aHierarchy[i].parentNode.replaceChild(newNode,aHierarchy[i]);return;}}return;}}catch(Error){}}execute('unlink',false,null);__editOnChanged(true);};function editClean(mode){editSetFocus();__editClean(mode);__editOnChanged(true);};function editOptimize(level,object){var curObject=null;var sel=new Selection(getDoc());if(sel.type=="CONTROL"){return;}if(globalOptimizerPath!=""){__editOptimizeTidy(object);}else{__editOptimize(level,object);}};function __editOptimize(level,object){__editAddAltAttribute(object);__editRemoveEmpty(object);editCleanWord(object);if(level > 1)editRemoveStylesWhenClass(object);editReplaceFontTag(object);editRemoveStandardTags(object);editRemoveSpan(level,object);__editSetPlaceHolders(object);__editOnChanged(true);setTimeout("__editOptimizeDelay()",50);};function __editOptimizeDelay(){__editUpdateScrollBar();};function __editClean(mode){try{var doc=getDoc();var sel=new Selection(doc);if(sel.type=="NONE"){alert(getLanguageString("",4500));return;}var sel=new Selection(doc);var selectedObjects=sel.getSelectedObjects(true);var haveTable=false;var aRemoveAnchor=new Array();for(var i=0;i<selectedObjects.length;i++){var curObject=selectedObjects[i];if(curObject.tagName.toLowerCase()=="table"){if(curObject.border==0){haveTable=true;}}if(mode==0)curObject.removeAttribute("style");if(mode==1){curObject.removeAttribute("className");curObject.removeAttribute("class");}if(mode==2){curObject.removeAttribute("align");curObject.removeAttribute("vAlign");curObject.removeAttribute("lang");}if(mode==3){if(curObject.tagName.toLowerCase()=="a"){if(curObject.name!="" && curObject.href==""){aRemoveAnchor[aRemoveAnchor.length]=curObject;}}}if(selectedObjects[i].tagName.toLowerCase()=="p" && globalBreakMode=="wp"){selectedObjects[i].style.marginTop=0;selectedObjects[i].style.marginBottom=0;}}for(var i=0;i<aRemoveAnchor.length;i++){__editRemoveNode(aRemoveAnchor[i]);}if(mode==2){execute('RemoveFormat');}if(haveTable){editSetTableHighlight(true);}var margin=doc.body.style.marginLeft;doc.body.style.marginLeft=1;doc.body.style.marginLeft=margin;}catch(Error){}};function editCleanWord(curObject){try{if(!curObject)curObject=getDoc().body;var allObjects=curObject.getElementsByTagName("*");for(var i=0;i<allObjects.length;i++){allObjects[i].removeAttribute("w:st");allObjects[i].removeAttribute("o:ls");allObjects[i].removeAttribute("ls");var prefix=allObjects[i].className.substring(0,3).toLowerCase();if(prefix=="mso"){allObjects[i].removeAttribute("className");allObjects[i].removeAttribute("class");}if(allObjects[i].className=="null"){allObjects[i].removeAttribute("className");allObjects[i].removeAttribute("class");}__editRemoveStyleAttribute(allObjects[i],"tab-stops");__editRemoveWordStyle(allObjects[i]);}var aB=curObject.getElementsByTagName("br");for(var i=0;i<aB.length;i++){aB[i].removeAttribute("style");aB[i].removeAttribute("clear");}var aB=curObject.getElementsByTagName("b");for(var i=0;i<aB.length;i++){aB[i].removeAttribute("style");}var aSpan=curObject.getElementsByTagName("span");for(var i=0;i<aSpan.length;i++){aSpan[i].removeAttribute("lang");aP=aSpan[i].getElementsByTagName("p");for(j=0;j<aP.length;j++){if(aP[j].childNodes.length==0){__editRemoveNode(aP[j]);}}}var aFont=curObject.getElementsByTagName("font");for(var i=0;i<aFont.length;i++){aP=aFont[i].getElementsByTagName("p");for(j=0;j<aP.length;j++){if(aP[j].childNodes.length==0){__editRemoveNode(aP[j]);}}}if(globalOptimizeAnchor){var aAnchor=curObject.getElementsByTagName("a");var aRemoveAnchor=new Array();for(var i=0;i<aAnchor.length;i++){if(aAnchor[i].name!="" && aAnchor[i].href==""){if(aAnchor[i].childNodes.length==0){aRemoveAnchor[aRemoveAnchor.length]=aAnchor[i];}}}for(var i=0;i<aRemoveAnchor.length;i++){__editRemoveNode(aRemoveAnchor[i]);}}var aRect=curObject.getElementsByTagName("rect");while(aRect.length >0){__editRemoveNode(aRect[0]);aRect=curObject.getElementsByTagName("rect");}var aShapetype=curObject.getElementsByTagName("shapetype");while(aShapetype.length >0){__editRemoveNode(aShapetype[0]);aShapetype=curObject.getElementsByTagName("shapetype");}var aShape=curObject.getElementsByTagName("shape");while(aShape.length >0){var aID=aShape[0].getElementsByTagName("imagedata");if(aID.length==0){__editRemoveNode(aShape[0]);}else{var src="";for(var j=0;j<aID.length;j++){src=aID[j].src;}var image=curObject.ownerDocument.createElement("img");image.src=src;image.border=0;image.style.cssText=aShape[0].style.cssText;if(browser.ie)aShape[0].replaceNode(image);else aShape[0].parentNode.replaceChild(image,aShape[0]);}aShape=curObject.getElementsByTagName("shape");}}catch(Error){}};function __editRemoveWordStyle(curObject){var hasWordBidiFontSize=false;var hasFontSize=false;var styleCSS=curObject.style.cssText;var aStyles=styleCSS.split(";");var aNewStyles=new Array();for(var j=0;j<aStyles.length;j++){var style=aStyles[j];style=style.replace(/^\s/i,"");var aStyle=style.split(":");if(aStyle[0].substring(0,4).toLowerCase()=="mso-"){if(aStyle[0]=="mso-bidi-font-size"){aNewStyles[aNewStyles.length]=style;hasWordBidiFontSize=true;}}else{if(style.toLowerCase().indexOf("font-size")==0)hasFontSize=true;aNewStyles[aNewStyles.length]=style;}}var temp="";if(hasWordBidiFontSize && hasFontSize){for(var i=0;i<aNewStyles.length;i++){if(aNewStyles[i].toLowerCase().indexOf("mso-bidi-font-size")>=0){aNewStyles[i]="";}}}if(hasWordBidiFontSize &&!hasFontSize){for(var i=0;i<aNewStyles.length;i++){if(aNewStyles[i].toLowerCase().indexOf("mso-bidi-font-size")>=0){aNewStyles[i]=aNewStyles[i].replace("mso-bidi-font-size","font-size");}}}for(var i=0;i<aNewStyles.length;i++){temp+=aNewStyles[i]+";"}if(temp=="" || temp==";")curObject.removeAttribute("style");else curObject.style.cssText=temp;};function __editRemoveStyleAttribute(curObject,name){var styleCSS=curObject.style.cssText;var aStyles=styleCSS.split(";");var aNewStyles=new Array();for(var j=0;j<aStyles.length;j++){var style=aStyles[j];style=style.replace(/^\s/i,"");var aStyle=style.split(":");if(aStyle[0].toLowerCase()!=name){aNewStyles[aNewStyles.length]=style;}}var temp="";for(var i=0;i<aNewStyles.length;i++){temp+=aNewStyles[i]+";"}curObject.style.cssText=temp;};function editRemoveStylesWhenClass(curObject){if(!globalRemoveInlineStyles)return;if(!curObject)curObject=getDoc().body;var allTags=curObject.getElementsByTagName("*");for(var i=0;i<allTags.length;i++){if(allTags[i].className!="" && allTags[i].style.cssText!=""){allTags[i].removeAttribute("style");}}};function __editAddAltAttribute(curObject){try{if(!curObject)curObject=getDoc().body;var aImages=curObject.getElementsByTagName("img");for(var i=0;i<aImages.length;i++){if(aImages[i].alt=="")aImages[i].alt="";}}catch(error){}};var __editRemoveEmptyCount=0;var __editRemoveEmptyCurrent=0;function __editRemoveEmpty(curObject){try{if(!curObject)curObject=getDoc().body;__editRemoveEmptyCount=curObject.getElementsByTagName("*").length;__editRemoveEmptyCurrent=0;__editRemoveEmptyNode(curObject);}catch(error){}};function __editRemoveEmptyNode(node){var aEmpty=new Array();var childs=node.childNodes;for(var i=0;i<childs.length;i++){if(childs[i].canHaveChildren || childs[i].hasChildNodes()){__editRemoveEmptyNode(childs[i]);}var isRemove=false;if(childs[i].nodeType!=3){__editRemoveEmptyCurrent++;if(__editRemoveEmptyCurrent > __editRemoveEmptyCount){return;}var tag=childs[i].tagName.toLowerCase();if(tag=="span" || tag=="font" || tag=="strong" || tag=="u" || tag=="em" || tag=="b" || tag=="div" || tag=="p" || tag=="a"){if(childs[i].childNodes.length <=1){if(childs[i].childNodes.length==1){if(childs[i].childNodes[0].nodeType==3){var text=childs[i].childNodes[0].nodeValue;text=text.replace(/\r/gi,"");text=text.replace(/\n/gi,"");text=text.replace(/^\s/gi,"");if(text==""){isRemove=true;}else{if(text.length==1){if(text.charCodeAt(0)==160){isRemove=true;}}}}}else{isRemove=true;}if(isRemove){if(tag=="span" || tag=="font" || tag=="strong" || tag=="u" || tag=="em" || tag=="b" || tag=="a"){if(tag=="a"){if(childs[i].name==""){aEmpty[aEmpty.length]=childs[i];}}else{aEmpty[aEmpty.length]=childs[i];}}else{var parentTag=childs[i].parentNode.tagName.toLowerCase();if(parentTag=="span" || parentTag=="p"){aEmpty[aEmpty.length]=childs[i];}}}}}if(tag=="script"){aEmpty[aEmpty.length]=childs[i];}}}for(var i=0;i<aEmpty.length;i++){__editRemoveNode(aEmpty[i]);}};function __editOptimizeTidy(curObject){var html="";var pageUrl=__editGetEditorUrl()+"server/"+globalTechnology+"/optimize."+globalTechnology;if(globalOptimizerPath!=""){html+="<body>";html+="<form name='frmComm' id='frmComm' name='frmComm' method ='POST' action='"+pageUrl+"'>";html+="<input type='hidden' id='html' name='html' value=''>";html+="<input type='hidden' id='path' name='path' value=''>";html+="<input type='hidden' id='params' name='params' value=''>";html+="</form>";html+="</body>";html+="</html>";if(!document.getElementById("__remote_frame")){iframe=document.createElement("IFRAME");if(globalSupportHttps && browser.ie)iframe.src="dummy.html";document.body.appendChild(iframe);iframe.id="__remote_frame";iframe.style.visibility="hidden";iframe.style.position="absolute";iframe.style.left=0;iframe.style.top=0;}else{iframe=document.getElementById("__remote_frame");}var doc=document.getElementById("__remote_frame").contentWindow.document;doc.open();doc.write(html);doc.close();if(!curObject)curObject=getDoc().body;var temp=curObject.innerHTML;if(globalConvertChar)temp=__editConvertCode(temp);doc.getElementById("html").value=temp;doc.getElementById("path").value=globalOptimizerPath;doc.getElementById("params").value=globalOptimizerParams;doc.getElementById("frmComm").submit();}else{__callback_optimizer(curObject.innerHTML);}};function __callback_optimizer(html){if(__editTidyMode==0){getDoc().body.innerHTML=html;__editOptimize(2);}else{try{__editTidyMode=0;var doc=document.getElementById("__paste_frame").contentWindow.document;doc.body.innerHTML=html;__editOptimize(2,doc.body);var textRange=getDoc().body.createTextRange();var ret=textRange.moveToBookmark(globalSaveBookmark);textRange.select();editInsertHtml(doc.body.innerHTML);var aImages=doc.getElementsByTagName("img");var hasImage=false;for(var i=0;i<aImages.length;i++){var src=aImages[i].src.toLowerCase();if(src.substring(0,5)=="file:"){hasImage=true;}}if(hasImage){var doc=getDoc();var html=doc.documentElement.innerHTML;doc.open();doc.write(html);doc.close();}}catch(Error){}}__editSetPlaceHolders();};function editPreview(){var win;var html="";var left=screen.width/2-900/2;var top=screen.height/2-700/2;var doc=getDoc();doc.body.removeAttribute("contenteditable","",0);__editAddParagraphSpace();__editSetSpaceInTables(true);__editHideSymbols();if(browser.ie)html=doc.documentElement.outerHTML;else html="<html>"+doc.documentElement.innerHTML+"</html>";html=__editRemovePlaceHolder(html);html=__editGetDocType()+html;doc.body.contentEditable=true;__editShowSymbols();__editSetSpaceInTables(false);__editSetPlaceHolders();win=window.open("","color","modal=1,left="+left+",top="+top+",height=700,width=900,resizable=1,status=0,menubar=1,scrollbars=1");win.document.open();win.document.write(html);win.document.close();};function editPrintPreview(){try{var left=screen.width/2-900/2;var top=screen.height/2-700/2;var doc=getDoc();doc.body.removeAttribute("contenteditable","",0);__editHideSymbols();if(browser.ie)html=doc.documentElement.outerHTML;else html="<html>"+doc.documentElement.innerHTML+"</html>";html=__editGetDocType()+html;doc.body.contentEditable=true;__editShowSymbols();var OLECMDID=7;var PROMPT=1;var htmlObject="<OBJECT ID='browser' WIDTH=0 HEIGHT=0 CLASSID='CLSID:8856F961-340A-11D0-A96B-00C04FD705A2'></OBJECT>";win=window.open("","color","left="+left+",top="+top+",height=700,width=900,resizable=1,status=0,menubar=1,scrollbars=1");win.document.open();win.document.write(html);win.document.close();win.document.body.insertAdjacentHTML('beforeEnd',htmlObject);win.document.browser.ExecWB(OLECMDID,PROMPT);win.document.browser.outerHTML="";win.close();}catch(Error){}};function editSetSaveMode(mode){__editSaveMode=mode;};function editSetForeground(){__editOnChanged(true);editSetToForeground();__editHidePopup();};function editSetBackground(){__editOnChanged(true);editSetToBackground();__editHidePopup();};function editSetToForeground(){var index=0;var objects=getDoc().body.getElementsByTagName('*');for(var i=0;i<objects.length;i++){var object=objects[i];var tag=object.tagName.toUpperCase();if(tag=="DIV" || tag=="SELECT" || tag=="INPUT" || tag=="P"){var curIndex=parseInt(object.style.zIndex);if(curIndex > index){index=curIndex;}}}editGetActiveObject().style.zIndex=index+1;__editOnChanged(true);};function editSetToBackground(){editGetActiveObject().style.zIndex=0;__editOnChanged(true);};function editSearch(){var editorUrl=__editGetEditorUrl();__editPrepareParams();if(browser.ie){var values=window.showModalDialog(editorUrl+"dialogs/searchreplace.html",__editMozParam,"dialogHeight:"+(200+globalDialogOffset)+"px;dialogWidth:400px;resizable:0;status:0;scroll:0");editSetFocus();}else{var left=screen.width/2-420/2;var top=screen.height/2-240/2;window.open(editorUrl+"dialogs/searchreplace.html","Search","modal=1,left="+left+",top="+top+",height=240,width=420,resizable=0,status=0,scrollbars=0");}};function editSelectAll(){if(browser.ie){var rng=getDoc().body.createTextRange();rng.select();}else{execute('selectall',false,null);}};function editBookmark(value){if(value)execute('createbookmark',null,'Text');else execute('UnBookmark');};function editAbsolute(){try{if(__editActiveObject){if(__editActiveObject.tagName.toLowerCase()!="td"){if(__editActiveObject.style.position.toUpperCase()=="ABSOLUTE"){if(browser.ie){var range=getDoc().selection.createRange();if(range.length==1){execute('AbsolutePosition','',false);execute('2D-Position','',false);}else{execute('AbsolutePosition','',true);execute('2D-Position','',true);}}else{__editActiveObject.style.position="";}}else{if(browser.ie){__editActiveObject.style.position="absolute";execute('2D-Position','',true);}else{__editActiveObject.style.position="absolute";}}__editOnChanged(true);}}}catch(Error){}};function editGetMode(){return lastMode;};function editSetMode(mode){setMode(mode);};function editGetDocument(){return getDoc();};function editMenuVisible(value){__editMenuVisible=value;if(value){if(objMenuBar){objMenuBar.setVisible(true);document.body.style.marginTop=22;}}else{if(objMenuBar){objMenuBar.setVisible(false);document.body.style.marginTop=1;}}};function editGetMenuVisible(){return __editMenuVisible;};function editSetDirection(dir){try{editSetFocus();if(__editActiveObject){__editActiveObject.style.direction=dir;__editOnChanged(true);}}catch(Error){};};function editSetEditable(value){if(__NotSupportedByMozilla())return;try{editSetFocus();if(value){var newObjects=__editPrepareSelection();for(var i=0;i<newObjects.length;i++){newObjects[i].removeAttribute("contentEditable");newObjects[i].removeAttribute("unselectable");if(globalEditableColor!="")newObjects[i].style.removeAttribute("backgroundColor");}popup.hide();}else{var newObjects=__editPrepareSelection();for(var i=0;i<newObjects.length;i++){var tag=newObjects[i].tagName.toLowerCase();if(tag=="span" || tag=="div" || tag=="img"){newObjects[i].contentEditable=false;newObjects[i].unselectable="ON";if(globalEditableColor!=""){newObjects[i].style.backgroundColor=globalEditableColor;}}}}__editOnChanged(true);}catch(Error){};};function editHasChanged(){return __editChanged;};function editResetChanged(){__editChanged=false;};function editSaveLocal(){if(__NotSupportedByMozilla())return;var html=editGetHtml();if(!document.getElementById("__remote_frame")){iframe=document.createElement("IFRAME");if(globalSupportHttps && browser.ie)iframe.src="dummy.html";document.body.appendChild(iframe);iframe.id="__remote_frame";iframe.style.visibility="hidden";}else{iframe=document.getElementById("__remote_frame");}var doc=document.getElementById("__remote_frame").contentWindow.document;doc.open();doc.write(html);doc.close();doc.execCommand('SaveAs','true');__editOnChanged(false);};function editGetVersion(){return ___version;};function editRemoveAttribute(attributeName){var body=getDoc().body;var changed=false;var all=body.getElementsByTagName('*');for(var i=0;i<all.length;i++){var object=all[i];object.removeAttribute(attributeName,"",0);changed=true;}if(changed)__editOnChanged(true);};function editRemoveTag(tagName){var body=getDoc().body;var changed=false;var all=body.getElementsByTagName('*');for(var i=0;i<all.length;i++){var object=all[i];if(object.tagName.toUpperCase()==tagName.toUpperCase()){object.removeNode(true);changed=true;}}if(changed)__editOnChanged(true);};var __editRemoveStandardCount=0;var __editRemoveStandardCurrent=0;var __aRemoveStandardTags=new Array();function editRemoveStandardTags(curObject){try{__aRemoveStandardTags[0]=new Pair("b","font-weight:bold");__aRemoveStandardTags[1]=new Pair("strong","font-weight:bold");__aRemoveStandardTags[2]=new Pair("i","font-style:italic");__aRemoveStandardTags[3]=new Pair("em","font-style:italic");__aRemoveStandardTags[4]=new Pair("u","text-decoration:underline");__aRemoveStandardTags[5]=new Pair("s","text-decoration:line-through");__aRemoveStandardTags[6]=new Pair("strike","text-decoration:line-through");if(!curObject)curObject=getDoc().body;__editRemoveStandardCount=1;__editRemoveStandardCurrent=0;__editRemoveStandardNode(curObject);}catch(Error){}};function __editRemoveStandardNode(node){var childs=node.childNodes;for(var i=0;i<childs.length;i++){if(childs[i].canHaveChildren || childs[i].hasChildNodes()){__editRemoveStandardNode(childs[i]);}for(var k=0;k<__aRemoveStandardTags.length;k++){var pair=__aRemoveStandardTags[k];if(childs[i].nodeName.toLowerCase()==pair.key){var curNode=childs[i];var newSpan=curNode.ownerDocument.createElement("span");newSpan.style.cssText=pair.value;for(var j=0;j<curNode.childNodes.length;j++){var subNode=curNode.childNodes[j].cloneNode(true);if(subNode.nodeType==3){var newNode=curNode.ownerDocument.createTextNode(subNode.nodeValue);newSpan.appendChild(newNode);}else{var newNode=subNode;newSpan.appendChild(newNode);}}if(browser.ie)curNode.replaceNode(newSpan);else curNode.parentNode.replaceChild(newSpan,curNode);}}}};var __editRemoveSpanCount=0;var __editRemoveSpanCurrent=0;function editRemoveSpan(level,curObject){try{if(!curObject)curObject=getDoc().body;__editRemoveSpanCount=curObject.getElementsByTagName("span").length;__editRemoveSpanCurrent=0;__editRemoveSpanNode(curObject,level);}catch(Error){}};function __editRemoveSpanNode(node,level){var childs=node.childNodes;for(var i=0;i<childs.length;i++){if(childs[i].canHaveChildren || childs[i].hasChildNodes()){__editRemoveSpanNode(childs[i],level);}if(childs[i].nodeName.toLowerCase()=="span"){if(childs[i].outerHTML.toLowerCase().indexOf("<span>")==0){__editRemoveSpanCurrent++;if(__editRemoveSpanCurrent > __editRemoveSpanCount){return;}var curNode=childs[i];var frag=curNode.ownerDocument.createDocumentFragment();for(var j=0;j<curNode.childNodes.length;j++){var subNode=curNode.childNodes[j].cloneNode(true);if(subNode.nodeType==3){var newNode=curNode.ownerDocument.createTextNode(subNode.nodeValue);frag.appendChild(newNode);}else{var newNode=subNode;frag.appendChild(newNode);}}if(browser.ie)curNode.replaceNode(frag);else curNode.parentNode.replaceChild(frag,curNode);}else{if(childs[i].childNodes.length==1){if(childs[i].childNodes[0].nodeName.toLowerCase()=="span"){var curSpan=childs[i];var subSpan=childs[i].childNodes[0];if(curSpan.style.cssText!=""){subSpan.style.cssText=curSpan.style.cssText+";"+subSpan.style.cssText;}if(curSpan.className!=""){if(subSpan.className==""){subSpan.className=curSpan.className;if(globalRemoveInlineStyles &&(level >1)){subSpan.removeAttribute("style");}}}if(browser.ie)curSpan.replaceNode(subSpan);else curSpan.parentNode.replaceChild(subSpan,curSpan);}}else{var hasFound=true;for(var j=0;j<childs[i].childNodes.length;j++){var child=childs[i].childNodes[j];if(child.nodeType!=3 && child.tagName.toLowerCase()!="span"){hasFound=false;break;}}if(hasFound){for(var j=0;j<childs[i].childNodes.length;j++){var child=childs[i].childNodes[j];if(child.nodeType==3){var newNode=childs[i].ownerDocument.createElement("span");if(child.nodeValue.substring(0,1)==" "){newNode.innerHTML=String.fromCharCode(160)+child.nodeValue.substring(1);}else{newNode.innerHTML=child.nodeValue;}if(childs[i].className!="")newNode.className=childs[i].className;newNode.style.cssText=childs[i].style.cssText;if(browser.ie)child.replaceNode(newNode);else child.parentNode.replaceChild(newNode,child);}}for(var j=0;j<childs[i].childNodes.length;j++){var child=childs[i].childNodes[j];child.style.cssText=childs[i].style.cssText+";"+child.style.cssText;if(child.className==""){if(childs[i].className!=""){child.className=childs[i].className;if(globalRemoveInlineStyles &&(level >1)){child.removeAttribute("style");}}}}var frag=childs[i].ownerDocument.createDocumentFragment();for(var j=0;j<childs[i].childNodes.length;j++){var subNode=childs[i].childNodes[j].cloneNode(true);frag.appendChild(subNode);}if(browser.ie){childs[i].replaceNode(frag);}else{childs[i].parentNode.replaceChild(frag,childs[i]);}}}}}}};var __editReplaceFontTagCount=0;var __editReplaceFontTagCurrent=0;function editReplaceFontTag(curObject){try{if(!curObject)curObject=getDoc().body;__editReplaceFontTagCount=curObject.getElementsByTagName("font").length;__editReplaceFontTagCurrent=0;__editReplaceFontTagNode(curObject);}catch(Error){}};function __editReplaceFontTagNode(node){var childs=node.childNodes;for(var i=0;i<childs.length;i++){if(childs[i].canHaveChildren || childs[i].hasChildNodes()){__editReplaceFontTagNode(childs[i]);}if(childs[i].nodeName.toLowerCase()=="font"){var curNode=childs[i];__editReplaceFontTagNode(curNode);__editReplaceFontTagCurrent++;if(__editReplaceFontTagCurrent > __editReplaceFontTagCount){return;}var color=curNode.color;var font=curNode.face;var fontSize=curNode.size;var newSpan=curNode.ownerDocument.createElement("span");if(font!="")newSpan.style.fontFamily=font;if(fontSize!=""){if(fontSize==1)newSpan.style.fontSize="8pt";if(fontSize==2)newSpan.style.fontSize="10pt";if(fontSize==3)newSpan.style.fontSize="12pt";if(fontSize==4)newSpan.style.fontSize="14pt";if(fontSize==5)newSpan.style.fontSize="18pt";if(fontSize==6)newSpan.style.fontSize="24pt";if(fontSize==7)newSpan.style.fontSize="34pt";}if(color!="")newSpan.style.color=color;for(var j=0;j<curNode.childNodes.length;j++){var subNode=curNode.childNodes[j].cloneNode(true);if(subNode.nodeType==3){var newNode=curNode.ownerDocument.createTextNode(subNode.nodeValue);newSpan.appendChild(newNode);}else{var newNode=subNode;newSpan.appendChild(newNode);}}if(browser.ie)curNode.replaceNode(newSpan);else curNode.parentNode.replaceChild(newSpan,curNode);}}};function editSetControlVDisabled(value){__editControlVDisabled=value;};function editGetFileUrl(){return __currentURL;};function editSetFileUrl(url){__currentURL=url;};function editInsertDate(){var curdate=new Date();var date="";if(language=="DE")date=curdate.getDate()+"."+(parseInt(curdate.getMonth())+1)+"."+curdate.getFullYear();else date=(parseInt(curdate.getMonth())+1)+"/"+curdate.getDate()+"/"+curdate.getFullYear();editInsertHtml(date);__editOnChanged(true);};function editInsertTime(){var curdate=new Date();var minutes=curdate.getMinutes();if(minutes < 10)minutes="0"+minutes;var seconds=curdate.getSeconds();if(seconds < 10)seconds="0"+seconds;var date=curdate.getHours()+":"+minutes+":"+seconds;editInsertHtml(date);__editOnChanged(true);editSetFocus();};function editGetCharCount(){var temp=editGetText();temp=temp.replace(/\n/gi,"");temp=temp.replace(/\r/gi,"");return temp.length;};function editGetWordCount(){var temp=editGetText();if(temp=="")return 0;var count=0;var aLines=temp.split("\n");for(var i=0;i<aLines.length;i++){var line=aLines[i];line=line.replace(/\r/g,"");line=line.replace(/\n/g,"");line=line.replace(/\t/g," ");if(line!=""){var aWords=line.split(" ");count=count+aWords.length;}}return count;};function editSetDefaultFont(font,fontsize){try{if(font){getDoc().body.style.fontFamily=font;__editDefaultFont=font;}if(fontsize){getDoc().body.style.fontSize=fontsize;__editDefaultFontSize=fontsize;}onchangePINEDIT();}catch(Error){}};function editSetReadOnly(value){__editReadOnly=value;if(value){try{toolbarsbottom.hide();}catch(Error){}setMode("PREVIEW");}else{try{toolbarsbottom.show();}catch(Error){}setMode("EDIT");}try{eventOnReadOnly(value);}catch(Error){}};var __editFSIndex=0;var __editFSPosition="";var __editFSLeft=0;var __editFSTop=0;var __editFSWidth=0;var __editFSHeight=0;var __editFSMode=false;var __editFSOverflow="";function editFullSize(){__editFSMode=!__editFSMode;try{var editor=parent.document.getElementById(window.frameElement.id);var width=0;var height=0;if(__editFSMode){__editFSIndex=editor.style.zIndex;editor.style.zIndex=1000;__editFSLeft=editor.style.left;editor.style.left=0;__editFSTop=editor.style.top;editor.style.top=0;__editFSWidth=editor.style.width;width=parent.document.documentElement.clientWidth > 0 ? parent.document.documentElement.clientWidth:parent.document.body.clientWidth;editor.style.width=browser.ie ? width : parent.window.innerWidth;__editFSHeight=editor.style.height;height=parent.document.documentElement.clientHeight > 0 ? parent.document.documentElement.clientHeight:parent.document.body.clientHeight;editor.style.height=browser.ie ? height : parent.window.innerHeight;__editFSPosition=editor.style.position;editor.style.position="absolute";if(browser.ie){__editFSOverflow=editor.style.overflow;editor.style.overflow="hidden";}else{__editFSOverflow=parent.document.body.style.overflow;parent.document.body.style.overflow="hidden";}}else{editor.style.zIndex=__editFSIndex;editor.style.position=__editFSPosition;editor.style.left=__editFSLeft;editor.style.top=__editFSTop;editor.style.width=__editFSWidth;editor.style.height=__editFSHeight;if(browser.ie)editor.style.overflow=__editFSOverflow;else parent.document.body.style.overflow=__editFSOverflow;}if(globalDocumentView && globalDocumentPageWidth!=""){if(browser.ie){var docWidth=0;if(__editFSMode)docWidth=width-(globalAttributeAreaVisible ? parseInt(globalAttributeAreaWidth):0)-(globalLeftAreaVisible ? parseInt(globalLeftAreaWidth):0)-18-2-2;else docWidth=__editGetObjectWidth(window.frameElement)-(globalAttributeAreaVisible ? parseInt(globalAttributeAreaWidth):0)-(globalLeftAreaVisible ? parseInt(globalLeftAreaWidth):0)-18-2-2;document.getElementById("docContainer").style.width=docWidth;}}editRefresh(getDoc(),"EDIT");}catch(Error){}};function editPasteText(){try{if(__NotSupportedByMozilla())return;editInsertHtml(window.clipboardData.getData("Text"));}catch(Error){}};function editPasteWithControl(){if(browser.ie){var curRange=getDoc().selection.createRange();var html=window.showModalDialog(__editGetEditorUrl()+"server/"+globalTechnology+"/paste."+globalTechnology+"?lg="+language+"&st="+design+"&cancel="+getLanguageString("",502)+"&ok="+getLanguageString("",899),curRange,"dialogHeight:350px;dialogWidth:400px;resizable:1;status:0;scroll:0");}else{var left=screen.width/2-400/2;var top=screen.height/2-350/2;window.open(__editGetEditorUrl()+"server/"+globalTechnology+"/paste."+globalTechnology+"?lg="+language+"&st="+design+"&cancel="+getLanguageString("",502)+"&ok="+getLanguageString("",899),"Paste","modal=1,left="+left+",top="+top+",height=350,width=400,resizable=1,status=0,menubar=0,scrollbars=0");}};function editGetStyles(){return __editStyles;};function editCreateImage(url){return editRelativeCreateImage(url);};function editSetHtmlMode(value){globalHTMLMode=value;};function __editRemoveMSMetaTag(){if(globalRemoveMSMetaTag){try{if(browser.ie){var aMeta=getDoc().getElementsByTagName("meta");for(var i=0;i<aMeta.length;i++){if(aMeta[i].content.indexOf("MSHTML")==0){__editRemoveNode(aMeta[i]);}}}}catch(Error){}}};function editInsertCustomTag(tag){if(browser.ie){editInsertHtml("__EICT__");var html=getDoc().documentElement.innerHTML;html=html.replace(/__EICT__/gi,tag);editWrite(html);}else{editInsertHtml(tag);}};function editStatusBarSetText(text){try{editStatusBar.setText(text);}catch(Error){}};function editSetActiveArea(mode){globalCurrentArea=mode;};function __editSetSelectedDialogPath(path,type){__editSelectedDialogPath[type]=path.replace("\\","/");};function __editUpdateScrollBar(){try{if(browser.ie && globalScrollMode==0){if(globalDocumentView && globalDocumentPageWidth!=""){var doc=getDoc();var margin=0;document.getElementById("scroll2").style.height=doc.body.scrollHeight+margin;var pos=parseInt(doc.documentElement.scrollTop > 0 ? doc.documentElement.scrollTop : doc.body.scrollTop);if(pos < 0)pos=0;document.getElementById("scroll1").scrollTop=pos;}}}catch(Error){}};function __editGetDocumentWidth(){if(browser.ie)return __editGetObjectWidth(window.frameElement)-(globalAttributeAreaVisible ? parseInt(globalAttributeAreaWidth):0)-(globalLeftAreaVisible ? parseInt(globalLeftAreaWidth):0)-18-2-2;else return __editGetObjectWidth(window.frameElement)-(globalAttributeAreaVisible ? parseInt(globalAttributeAreaWidth):0)-(globalLeftAreaVisible ? parseInt(globalLeftAreaWidth):0)-2-2;};function __editGetEditorHeight(){return __editGetObjectHeight(document.getElementById("pinEdit"));};function __editGetEditorWidth(){return __editGetObjectWidth(document.getElementById("pinEdit"));};function editHelpLineVisible(value){if(value){document.getElementById("helpline").style.left=(globalSideBarVisible ? parseInt(globalLeftAreaWidth):0)+parseInt(globalDocumentMargin)+2;if(globalDocumentView)document.getElementById("helpline").style.top=__editGetIframePositionY(document.getElementById("editContainer"));else document.getElementById("helpline").style.top=__editGetIframePositionY(document.getElementById("pinEdit"));if(globalDocumentView)document.getElementById("helpline").style.height=__editGetObjectHeight(document.getElementById("docContainer"));else document.getElementById("helpline").style.height=__editGetObjectHeight(document.getElementById("pinEdit"));document.getElementById("helpline").style.visibility="visible";}else{document.getElementById("helpline").style.visibility="hidden";}};function editHelpLineMove(pos){var scrollPos=0;try{var base=(globalSideBarVisible ? parseInt(globalLeftAreaWidth):0)+(globalDocumentView ?(parseInt(globalDocumentMargin)+2):0);if(globalDocumentView)scrollPos=document.getElementById("docContainer").scrollLeft;document.getElementById("helpline").style.left=base+pos-scrollPos;}catch(Error){}};function editImageInit(){var curObject=editGetActiveObject();if(curObject==null)return;if(curObject.tagName.toLowerCase()=="img"){curObject.removeAttribute("width");curObject.removeAttribute("height");curObject.style.width="";curObject.style.height="";}};function __editGetDesign(design){if(design==""){return "style1";}if(design=="Office"){return "style2";}if(design=="Office2003"){return "style3";}if(design=="Office2003S"){return "style4";}};function editShowSpecialChar(value){globalShowSpecialChar=value;__editShowSpecialChar(value);};function __editShowSpecialChar(value){if(value){var doc=editGetDocument();var aPara=doc.getElementsByTagName("p");for(var i=0;i<aPara.length;i++){var image=doc.createElement("img");image.src=__editGetEditorUrl()+"design/image/p.gif";image.className="__p";image.border=0;image.style.width=9;image.style.height=11;image.unselectable="on";aPara[i].appendChild(image);}var aPara=doc.getElementsByTagName("br");for(var i=0;i<aPara.length;i++){var image=doc.createElement("img");image.src=__editGetEditorUrl()+"design/image/br.gif";image.className="__br";image.border=0;image.style.width=9;image.style.height=11;image.unselectable="on";aPara[i].parentNode.insertBefore(image,aPara[i]);}}else{var doc=editGetDocument();var aRemove=new Array();var aImages=doc.getElementsByTagName("img");for(var i=0;i<aImages.length;i++){if(aImages[i].className=="__p" || aImages[i].className=="__br"){aRemove[aRemove.length]=aImages[i]}}for(var i=0;i<aRemove.length;i++){if(browser.ie)aRemove[i].removeNode(true);else aRemove[i].parentNode.removeChild(aRemove[i]);}}};function editIsTagNotEditable(curObject){if(curObject){parentElement=curObject;}else{var parentElement=null;try{parentElement=getDoc().selection.createRange().parentElement();}catch(Error){}}if(parentElement){var aHierarchy=__editGetTagHierarchy(parentElement,1);for(var i=0;i<aHierarchy.length;i++){if(aHierarchy[i].contentEditable=="true"){return false;}if(aHierarchy[i].contentEditable=="false"){return true;}}}return false;};function __editGetTagHierarchy(curObject,mode,removeDuplicates){var activeObject=curObject;var aTags=new Array();var isDuplicate=false;try{while(activeObject.tagName.toLowerCase()!="body"){if(removeDuplicates){for(var i=0;i<aTags.length;i++){var tag="";if(mode==0)tag=aTags[i];if(mode==1)tag=aTags[i].tagName.toLowerCase();if(tag==activeObject.tagName.toLowerCase()){isDuplicate=true;break;}}}if(!isDuplicate){if(mode==0)aTags[aTags.length]=activeObject.tagName.toLowerCase();else aTags[aTags.length]=activeObject;}activeObject=activeObject.parentNode;}}catch(Error){}return aTags;};function __editToHexColor(d){var z=new Array("0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F");var x="";var i=1,v=d,r=0;while(v > 15){v=Math.floor(v / 16);i++;}v=d;for(j=i;j>=1;j--){x=x+z[Math.floor(v / Math.pow(16,j-1))];v=v-(Math.floor(v / Math.pow(16,j-1))*Math.pow(16,j-1));}var temp="";if(x.length < 6){for(i=0;i<(6-x.length);i++){temp=temp+"0";}}x=temp+x;temp="";for(var i=4;i>=0;i=i-2){temp=temp+x.substring(i,i+2);}return "#"+temp;};function rgbToHex(rgbColor){var RGB=new Array(256);var k=0;var hex=new Array("0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F");var temp2="";if(rgbColor.indexOf("(")< 0)return rgbColor;if(rgbColor.indexOf(")")< 0)return rgbColor;try{for(var i=0;i < 16;i++){for(var j=0;j < 16;j++){RGB[k]=hex[i]+hex[j];k++;}}rgbColor=rgbColor.replace(/\(/,"<");rgbColor=rgbColor.replace(/\)/,">");var reg=new RegExp("<[^>]+>","gi");var result=rgbColor.match(reg);rgbColor=result[0];rgbColor=rgbColor.substring(1,rgbColor.length-1);rgbColor=rgbColor.replace(/ /gi,"");var temp=rgbColor.split(",");temp2="#"+RGB[temp[0]]+RGB[temp[1]]+RGB[temp[2]];}catch(Error){};return temp2;};var __editTidyMode=0;function __editPasteIntern(){globalSaveBookmark=getDoc().selection.createRange().getBookmark();var objSaveRange=getDoc().selection.createRange();var iframe=null;if(!document.getElementById("__paste_frame")){iframe=document.createElement("IFRAME");if(globalSupportHttps && browser.ie)iframe.src="dummy.html";document.body.appendChild(iframe);iframe.id="__paste_frame";iframe.style.visibility="visible";iframe.style.position="absolute";iframe.style.left=-100;iframe.style.top=0;iframe.style.width=1;}else{iframe=document.getElementById("__paste_frame");}var doc=null;try{doc=iframe.contentWindow.document;doc.open();doc.write("");doc.close();doc.body.contentEditable=true;iframe.contentWindow.focus();var result=doc.execCommand("paste",false,null);}catch(Error){}if(__editCheckPasteCode(doc.body)){eventOnRequireOptimization();__editTidyMode=1;__editOptimizeTidy(doc.body);}else{objSaveRange.select();__editOptimize(1,doc.body);__editPreparePaste(doc);editInsertHtml(doc.body.innerHTML);}};function __editPreparePaste(doc){var aSpans=doc.getElementsByTagName("span");for(var i=0;i<aSpans.length;i++){var span=aSpans[i];if(span.className==""){if(span.style.fontFamily=="")span.style.fontFamily=span.currentStyle.fontFamily;if(span.style.fontSize=="")span.style.fontSize=span.currentStyle.fontSize;if(span.style.color=="")span.style.color=span.currentStyle.color;if(span.style.fontWeight=="normal" || span.style.fontWeight=="")span.style.fontWeight="normal";if(span.style.fontStyle=="normal" || span.style.fontStyle=="")span.style.fontStyle="normal";if(span.style.textDecoration=="none" || span.style.textDecoration=="")span.style.textDecoration="none";}else{if(globalRemoveInlineStyles)span.removeAttribute("style");}}};function __editCheckPasteCode(curObject){try{var allObjects=curObject.getElementsByTagName("*");for(var i=0;i<allObjects.length;i++){if(allObjects[i].className.substring(0,3)=="Mso"){return true;}if(allObjects[i].style.cssText.toLowerCase().indexOf("mso")>=0){return true;}}var allObjects=curObject.getElementsByTagName("p");for(var i=0;i<allObjects.length;i++){var aHierarchy=__editGetTagHierarchy(allObjects[i],1);for(var j=0;j<aHierarchy.length;j++){var tag=aHierarchy[j].tagName.toLowerCase();if(tag=="span" || tag=="font"){return true;}}}}catch(Error){}return false;};function editInsertBlockHtml(html){try{if(editGetSelectionType()=="CONTROL"){return;}if(editGetSelectionType()=="TEXT"){editSelectionClear();}var parentNode=getDoc().selection.createRange().parentElement();var aHierarchy=__editGetTagHierarchy(parentNode,1);var hasFound=false;var blockElement=null;var blockTag="";for(var i=0;i<aHierarchy.length;i++){var tag=aHierarchy[i].tagName.toLowerCase();if(tag=="p" || blockTag=="div" || blockTag.indexOf("h")==0){blockElement=aHierarchy[i];blockTag=tag;hasFound=true;break;}}if(hasFound){var doc=getDoc();var div=doc.createElement("div");div.id="__temp_block__";if(blockTag=="p" || blockTag=="div" || blockTag.indexOf("h")==0){blockElement.parentNode.insertBefore(div,blockElement);}else{parentNode.appendChild(div);}div.innerHTML=html;var frag=doc.createDocumentFragment();for(var j=0;j<div.childNodes.length;j++){var subNode=div.childNodes[j].cloneNode(true);if(subNode.nodeType==3){var newNode=doc.createTextNode(subNode.nodeValue);frag.appendChild(newNode);}else{var newNode=subNode;frag.appendChild(newNode);}}if(browser.ie){div.replaceNode(frag);}else{div.parentNode.replaceChild(frag,curNode);}}else{editInsertHtml(html);}}catch(Error){if(doc.getElementById("__temp_block__")!=null)__editRemoveNode(doc.getElementById("__temp_block__"));}};function editGetUsedColors(){var aTags=getDoc().getElementsByTagName("*");var aColors=new Array();var color="";for(var i=0;i<aTags.length;i++){if(aTags[i].style.color){color=rgbToHex(aTags[i].style.color);if(!__editGetUsedColorExist(aColors,color))aColors[aColors.length]=color;}if(aTags[i].style.backgroundColor){color=rgbToHex(aTags[i].style.backgroundColor);if(!__editGetUsedColorExist(aColors,color))aColors[aColors.length]=color;}if(aTags[i].style.borderLeftColor){color=rgbToHex(aTags[i].style.borderLeftColor);if(!__editGetUsedColorExist(aColors,color))aColors[aColors.length]=color;}if(aTags[i].style.borderRightColor){color=rgbToHex(aTags[i].style.borderRightColor);if(!__editGetUsedColorExist(aColors,color))aColors[aColors.length]=color;}if(aTags[i].style.borderTopColor){color=rgbToHex(aTags[i].style.borderTopColor);if(!__editGetUsedColorExist(aColors,color))aColors[aColors.length]=color;}if(aTags[i].style.borderBottomColor){color=rgbToHex(aTags[i].style.borderBottomColor);if(!__editGetUsedColorExist(aColors,color))aColors[aColors.length]=color;}if(aTags[i].color){color=rgbToHex(aTags[i].color);if(!__editGetUsedColorExist(aColors,color))aColors[aColors.length]=color;}}return aColors;};function __editGetUsedColorExist(aColors,color){for(var i=0;i<aColors.length;i++){if(aColors[i]==color)return true;}return false;};function editValidator(){var width=800;var height=600;if(browser.ie){window.showModalDialog(__editGetEditorUrl()+"add-on/validator/validator.html",window,"dialogHeight:"+height+"px;dialogWidth:"+width+"px;resizable:1;status:0;");}else{var left=screen.width/2-width/2;var top=screen.height/2-height/2;window.open(__editGetEditorUrl()+"add-on/validator/validator.html","color","modal=1,left="+left+",top="+top+",height="+height+",width="+width+",resizable=1,status=0");}};function __editGetValidatorData(valtype){if(valtype==0){globalXHtmlDocType=globalXHtml10Transitionl;}if(valtype==1){globalXHtmlDocType=globalXHtml10Strict;}if(valtype==2){globalXHtmlDocType=globalXHtml11;}var xhtml=editGetXHtml();globalXHtmlDocType=globalXHtml10Transitionl;return xhtml;};function editSaveRange(){globalSaveRange=getDoc().selection.createRange();};function editSetRange(){globalSaveRange.select();};function editSaveFile(){if(editGetFileUrl()=="")editSaveDialog();else editSave();};function editSmiley(popup){editInsertHtml("<img src='"+globalEditorImagesFolder+"smileys/smiley"+popup.value+".gif' border=0>");__editOnChanged(true);};function editFormatText(value){if(value=='NORMAL'){editFormat('Normal');}else{editFormat(value);}};function __editGetDocType(){var childs=getDoc().childNodes;for(var i=0;i<childs.length;i++){var node=childs[i];if(node.nodeType==8){var value=node.text;if(value.toLowerCase().indexOf("<!doctype")>=0){return value;}}}return "";};function editGetWord(){try{if(editHasSelection()){return editGetSelectedText();}else{var doc=getDoc();var range=doc.selection.createRange();range.expand("word");return range.text;}}catch(Error){}return "";};function editInsertHtmlAt(html,index){var doc=getDoc();var range=doc.selection.createRange();range.moveStart("textedit",-1);range.collapse(true);range.select();j=0;for(var i=0;i<100000;i++){range.moveEnd("character",1);var text=range.text;if(isNaN(text.charCodeAt(0))==false){j++;}range.moveStart("character",1);if(j==index)break;}range.select();var htmlData=html+range.htmlText;range.pasteHTML(htmlData);return true;};function editSetHighlight(start,length){var doc=getDoc();var range=doc.selection.createRange();range.moveStart("textedit",-1);range.collapse(true);range.select();if(start > 0){j=0;for(var i=0;i<100000;i++){range.moveEnd("character",1);var text=range.text;if(isNaN(text.charCodeAt(0))==false){j++;}range.moveStart("character",1);if(j==start)break;}}range.moveEnd("character",length);range.select();var currentHtml=range.htmlText;doc.selection.clear();var space=range.htmlText;var spellRoot=__editGetEditorUrl()+"add-on/spell/";range.pasteHTML("<span id=\"__UNDERLINE__\" style=\"background: url('"+spellRoot+"spell.gif') repeat-x bottom left;\">"+currentHtml+"</span>"+space);};function editGetCursorPosition(ctrl){try{var doc=getDoc();var range=doc.selection.createRange();if(range.text.length > 0)return-1;var saveRange=range.duplicate();range.moveStart("textedit",-1);var text=range.text;text=text.replace(/\n/gi,"");text=text.replace(/\r/gi,"");pos=text.length;saveRange.select();return pos;}catch(Error){return-1;}};function editSetCursorPosition(start){try{var doc=getDoc();var range=doc.selection.createRange();range.moveStart("textedit",-1);range.collapse(true);range.select();if(start > 0){j=0;for(var i=0;i<1000000;i++){range.moveEnd("character",1);var text=range.text;if(isNaN(text.charCodeAt(0))==false){j++;}range.moveStart("character",1);if(j==start)break;}}range.select();}catch(Error){}};function __editSetBodyBackground(){if(!browser.ie){try{var doc=getDoc();var currentStyle=doc.defaultView.getComputedStyle(doc.body,null);if(currentStyle==null){setTimeout("__editSetBodyBackground()",50);return;}else{if(currentStyle.backgroundColor=="transparent" || currentStyle.backgroundColor=="rgba(0, 0, 0, 0)")doc.body.style.backgroundColor="white";}}catch(Error){}}};function editAbout(){var editorUrl=__editGetEditorUrl();if(browser.ie){var values=window.showModalDialog(editorUrl+"dialogs/about.html","","dialogHeight:"+(220)+"px;dialogWidth:300px;resizable:0;status:0;scroll:0");}else{var left=screen.width/2-300/2;var top=screen.height/2-220/2;window.open(editorUrl+"dialogs/about.html","Search","modal=1,left="+left+",top="+top+",height=220,width=300,resizable=0,status=0,scrollbars=0");}};function editHelp(){var left=screen.width/2-800/2;var top=screen.height/2-600/2;window.open(__editGetEditorUrl()+"help/userhelp.html","","left="+left+",top="+top+",height=600,width=800,resizable=1,status=0,scrollbars=1");};function editSearchReplace(toText,withText,caseSensitive){try{var doc=getDoc();if(!caseSensitive)caseSensitive=false;if(browser.ie){var curRange=doc.body.createTextRange();while(curRange.findText(toText,1,caseSensitive ? 4:0)){try{curRange.select();if(doc.selection.type.toLowerCase()!='none')doc.selection.clear();var space=curRange.htmlText;curRange.text=withText+space;}catch(Error){break;}}}else{__editFFFindTextMatches=new Array();__editFFFindText(doc.body,toText,!caseSensitive,false);if(__editFFFindTextMatches.length > 0){__editFFHighlightText(withText);}}}catch(Error){}};function editClearSupressedKeys(){try{globalSuppressedKeys=new Array();}catch(Error){}};function editAddSupressedKey(keyCode,ctrl,alt){try{var key=new SupressedKey(keyCode,ctrl,alt);globalSuppressedKeys[globalSuppressedKeys.length]=key;}catch(Error){}};function SupressedKey(keyCode,ctrl,alt){this.keyCode=keyCode;this.ctrl=ctrl;this.alt=alt;};function editSetDocumentView(value){__editDocumentView=value;globalSaveContent=editGetHtml();__editStartup();};function editSetRulerVisible(value){globalRulerVisible=value;globalSaveContent=editGetHtml();__editStartup();};function editEnableExternalPreview(url){__editEnableExternalPreview=url;if(__editEnableExternalPreview.indexOf(".htm")> 0)document.getElementById('pinEditPreview').src=url;};function editImage(){var tbdesign="3";var pi=new pinImage();pi.url=__editGetEditorUrl()+"add-on/image/";pi.language=language;pi.technology=globalTechnology;if(design=="")tbdesign="1";if(design=="Office")tbdesign="2";if(design=="Office2003")tbdesign="3";if(design=="Office2003S")tbdesign="4";pi.design=tbdesign;var objImage=editGetActiveObject();if(objImage.tagName.toLowerCase()=="img"){pi.imageUrl="";pi.imagePath="";}pi.open();};function pinStyle(){this.url="";this.width="816";this.height="590";this.language="EN";this.userMode=0;this.technology="php";this.design=3;this.cssUrl="";this.cssPath="";this.cssFileName="";this.open=__pinstyle__open;};function __pinstyle__open(){var left=screen.width/2-this.width/2;var top=screen.height/2-this.height/2;var params="";if(this.url==""){alert("URL to pinStyle folder is missing !");return;}var url=this.url+"pinStyle."+this.technology;if(this.cssPath!=""){url=url+"?language="+this.language.toUpperCase();url=url+"&tech="+this.technology;url=url+"&design="+this.design;url=url+"&mode="+this.userMode;if(this.cssUrl!="")url=url+"&url="+this.cssUrl;if(this.cssFileName!="")url=url+"&file="+this.cssFileName;if(this.cssPath!=""){var encPath=encode(this.cssPath);url=url+"&path="+encPath;}}url=url.replace(/\\/gi,"/");params="left="+left+",top="+top+",width="+this.width+",height="+this.height+",modal=1,location=no,menubar=no,scrollbars=no,status=no,toolbar=no,resizable=1";var win=window.open(url,"pinStyle",params);win.focus();};function pinImage(){this.url="";this.width="800";this.height="700";this.language="EN";this.userMode=0;this.technology="php";this.design=3;this.imageUrl="";this.imagePath="";this.workspaceUrl="";this.workspacePath="";this.imageFileName="";this.clearWorkspace=true;this.useLocking=true;this.open=__pinimage__open;};function __pinimage__open(){var left=screen.width/2-this.width/2;var top=screen.height/2-this.height/2;var params="";if(this.url==""){alert("URL to pinImage folder is missing !");return;}var url=this.url+"pinImage."+this.technology;if(this.imagePath!=""){url=url+"?language="+this.language.toUpperCase();url=url+"&tech="+this.technology;url=url+"&design="+this.design;url=url+"&mode="+this.userMode;if(this.imagePath!="")url=url+"&path="+this.imagePath;if(this.imageUrl!="")url=url+"&url="+this.imageUrl;if(this.workspacePath!="")url=url+"&workspacepath="+this.workspacePath;if(this.workspaceUrl!="")url=url+"&workspaceurl="+this.workspaceUrl;if(this.imageFileName!="")url=url+"&file="+this.imageFileName;url=url+"&clearworkspace="+(this.clearWorkspace ? "1":"0");url=url+"&uselocking="+(this.useLocking ? "1":"0");}url=url.replace(/\\/gi,"/");params="left="+left+",top="+top+",width="+this.width+",height="+this.height+",modal=1,location=no,menubar=yes,scrollbars=no,status=no,toolbar=yes,resizable=1";var win=window.open(url,"pinImage",params);win.focus();};var __editHPPCurPage=1;var __zoom=100;var __editHPPHeight=0;var __editHPPBodyHeightPixel=0.0;function __editHtmlPrintPreview(){__editHPPCurPage=1;__editHPPHeight=0;__editHPPBodyHeightPixel=0.0;var marginTop=globalPDFMarginTop;var marginLeft=globalPDFMarginLeft;var marginRight=globalPDFMarginRight;var marginBottom=globalPDFMarginBottom;var headerHeight=globalPDFHeaderHeight;var footerHeight=globalPDFFooterHeight;var pageWidth=8.5;var pageHeight=11;if(globalPDFPaperSize==1){if(globalPDFOrientation==1){pageWidth=8.5;pageHeight=11;}else{pageWidth=11;pageHeight=8.5;}}if(globalPDFPaperSize==9){if(globalPDFOrientation==1){pageWidth=210;pageHeight=297;}else{pageWidth=297;pageHeight=210;}}var pageWidthPixel=0.0;var pageHeightPixel=0.0;var headerHeightPixel=0.0;var footerHeightPixel=0.0;var marginTopPixel=0.0;var marginLeftPixel=0.0;var marginRightPixel=0.0;var marginBottomPixel=0.0;var factor_inch=96;var factor_mm=3.779527;if(globalPDFUnit==1){pageWidthPixel=pageWidth*factor_inch;pageHeightPixel=pageHeight*factor_inch;headerHeightPixel=headerHeight*factor_inch;footerHeightPixel=footerHeight*factor_inch;marginTopPixel=marginTop*factor_inch;marginLeftPixel=marginLeft*factor_inch;marginRightPixel=marginRight*factor_inch;marginBottomPixel=marginBottom*factor_inch;}else{pageWidthPixel=pageWidth*factor_mm;pageHeightPixel=pageHeight*factor_mm;headerHeightPixel=headerHeight*factor_mm;footerHeightPixel=footerHeight*factor_mm;marginTopPixel=marginTop*factor_mm;marginLeftPixel=marginLeft*factor_mm;marginRightPixel=marginRight*factor_mm;marginBottomPixel=marginBottom*factor_mm;}pageHeightPixel=pageHeightPixel+2;pageWidthPixel=pageWidthPixel+2;__editHPPBodyHeightPixel=pageHeightPixel-headerHeightPixel-marginBottomPixel-marginTopPixel-footerHeightPixel;var header=globalPDFHeader;var footer=globalPDFFooter;if(!document.getElementById("__remote_frame")){iframe=document.createElement("IFRAME");if(globalSupportHttps && browser.ie)iframe.src="dummy.html";iframe.id="__remote_frame";iframe.style.position="absolute";iframe.style.top=0;iframe.style.left=-1000;iframe.style.visibility="hidden";iframe.zIndex=1;document.body.appendChild(iframe);}else{iframe=document.getElementById("__remote_frame");}iframe.style.width=pageWidthPixel-marginLeftPixel-marginRightPixel-2;var editorDoc=iframe.contentWindow.document;editorDoc.body.style.margin=0;editorDoc.open();editorDoc.write(getDoc().documentElement.innerHTML);editorDoc.close();var body="Body";var html="";var aStyleSheets=editGetExternalStyleSheets();var ss="";for(var i=0;i<aStyleSheets.length;i++){ss+="<link href=\""+aStyleSheets[i].href+"\" type=\"text/css\" rel=\"stylesheet\">";}var html="<head>"+ss+"</head>";html+="<body style='background-color: #d0d0d0;margin-top:15px'>";html+="<div align=center style='width:100%;height:100%'>";var startNode=editorDoc.body.childNodes[0];var pageCount=1;var lastPos=0;var htmlPage="";var curNode=startNode;try{while(curNode){if(curNode.style.position!="absolute"){if(curNode.tagName.toLowerCase()=="table"){var structHPP_PB=__editHtmlPrintPreviewRenderTable(editorDoc,curNode);if(structHPP_PB.status){htmlPage+=structHPP_PB.oldTable.outerHTML;html+=__editHtmlPrintPreviewAddPage(pageCount,htmlPage,header,headerHeightPixel,footer,footerHeightPixel,pageWidthPixel,pageHeightPixel,marginLeftPixel,marginTopPixel,marginRightPixel,marginBottomPixel);htmlPage="";pageCount++;__editHPPHeight=0;curNode=structHPP_PB.newTable.previousSibling;}else{htmlPage+=curNode.outerHTML;}}else{if(curNode.id=="__PAGEBREAK__"){html+=__editHtmlPrintPreviewAddPage(pageCount,htmlPage,header,headerHeightPixel,footer,footerHeightPixel,pageWidthPixel,pageHeightPixel,marginLeftPixel,marginTopPixel,marginRightPixel,marginBottomPixel);htmlPage="";pageCount++;__editHPPHeight=0;}else{if((__editHPPHeight+curNode.offsetHeight)> __editHPPBodyHeightPixel){html+=__editHtmlPrintPreviewAddPage(pageCount,htmlPage,header,headerHeightPixel,footer,footerHeightPixel,pageWidthPixel,pageHeightPixel,marginLeftPixel,marginTopPixel,marginRightPixel,marginBottomPixel);htmlPage=curNode.outerHTML;pageCount++;__editHPPHeight=0;}else{htmlPage+=curNode.outerHTML;}var offsetTop=__editHPPConvert2Int(curNode,curNode.currentStyle.marginTop);var offsetBottom=__editHPPConvert2Int(curNode,curNode.currentStyle.marginBottom);__editHPPHeight+=(curNode.offsetHeight+offsetTop+offsetBottom);}}}curNode=curNode.nextSibling;}}catch(Error){alert("Error in HPP: "+Error);}if(htmlPage!=""){html+=__editHtmlPrintPreviewAddPage(pageCount,htmlPage,header,headerHeightPixel,footer,footerHeightPixel,pageWidthPixel,pageHeightPixel,marginLeftPixel,marginTopPixel,marginRightPixel,marginBottomPixel);}html+="</div>";html+="</body>";var doc=getDocPreview();doc.getElementById("pageCount").value=pageCount;doc.getElementById("pages").value="1"+" of "+pageCount;return html;};function __editHPPConvert2Int(node,attribute){if(attribute=="auto"){if(node.tagName.toLowerCase()=="p"){attribute="19";}else{attribute="0";}}return parseInt(attribute);};function __editHPPCheckDocument(){var doc=getDoc();for(var i=0;i<doc.body.childNodes.length;i++){var curNode=doc.body.childNodes[i];if(curNode.nodeType==3){return true;}if(__editHPPHasTable(curNode)){return true;}}return false;};function __editHPPPrepareDocument(){var doc=getDoc();for(var i=0;i<doc.body.childNodes.length;i++){var curNode=doc.body.childNodes[i];if(curNode.nodeType==3){var newP=doc.createElement("p");newP.innerHTML=curNode.nodeValue;if(browser.ie)curNode.replaceNode(newP);else curNode.parentNode.replaceChild(newP,curNode);}if(__editHPPHasTable(curNode)){var frag=doc.createDocumentFragment();var pTag=curNode.cloneNode(false);pTag.innerHTML="";for(var j=0;j<curNode.childNodes.length;j++){var subNode=curNode.childNodes[j];if(subNode.nodeType==3){var newNode=doc.createTextNode(subNode.nodeValue);pTag.appendChild(newNode);}else{if(subNode.tagName.toLowerCase()=="table"){if(pTag.childNodes.length > 0)frag.appendChild(pTag);frag.appendChild(subNode.cloneNode(true));pTag=curNode.cloneNode(false);pTag.innerHTML="";}else{pTag.appendChild(subNode.cloneNode(true));}}}if(browser.ie)curNode.replaceNode(frag);else curNode.parentNode.replaceChild(frag,curNode);}}};function __editHPPHasTable(node){for(var i=0;i<node.childNodes.length;i++){var curNode=node.childNodes[i];if(curNode.nodeType!=3){if(curNode.tagName.toLowerCase()=="table"){return true;}}}return false;};function __editHPPHasPWithHR(node){for(var i=0;i<node.childNodes.length;i++){var curNode=node.childNodes[i];if(curNode.nodeType!=3){if(curNode.tagName.toLowerCase()=="hr"){return true;}}}return false;};function __editHtmlPrintPreviewRenderTable(doc,table){var curRow=null;var sepRow=null;try{for(var i=0;i<table.rows.length;i++){var curRow=table.rows[i];var offset=0;if(table.cellSpacing=="" || table.cellSpacing==null)offset=2;else offset=parseInt(table.cellSpacing);if(curRow.cells.length > 0){var curCell=curRow.cells[0];if(curCell.style.borderTopWidth!=""){var btw=parseInt(curCell.style.borderTopWidth);if(btw > 1)offset+=btw;}if(curCell.style.borderBottomWidth!=""){var bbw=parseInt(curCell.style.borderBottomWidth);if(bbw > 1)offset+=bbw;}}if((__editHPPHeight+curRow.offsetHeight+offset+offset)> __editHPPBodyHeightPixel){sepRow=curRow;break;}__editHPPHeight+=(curRow.offsetHeight+offset);if(i==table.rows.length-1)__editHPPHeight+=(offset);}if(sepRow!=null){return __editHPPAddPB(doc,sepRow);}else{return new StructHPP_PB(null,null,false);}}catch(Error){}};function StructHPP_PB(oldTable,newTable,status){this.oldTable=oldTable;this.newTable=newTable;this.status=status;};function __editHPPAddPB(doc,curObject){var curTable=null;var curRow=null;var contentPB="<hr id='__PAGEBREAK__' contentEditable=false title='"+getLanguageString("",404)+"' style='height:2px;PAGE-BREAK-AFTER: always; border-top:1px dotted red;border-bottom:1px dotted red'>";try{var isInTable=false;var aHierarchy=__editGetTagHierarchy(curObject,1);for(var i=0;i<aHierarchy.length;i++){if(aHierarchy[i].tagName.toLowerCase()=="tr"){curRow=aHierarchy[i];}if(aHierarchy[i].tagName.toLowerCase()=="table"){isInTable=true;curTable=aHierarchy[i];}}var thead=null;if(isInTable){var newTable=curTable.cloneNode(true);var rowsToRemove=curTable.rows.length-curRow.rowIndex;for(var i=0;i<rowsToRemove;i++){var lastRow=curTable.rows[curTable.rows.length-1];lastRow.parentNode.removeChild(lastRow);}var firstRowIndex=0;var thead=curTable.getElementsByTagName("thead")[0];if(thead){firstRowIndex=thead.getElementsByTagName("tr").length;}else{var ths=curTable.getElementsByTagName("th");if(ths.length==0){firstRowIndex=0;}else{var k=1;var curIndex=0;var previousIndex=0;for(var j=0;j<ths.length;j++){curIndex=ths[j].parentNode.rowIndex;if(curIndex!=previousIndex){k++;}previousIndex=curIndex;}firstRowIndex=k;}}rowsToRemove=newTable.rows.length-firstRowIndex-rowsToRemove;for(var i=0;i<rowsToRemove;i++){var lastRow=newTable.rows[firstRowIndex];lastRow.parentNode.removeChild(lastRow);}var newPB=doc.createElement(contentPB);var curPB=null;if(curTable.nextSibling!=null){curPB=curTable.parentNode.insertBefore(newPB,curTable.nextSibling);}else{curPB=curTable.parentNode.appendChild(newPB);}if(curPB.nextSibling!=null){curPB.parentNode.insertBefore(newTable,curPB.nextSibling);}else{curPB.parentNode.appendChild(newTable);}return new StructHPP_PB(curTable,newTable,true);}}catch(Error){alert("Error in __editHPPAddPB: "+Error);}};function __editHtmlPrintPreviewAddPage(pageCount,body,header,headerHeightPixel,footer,footerHeightPixel,pageWidthPixel,pageHeightPixel,marginLeftPixel,marginTopPixel,marginRightPixel,marginBottomPixel){var html="";var pageHeight=pageHeightPixel;var pageWidth=pageWidthPixel;var headerColor="#d0d0d0";var footerColor="#d0d0d0";try{var rs4=eventOnPreviewBeforePageAdd(pageCount);if(rs4!=null){header=rs4.para1;headerHeightPixel=rs4.para2;footer=rs4.para3;footerHeightPixel=rs4.para4;}}catch(Error){}var bodyHeightPixel=pageHeightPixel-headerHeightPixel-marginBottomPixel-marginTopPixel-footerHeightPixel;var bodyWidthPixel=pageWidthPixel-marginLeftPixel-marginRightPixel;html+="<div id='page"+pageCount+"' align=left style='width:"+pageWidth+"px;height:"+pageHeight+"px;background-color:white;border:1px solid black;padding-left:"+marginLeftPixel+"px;padding-top:"+marginTopPixel+"px;padding-right:"+marginRightPixel+"px;padding-bottom:"+marginBottomPixel+"px'>";if(headerHeightPixel > 0){html+="<div id='pageHeader"+pageCount+"' style='height:"+headerHeightPixel+"px;width:"+bodyWidthPixel+"px;background-color:"+headerColor+";overflow:hidden'>";html+=header;html+="</div>";}html+="<div id='pageBody"+pageCount+"' style='height:"+bodyHeightPixel+"px;width:"+bodyWidthPixel+"px;background-color:white;overflow:hidden'>";html+=body;html+="</div>";if(footerHeightPixel > 0){html+="<div id='pageFooter"+pageCount+"' style='height:"+footerHeightPixel+"px;width:"+bodyWidthPixel+"px;background-color:"+footerColor+";overflow:hidden'>";html+=footer;html+="</div>"}html+="</div>";html+="<div id='pageDistance"+pageCount+"' style='width:"+bodyWidthPixel+"px;height:15px;background-color:#d0d0d0;'>&nbsp;</div>";try{var rs4=eventOnPreviewBeforePageAdd(pageCount+1);if(rs4!=null){header=rs4.para1;headerHeightPixel=rs4.para2;footer=rs4.para3;footerHeightPixel=rs4.para4;}}catch(Error){}__editHPPBodyHeightPixel=pageHeightPixel-headerHeightPixel-marginBottomPixel-marginTopPixel-footerHeightPixel;return html;};function __editHPPOnPreviewZoom(value){if(value){__zoom=__zoom+10;}else{__zoom=__zoom-10;if(__zoom < 10)__zoom=10;}var doc=getDocPreview();doc.getElementById("container").style.zoom=__zoom+"%";};function __editHPPPreviousPage(){var doc=getDocPreview();__editHPPCurPage--;if(__editHPPCurPage < 1){__editHPPCurPage=1;return;}doc.getElementById("container").contentWindow.document.getElementById("page"+__editHPPCurPage).scrollIntoView(false);var pages=doc.getElementById("pageCount").value;doc.getElementById("pages").value=__editHPPCurPage+" of "+pages;};function __editHPPNextPage(){var doc=getDocPreview();var pages=doc.getElementById("pageCount").value;__editHPPCurPage++;if(__editHPPCurPage > pages){__editHPPCurPage=pages;return;}doc.getElementById("container").contentWindow.document.getElementById("page"+__editHPPCurPage).scrollIntoView(false);doc.getElementById("pages").value=__editHPPCurPage+" of "+pages;};function __editBuildTagHierarchy(){if(!globalHierarchyBarVisible)return;try{var active=editGetActiveObject();__editHierarchy=new Array();__editHierarchy[0]=active;if(active.tagName.toUpperCase()!="BODY"){while(active.parentNode.tagName.toUpperCase()!="BODY"){active=active.parentNode;__editHierarchy[__editHierarchy.length]=active;}__editHierarchy[__editHierarchy.length]=active.parentNode;}var temp="<table id='__hb_table' style='font-size:11px;font-family:arial;width:100%;border-width:1px;border-style: solid;border-left-color:  ButtonShadow;  border-right-color:  ButtonHighlight;  border-top-color:  ButtonShadow;  border-bottom-color:ButtonHighlight;' cellspacing=0 cellpadding=1 border=0><tr>";for(var i=__editHierarchy.length-1;i>=0;i--){if(browser.ie)temp+="<td style='cursor:hand' onmouseup='__editHierachyClick("+i+")' onmouseover='this.style.backgroundColor=\""+globalHierarchyBarSelectionColor+"\";__editHierachyOver("+i+")'  onmouseout='this.style.backgroundColor=\""+globalToolbarColor+"\";__editHierachyOut("+i+")'>";else temp+="<td style='cursor:pointer' id='__hbElement"+i+"'>";if(i==0)temp=temp+"<b>&lt;"+__editHierarchy[i].tagName.toLowerCase()+"&gt;</b>";else temp=temp+"&lt;"+__editHierarchy[i].tagName.toLowerCase()+"&gt;";temp+="</td>";}temp+="<td width='100%'></td>";temp+="</table>";}catch(Error){temp="<table style='width:100%;font-size:11px;font-family:arial;border-width:1px;border-style: solid;border-left-color:  ButtonShadow;  border-right-color:  ButtonHighlight;  border-top-color:  ButtonShadow;  border-bottom-color:ButtonHighlight;' cellspacing=0 cellpadding=1 border=0><tr><td>&nbsp;</td></tr></table>";}document.getElementById("hierarchyBar").innerHTML=temp;try{if(!browser.ie){for(var i=__editHierarchy.length-1;i>=0;i--){if(globalHierarchyBarHighlight){document.getElementById("__hbElement"+i).addEventListener("mouseover",__editHierachyOver,false);document.getElementById("__hbElement"+i).addEventListener("mouseout",__editHierachyOut,false);}document.getElementById("__hbElement"+i).addEventListener("mousedown",__editHierachyClick,false);}}}catch(Error){}};var __editHierarchySave;function __editHierachyOver(event){if(!globalHierarchyBarHighlight)return;try{var index;if(browser.ie){index=event;}else{var id=event.target.id;index=id.substring(id.length-1,id.length);}var obj=__editHierarchy[index];__editHierarchySave=obj.style.backgroundColor;obj.style.backgroundColor=globalHierarchyBarSelectionColor;}catch(Error){}};function __editHierachyOut(event){if(!globalHierarchyBarHighlight)return;try{var index;if(browser.ie){index=event;}else{var id=event.target.id;index=id.substring(id.length-1,id.length);}var obj=__editHierarchy[index];obj.style.backgroundColor=__editHierarchySave;}catch(Error){}};function __editHierachyClick(event){try{var index;if(browser.ie){index=event;}else{var id=event.target.id;index=id.substring(id.length-1,id.length);}var obj=__editHierarchy[index];obj.style.backgroundColor=__editHierarchySave;__editActiveObject=__editHierarchy[index];__editBuildTagHierarchy();if(globalAttributeAreaVisible){__editPrepareParams();var tagName=__editActiveObject.tagName.toLowerCase();if(tagName=="body")__editMozParam[2]="BODY";else if(tagName=="table")__editMozParam[2]="TABLE";else if(tagName=="td" || tagName=="th")__editMozParam[2]="CELL";else if(tagName=="form")__editMozParam[2]="FORM";else if(tagName=="img")__editMozParam[2]="IMAGE";else if(tagName=="a")__editMozParam[2]="LINK";else if(tagName=="select")__editMozParam[2]="SELECT";else if(tagName=="input")__editMozParam[2]="INPUT";else if(tagName=="textarea")__editMozParam[2]="TEXTAREA";else if(tagName=="div" || tagName=="span" || tagName=="p")__editMozParam[2]="DIV";else __editMozParam[2]="UNKNOWN";__editMozParam[5]=__editActiveObject;__editMozParam[13]="3";__editMozParam[15]="1";if(__editMozParam[2]!="UNKNOWN")document.getElementById("windowRight").contentWindow.initDialog(__editMozParam);}}catch(Error){}};var sagSelectedText="";function sagSetHighlight(value,highlightAll){__editHighlightCaseSensitive=true;editHighlightWords(value,highlightAll);};function sagGetHighLight(){var temp="";var doc=getDoc();var allFont=doc.body.getElementsByTagName("font");try{for(var i=0;i<allFont.length;i++){var color=allFont[i].style.backgroundColor.toLowerCase();if(!browser.ie)color=rgbToHex(color).toLowerCase();if(color==__editHighlightColor){if(temp!="")temp+=";";var text="";if(!browser.ie)text=allFont[i].textContent;else text=allFont[i].innerText;text=text.replace(/;/gi,"/;");temp+=text;}}}catch(Error){}return temp;};function sagSetColor(){editBackColor(__editHighlightColor);if(!browser.ie){var doc=getDoc();var allSpan=doc.body.getElementsByTagName("span");for(var i=0;i<allSpan.length;i++){var color=allSpan[i].style.backgroundColor.toLowerCase();if(!browser.ie)color=rgbToHex(color).toLowerCase();if(color==__editHighlightColor){var newFont=doc.createElement("font");newFont.style.backgroundColor=__editHighlightColor;newFont.innerHTML=allSpan[i].innerHTML;allSpan[i].parentNode.replaceChild(newFont,allSpan[i]);}}}};function sagGetSelection(){return sagSelectedText;};function __intelliHide(){try{__isIntelli=false;document.getElementById("__int__popup").style.visibility="hidden";document.getElementById("__intelli0").scrollIntoView(false);__intelliPos=-1;__intelliData=new Array();}catch(Error){};};function __intelliMouseClick(row){editInsertHtml(document.getElementById("__intelli"+row).innerHTML);__intelliHide();};function __intelliAction(){if(__isIntelli){for(var i=0;i<__intelliRowCount;i++){document.getElementById("__intelli"+i).style.backgroundColor="white";document.getElementById("__intelli"+i).style.borderColor="white";}var evt=getWindow().event;if(evt.keyCode==40){__intelliPos++;if(__intelliPos >=__intelliRowCount)__intelliPos=0;document.getElementById("__intelli"+__intelliPos).style.backgroundColor="#B1C0D2";document.getElementById("__intelli"+__intelliPos).style.borderColor="#0A246A";document.getElementById("__intelli"+__intelliPos).scrollIntoView(false);}if(evt.keyCode==38){__intelliPos--;if(__intelliPos < 0)__intelliPos=__intelliRowCount-1;document.getElementById("__intelli"+__intelliPos).style.backgroundColor="#B1C0D2";document.getElementById("__intelli"+__intelliPos).style.borderColor="#0A246A";document.getElementById("__intelli"+__intelliPos).scrollIntoView(false);}if(evt.keyCode==13 || evt.keyCode==32){if(__intelliPos>=0 && __intelliPos <=__intelliRowCount)editInsertHtml(__intelliData[__intelliPos]);evt.cancelBubble=true;evt.returnValue=false;__intelliHide();return true;}if(evt.keyCode==27 || evt.keyCode==8){__intelliHide();}}};function __intelliProcess(data){var temp="";temp+="<table width='100%' cellspacing='0' cellpadding='0' border=0 style='padding: 1px;font-family: arial;font-size: 11px'>";temp+="<tr><td>";var aTexts=__data.split("&&;");__intelliRowCount=aTexts.length-1;for(var i=0;i<aTexts.length-1;i++){var aText=aTexts[i].split("&&:");var temp1=aText[0];var image="";if(temp1!="")image="<img src='"+temp1+"' border='0'>";var text=aText[1];var value=aText[2];__intelliData[i]=value;temp+="<table id='__intelli"+i+"' style='border: 1px solid white;background: white;font-family: arial;font-size: 11px' border='0' cellspacing='0' cellpadding='1' width='100%'><tr><td width='1'>"+image+"</td><td style='margin-left: 2px;color: black'>"+text+"</td></tr><table>";}temp+="</td></tr>";temp+="</table>";var objPopup=null;if(!document.getElementById("__int__popup")){objPopup=document.createElement("div");document.body.appendChild(objPopup);objPopup.id="__int__popup";objPopup.style.width="150px";objPopup.style.height="100px";objPopup.style.position="absolute";objPopup.style.overflow="auto";objPopup.style.border="1px outset";objPopup.style.backgroundColor="white";}else{objPopup=document.getElementById("__int__popup");}objPopup.innerHTML=temp;objPopup.style.left=__intelliLeft;objPopup.style.top=__intelliTop;objPopup.style.visibility="visible";__isIntelli=true;};function decode(key){if(key==""){return "";}var result="";var single=key.split(".");for(var i=0;i<single.length;i++){var temp=single[i];result=result+String.fromCharCode(parseInt(temp)^ 15);}return result;};function encode(key){if(key==""){return "";}var result="";for(var i=0;i<key.length;i++){var temp=key.charCodeAt(i);if(i>0)result=result+".";result=result+(parseInt(temp)^ 15);}return result;};/*
Modification or decryption of this file is strictly forbidden - Pintexx GmbH
*/
function editSetStyleSheetRules(){var html="";try{__editStyles=new Array();__editStylesFormat=new Array();__editStylesFormatHtml=new Array();__editStylesObject=new Array();var doc=getDoc();if(doc.styleSheets.length>0){for(var count=0;count<doc.styleSheets.length;count++){var objStyleSheet=doc.styleSheets[count];var objRules=null;var styleError=false;try{if(browser.ie){objRules=objStyleSheet.rules;}else{objRules=objStyleSheet.cssRules;}}catch(Error){}for(var i=0;i<objRules.length;i++){var value=objRules[i].selectorText;var displayName=(objRules[i].style["display-name"]!=null?objRules[i].style["display-name"]:"");var displayDisabled=(objRules[i].style["display-disabled"]!=null?true : false);if(!browser.ie){if(value.indexOf("."))value=value.substring(value.indexOf("."));}if(value.substring(0,1)=="."&&value.indexOf(' ')<0){value=value.substring(1,value.length);if(displayName=="")displayName=value;if(value.toLowerCase()!="standard"){var style=objRules[i].style;if(style.color=="#FFFFFF"||style.color=="#ffffff"||style.color=="white"){if(style.backgroundColor!="")html="<span style='text-decoration: "+style.textDecoration+";font-style:"+style.fontStyle+";font-weight:"+style.fontWeight+";font-family:"+style.fontFamily+";font-size:"+style.fontSize+";color:"+style.color+";border:"+style.border+";background-color: "+style.backgroundColor+"'>"+displayName+"</span>";else html="<span style='text-decoration: "+style.textDecoration+";font-style:"+style.fontStyle+";font-weight:"+style.fontWeight+";font-family:"+style.fontFamily+";font-size:"+style.fontSize+";color:"+style.color+";border:"+style.border+";background-color: #c0c0c0'>"+displayName+"</span>";}else{html="<span unselectable='on'  style='text-decoration: "+style.textDecoration+";font-style:"+style.fontStyle+";font-weight:"+style.fontWeight+";font-family:"+style.fontFamily+";font-size:"+style.fontSize+";color:"+style.color+";border:"+style.border+";background-color:"+style.backgroundColor+"'>"+displayName+"</span>";}var styleStruct=new StyleStruct(displayName,value,html);if(!displayDisabled)__editStyles[__editStyles.length]=styleStruct;}}else if(value.substring(0,1)==":"){}else if(value.indexOf(".")>0){var tag=value.substring(0,value.indexOf("."));var name=value.substring(value.indexOf(".")+1);var style=objRules[i].style;html=style.cssText;html=html.replace(/float:/gi,"zfloat:");var data=new Quad(name.toLowerCase(),name,tag.toLowerCase(),html);__editStylesObject[__editStylesObject.length]=data;}value=value.toUpperCase();if(value=="H1"||value=="H2"||value=="H3"||value=="H4"||value=="H5"||value=="H6"){var style=objRules[i].style;html="<span unselectable='on' style='font-family:"+style.fontFamily+";font-size:"+style.fontSize+";color:"+style.color+";border:"+style.border+";background-color:"+style.backgroundColor+"'>";__editStylesFormat[__editStylesFormat.length]=value;__editStylesFormatHtml[__editStylesFormatHtml.length]=html;}}}__editStylesAvailable=true;}else{__editStylesAvailable=true;}__editStylesObject.sort(__editStyleObjectSort);}catch(Error){__editStylesAvailable=false;}};function __editStyleObjectSort(a,b){if(a.name<b.name)return-1;if(a.name>b.name)return 1;return 0;};function __editUpdateStyles(init){if(!globalObjectStyle){return;}var aTags=__editGetTagHierarchy(__editActiveObject,0,true);var useImage=false;for(var i=0;i<aTags.length;i++){var tag=aTags[i];for(var j=0;j<__editStylesObject.length;j++){if(__editStylesObject[j].value==tag){useImage=true;break;}}if(useImage){break;}}if(!init&&!useImage)return;eventOnAddStyle("","");eventOnAddStyle("Standard",getLanguageString(language,6000),"",useImage,getLanguageString(language,6000));for(var i=0;i<__editStyles.length;i++){eventOnAddStyle(__editStyles[i].className,__editStyles[i].displayHtml,"",useImage,__editStyles[i].displayName);}for(var i=0;i<aTags.length;i++){var tag=aTags[i];for(var j=0;j<__editStylesObject.length;j++){if(__editStylesObject[j].value==tag){eventOnAddStyle(__editStylesObject[j].key,"<span unselectable='ON' style='"+__editStylesObject[j].value2+"'>"+__editStylesObject[j].key+"</span>",__editStylesObject[j].value,true,__editStylesObject[j].key);}}}};function editSetStyle(value,tag){var status=(value.toUpperCase()=="STANDARD")?false:true;var useThisTag=(tag!=""?tag : "");try{var doc=getDoc();var sel=new Selection(doc);var selectedObjects=new Array();if(sel.type=="NONE"){globalPreselect=true;globalPreselectMode=1;globalPreselectAttribute=value;globalPreselectStatus=status;}if(sel.type=="CONTROL"||sel.type=="NONE"){activeObject=sel.getActiveObject();if(activeObject){if(status){if(useThisTag==""){activeObject.className=value;if(globalRemoveInlineStyles)activeObject.removeAttribute("style");}else{var aTagObjects=__editGetTagHierarchy(activeObject,1,true);for(var i=0;i<aTagObjects.length;i++){var curObject=aTagObjects[i];if(curObject.tagName.toLowerCase()==useThisTag){curObject.className=value;if(globalRemoveInlineStyles)curObject.removeAttribute("style");}}}}else{activeObject.removeAttribute("className");activeObject.removeAttribute("class");}}}if(sel.type=="TEXT"){selectedObjects=sel.prepareSelection(true);for(var i=0;i<selectedObjects.length;i++){var curObject=selectedObjects[i];if(curObject.tagName.toLowerCase()=="span"){if(status){curObject.className=value;if(globalRemoveInlineStyles)curObject.removeAttribute("style");}else{curObject.removeAttribute("className");curObject.removeAttribute("class");if(globalOptimizer){__editReplaceSpanByText(curObject);}}}}}}catch(Error){}sel.__selection_reset();return;};function editSetExternalStyleSheet(url){var aStyleSheets=editGetExternalStyleSheets();for(var i=0;i<aStyleSheets.length;i++){if(aStyleSheets[i].href.toLowerCase()==url.toLowerCase()){alert(getLanguageString(language,1048));return;}}var doc=getDoc();var link=doc.createElement("link");var heads=doc.getElementsByTagName("head");link.rel="stylesheet";link.href=__editRelativeGetRelFromAbs(url,"LINK");link.type="text/css";heads[0].appendChild(link);if(globalLinkPathRelative!="")__editRelativePrepareObject('STYLE');setTimeout("__editSetExternalStyleSheet_delay()",200);};function __editSetExternalStyleSheet_delay(){editSetStyleSheetRules();__eventOnFileLoaded_Delay();};function editGetExternalStyleSheets(){var aStyleSheets=new Array();var doc=getDoc();var links=doc.getElementsByTagName("link");for(var i=0;i<links.length;i++){if(links[i].rel.toLowerCase()=="stylesheet"){aStyleSheets[aStyleSheets.length]=links[i];}}return aStyleSheets;};function editRemoveExternalStyleSheet(url){var doc=getDoc();var links=doc.getElementsByTagName("link");for(var i=0;i<links.length;i++){if(links[i].href==url){__editRemoveNode(links[i]);editUpdateExternalStyleSheets();return;}}};function editUpdateExternalStyleSheets(){if(browser.ie){setTimeout("__editSetExternalStyleSheet_delay()",20);editRefresh(getDoc(),"EDIT");}};function editRemoveExternalStyleSheets(){var aStyleSheets=editGetExternalStyleSheets();if(aStyleSheets.length==0){alert(getLanguageString(language,1049));return;}if(aStyleSheets.length==1){editRemoveExternalStyleSheet(aStyleSheets[0].href);return;}__editMozParam=new Array();__editMozParam[0]=language;__editMozParam[1]=aStyleSheets;__editMozParam[2]=window;__editMozParam[14]=__editLanguage;if(browser.ie){window.showModalDialog(__editGetEditorUrl()+"dialogs/stylesheet.html",__editMozParam,"dialogHeight:"+(180+globalDialogOffset)+"px;dialogWidth:350px;resizable:0;status:0;scroll:0");}else{var left=screen.width/2-350;var top=screen.height/2-200;window.open(__editGetEditorUrl()+"dialogs/stylesheet.html","color","modal=1,left="+left+",top="+top+",height=200,width=350,resizable=0,status=0,scrollbars=0");}};function editEditExternalStyleSheet(){var ps=new pinStyle();ps.url=__editGetEditorUrl()+"add-on/css/";ps.language=language;ps.technology=globalTechnology;ps.design=design;if(design=="5")ps.design="4";var url="";var path="";try{url=globalStyleUrlAbsolute;path=globalStylePathAbsolute;}catch(Error){}if(url=="")url=globalDocumentUrlAbsolute;if(path=="")path=globalDocumentPathAbsolute;if(url==""||path==""){alert("Warning: Please specify url/path for documents !");return;}else{ps.cssUrl=url;ps.cssPath=path;}var doc=getDoc();var links=doc.getElementsByTagName("link");if(links.length==1){var url=links[0].href;var i=url.length-1;while(i>0){if(url.substring(i,i+1)=="/")break;i--;}ps.cssFileName=url.substring(i+1);}ps.open();};/*
Modification or decryption of this file is strictly forbidden - Pintexx GmbH
*/
var ___version="7.1.1106";var ___version_intern="70";var __enableRetainCode=false;var toolbarstop;var __mode="";var __editToolbarString="";var __editToolbarScriptID="";var __lng="";var __userCode="";var __loadFile="";var __readOnly=false;var __startupMode="E";var __splk="";var __editTCExt="";var __editDynEvent="";var __editDocumentView="";var globalSpellPage="add-on/spell/spell."+globalTechnology;if(globalTechnology=="asp")globalSpellPage="add-on/spell/spell.aspx";var globalPDFLicenseKey="";var globalSpellLicenseKey="";var globalUserMode="0";var globalControlPaste=false;var design="5";var language="EN";var globalMenuVisible=false;var globalHierarchyBarVisible=false;var globalAttributeAreaVisible=false;var globalDocumentView=false;var globalRulerVisible=false;var globalStatusBarVisible=false;var globalSideBarVisible=false;var globalImageUrlAbsolute="";var globalImagePathAbsolute="";var globalDocumentUrlAbsolute="";var globalDocumentPathAbsolute="";var globalTemplateUrlAbsolute="";var globalTemplatePathAbsolute="";var globalAutoTextUrlAbsolute="";var globalAutoTextPathAbsolute="";var globalImagePathRelative="";var globalLinkPathRelative="";var globalDocDir="data/files";var globalImageDir="data/images";var globalSingleMode=false;var globalSpellDictPath="";var globalSpellUserDictPath="";var globalHTMLMode="2";var globalBreakMode="wp";var globalSupportHttps=false;var globalToolbarColor="";var globalConvertChar=true;var __editToolbarXMLString="";var globalFontSizeType="pt";var globalUseStyleFormatting=true;var globalUseOnlyStyleFormatting=true;var globalSpellMode=0;var globalRootUrl="";var globalRootPath="";var globalEditorUrl="";var globalUploadImageFileTypes="";var globalUploadDocumentFileTypes="";var globalRelativeImageRoot="";var globalUploadMaxFileSize=1000000;var globalEditorImagesFolder=__editGetEditorUrl()+"design/image/";var globalToolbarConfigurationHTML="";var globalToolbarConfigurationWP="";var globalToolbarConfigurationDesktop="";var globalHierarchyBarSelectionColor="#FFDC81";var globalHierarchyBarHighlight=true;var globalAttributeAreaUrl="mode/html/dialogs/attribute.html?style="+globalTabDesign;var globalAttributeAreaWidth="230px";var globalLeftAreaVisible=false;var globalLeftAreaWidth="24";var globalLeftAreaUrl="toolbar/pinToolbar.html";var globalDocumentMargin="20";var globalDocumentBackColor="#9099ae";var globalRulerColor="";var globalDocumentPageWidth=794;var globalRulerUnit="1";var globalTabDesign="1";var globalAttributeAreaTabDesign="3";var globalTagColor="#0000ff";var globalTagNameColor="#800000";var globalAttributeColor="red";var globalStyleColor="#0000ff";var globalLanguageDetect=false;var globalUpdateToolbarWithKey=true;var globalHighlightColor="#d8d8d7";var globalAutoFocus=true;var globalXHtmlType=0;var globalISKey="";var globalToolbarBorder=true;var globalToolbarHeight=27;var globalPopupWidth=200;var globalHTMLModeExtended=true;var globalDialogFilterDoc="html;htm;txt;docx;";var globalDialogFilterImage="gif;jpeg;jpg;png;";var globalDialogFilterLink="html;htm;txt;doc;docx;pdf;";var globalEditableColor="#c0c0c0";var globalPrettyFormat=true;var globalFirstTableRowIsHeader=false;var globalStaticTables=false;var globalDisplaySymbolAnchor=true;var globalShowTBodyTag=true;var globalHTMLAreaWrapLine=false;var globalConvertChar=true;var globalDialogUrlButton=true;var globalImageRatioConstrain=true;var globalRemoveCRLF=false;var globalRemoveInlineStyles=true;var globalUsePinUpload=false;var globalUsePinImage=false;var globalDebug=false;var globalDialogOffset=0;var globalOptimizer=false;var globalOptimizerPath="";var globalOptimizerParams="tidy --show-body-only 1 --word-2000 1 -f err.txt -m ";var globalSaveBookmark="";var globalSaveRange=null;var globalVersion6=true;var globalSpellByType=false;var globalSpellTimer=null;var globalSpellDelay=1500;var globalSuppressedKeys=new Array();var globalImagePathRelative_save="";var globalLinkPathRelative_save="";var globalLicenceKey="";var globalShowSpecialChar=false;var globalHTMLUseColor=true;var globalRemoveMSMetaTag=true;var globalSetStyleMode=1;var globalCurrentArea="EDIT";var globalNewFormat=true;var __globalProcessChange=true;var globalForceFokus=false;var globalObjectStyle=true;var globalPreselect=false;var globalPreselectStyleName="";var globalPreselectStyleValue="";var globalPreselectAttribute="";var globalPreselectStatus=false;var globalPreselectMode=0;var globalVerifyKeyWhenNotEditable=false;var globalDefaultRelativePath="http://localhost/";var globalSavePage=__editGetEditorUrl()+"server/"+globalTechnology+"/save."+globalTechnology;var globalPlaceHolderCharacter=String.fromCharCode(10);var globalScrollMode=0;var globalAddPlaceHolders=true;var globalAddTableCellSpace=true;var globalOptimizeAnchor=true;var globalPDFVersion="professional";var globalPDFPage="http://localhost/pinEditPDF/pdf.aspx";var globalPDFOutputPath="c:/inetpub/wwwroot/pinEditPDF/pdf/";var globalPDFOutputUrl="http://localhost/pinEditPDF/pdf/";var globalPDFFileName="";var globalPDFPaperSize="1";var globalPDFOrientation="1";var globalPDFResolution="600";var globalPDFTitle="";var globalPDFAuthor="";var globalPDFSubject="";var globalPDFCreator="";var globalPDFKeyWords="";var globalPDFHeader="";var globalPDFFooter="";var globalPDFJPEGCompression=1;var globalPDFUnit=1;var globalPDFMarginLeft=0;var globalPDFMarginTop=0;var globalPDFMarginRight=0;var globalPDFMarginBottom=0;var globalPDFHeaderHeight=0;var globalPDFFooterHeight=0;var globalPDFConvertForms=0;var globalPDFConvertLinks=0;var globalPDFOwnerPassword="";var globalPDFUserPassword="";var system="";var __currentURL="";var __currentURLTemp="";var __editDocumentLoadedFlag=false;var __editActiveObject=null;var __editDisableBR=false;var __editSaveMode=globalSaveMode;var __editFieldCounter=1;var __editReloadAfterSave=false;var __editUploadUrl="";var __editUploadPath="";var __editUploadedFile="";var __editUploadMode=0;var __editSaveModeHtml="";var __editStyleSheetCombo="";var __editFormatCombo=null;var __editContextMenu=null;var __editToolbarCode="";var __editEditorStatus="EDIT";var __editMenuVisible=true;var __editContent="";var __editChanged=false;var __editControlVDisabled=globalControlVDisabled;var __editHierarchy=null;var __editMozParam;var __editFocusTime=0;var __editDefaultFont="";var __editDefaultFontSize="";var __editSpecialChar1=new Array();var __editSpecialChar2=new Array();var __editSelectedTags=null;var __editMozClipboard="";var __editLoading=true;var __editReadOnly=false;var __editUndo=new Array();var __editUndoIndex=0;__editUndo[0]=new UndoStruct("",null);var __editHTMLAreaUsed=false;var __editStyles=new Array();var __editStylesFormat=new Array();var __editStylesFormatHtml=new Array();var __editStylesObject=new Array();var __editToolbarReady=false;var __editStylesAvailable=false;var __editInitStatus=1;var __temp_moz_html="";var __editEditWriteCalled=false;var __editSelectedDialogPath=new Array();__editSelectedDialogPath[0]="";__editSelectedDialogPath[1]="";__editSelectedDialogPath[2]="";__editSelectedDialogPath[3]="";__editSelectedDialogPath[4]="";__editSelectedDialogPath[5]="";__editSelectedDialogPath[6]="";__editSelectedDialogPath[7]="";__editSelectedDialogPath[8]="";var __editEnableExternalPreview="";var __editHighlightColor="#ffcc01";var __editHighlightSeparator=";";var __editHighlightCaseSensitive=false;var __editNoEdit=false;var globalSaveContent="";if(globalHTMLUseColor){var __editopenTag="<FONT color="+globalTagColor+">&lt;</FONT>";var __editcloseTag="<FONT color="+globalTagColor+">&gt;</FONT>";var __editcloseTagWithSlash="<FONT color="+globalTagColor+"> /&gt;</FONT>";}else{var __editopenTag="&lt;";var __editcloseTag="&gt;";var __editcloseTagWithSlash=" /&gt;";}if(globalHTMLUseColor)var __editfontTag="<FONT color="+globalTagNameColor+">";else var __editfontTag="";if(globalHTMLUseColor)var __editfontAttribute="<FONT color="+globalAttributeColor+">";else var __editfontAttribute="";if(globalHTMLUseColor)var __editfontStyle="<FONT color="+globalStyleColor+">";else var __editfontStyle="";if(globalHTMLUseColor)var __editfontClose="</FONT>";else var __editfontClose="";var __zindex=1000;var __isIntelli=false;var __intelliPos=-1;var __intelliRowCount=10;var __intelliLeft=0;var __intelliTop=0;var __intelliData=new Array();var targetIntellisense=__editGetEditorUrl()+"server/"+globalTechnology+"/intellisenseadapter."+globalTechnology;var lastMode='EDIT';var __lastHeight=0;var __editTableHighlight=true;var __editCurrentTable;var objSelected;var popup;var currentRow;var currentCol;function editProcess(){__toolbar_setkey(false);};function __editBuildToolbarStatus(){var temp="";var delimiter=":";temp+=(editQuery("bold")? "1":"0")+delimiter;temp+=(editQuery("italic")? "1":"0")+delimiter;temp+=(editQuery("underline")? "1":"0")+delimiter;temp+=(editQuery("superscript")? "1":"0")+delimiter;temp+=(editQuery("subscript")? "1":"0")+delimiter;temp+=(editQuery("justifyleft")? "1":"0")+delimiter;temp+=(editQuery("justifycenter")? "1":"0")+delimiter;temp+=(editQuery("justifyright")? "1":"0")+delimiter;temp+=(editQuery("justifyfull")? "1":"0")+delimiter;temp+=(editQuery("insertorderedlist")? "1":"0")+delimiter;temp+=(editQuery("insertunorderedlist")? "1":"0")+delimiter;var activeObject=editGetActiveObject();try{var cn=activeObject.className;var style=cn ? cn : "Standard";temp+=style+delimiter;}catch(Error){temp+=delimiter;}try{var tagName=activeObject.tagName.toUpperCase();if(tagName=="H1")temp+="<h1>"+delimiter;else if(tagName=="H2")temp+="<h2>"+delimiter;else if(tagName=="H3")temp+="<h3>"+delimiter;else if(tagName=="H4")temp+="<h4>"+delimiter;else if(tagName=="H5")temp+="<h5>"+delimiter;else if(tagName=="H6")temp+="<h6>"+delimiter;else if(tagName=="ADDRESS")temp+="<address>"+delimiter;else if(tagName=="ADDRESS")temp+="<address>"+delimiter;else if(tagName=="MENU")temp+="<menu>"+delimiter;else if(tagName=="PRE")temp+="<pre>"+delimiter;else if(tagName=="LI"){if(activeObject.parentNode.tagName=="DIR")temp+="<dir>"+delimiter;else if(activeObject.parentNode.tagName=="MENU")temp+="<menu>"+delimiter;else temp+="NORMAL"+delimiter;}else{temp+="NORMAL"+delimiter;}}catch(Error){temp+=delimiter;}temp+=editQuery("FontName")+delimiter;temp+=editQuery("FontSize")+delimiter;if(browser.ie){temp+=__editToHexColor(editQuery("forecolor"))+delimiter;temp+=__editToHexColor(editQuery("backcolor"))+delimiter;}else{temp+=editQuery("forecolor")+delimiter;temp+=editQuery("hilitecolor")+delimiter;}if(__editPrepareTableObjects()){if(currentCol==null)temp+="0"+delimiter+"1"+delimiter;else temp+="1"+delimiter+"1"+delimiter;}else{temp+="0"+delimiter+"0"+delimiter;}temp+=(editQuery("strikethrough")? "1":"0")+delimiter;return temp;};function __editOnChanged(value){if(!__globalProcessChange)return;__editChanged=value;__editUpdateScrollBar();var doc=getDoc();var sel=new Selection(doc);try{if(value){eventOnChanged();}else{__editUndo=new Array();var bookmark=null;if(browser.ie){var objRange=doc.selection.createRange();bookmark=objRange.getBookmark();}var html=doc.body.innerHTML;var us=new UndoStruct(html,bookmark);__editUndo[__editUndo.length]=us;__editUndoIndex=0;return;}var html=doc.body.innerHTML;if(value){if((html!=__editUndo[__editUndo.length-1].html)){__editUndoIndex=__editUndoIndex+1;var bookmark="";if(browser.ie){var objRange=null;if(sel.type=="CONTROL"){var object=sel.getActiveObject();objRange=doc.body.createTextRange();try{objRange.moveToElementText(object);}catch(Error){}}else{objRange=doc.selection.createRange();}bookmark=objRange.getBookmark();}var us=new UndoStruct(html,bookmark);__editUndo[__editUndoIndex]=us;}}}catch(Error){if(globalDebug)alert("Error in __editOnChanged:"+Error);};};function editUndo(){try{var doc=getDoc();if(__editUndo[__editUndoIndex].html!=doc.body.innerHTML){__editOnChanged(true);}if(__editUndoIndex > 0)__editUndoIndex=__editUndoIndex-1;else return;doc.body.innerHTML=__editUndo[__editUndoIndex].html;if(browser.ie){var textRange=doc.body.createTextRange();var saveRange=__editUndo[__editUndoIndex].range;if(saveRange){textRange.moveToBookmark(saveRange);textRange.select();textRange.scrollIntoView(true);__editUpdateScrollBar();}}eventOnChanged();if(globalShowSpecialChar)__editShowSpecialChar(false);__editShowSymbols();}catch(Error){if(globalDebug)alert("Error in editUndo:"+Error);}};function editRedo(){try{var doc=getDoc();if(__editUndoIndex <(__editUndo.length-1)){__editUndoIndex=__editUndoIndex+1;}eventOnChanged();doc.body.innerHTML=__editUndo[__editUndoIndex].html;if(browser.ie){var textRange=doc.body.createTextRange();var saveRange=__editUndo[__editUndoIndex].range;if(saveRange){textRange.moveToBookmark(saveRange);textRange.select();textRange.scrollIntoView(true);__editUpdateScrollBar();}}}catch(Error){}};function getDoc(){if(globalCurrentArea=="HTML")return getDocHtml();else return getDocEdit();};function getDocEdit(){var doc=null;try{doc=document.getElementById('pinEdit').contentWindow.document;}catch(Error){}return doc;};function getDocHtml(){var doc=null;try{doc=document.getElementById('pinEditHtml').contentWindow.document;}catch(Error){}return doc;};function getDocPreview(){return document.getElementById('pinEditPreview').contentWindow.document;};function getWindow(){if(globalCurrentArea=="HTML")return document.getElementById('pinEditHtml').contentWindow;else return document.getElementById('pinEdit').contentWindow;};function getEdit(){return document.getElementById('pinEdit');};function editCancel(){document.location.href=__currentURL;};function editSave(url,html){var text;if(__editSaveMode==0)text=editGetHtml();if(__editSaveMode==1)text=editGetBodyHtml();if(__editSaveMode==2)text=editGetHtmlRel();if(__editSaveMode==3)text=editGetBodyHtmlRel();if(__editSaveMode==4)text=__editGetXHtml();if(__editSaveMode==5)text=editGetXHtmlBody();if(__editSaveMode==6)text=editGetText();if(eventOnBeforeSave(text))return;if(html!=null)text=html;__comm=new Comm(globalSavePage);if(url){editStatusBarSetText(url);__currentURL=url;__currentURLTemp=url;__comm.executeSave(text,url);}else{__currentURLTemp=__currentURL;__comm.executeSave(text,__currentURL);}};function editNew(mode){var newMode=0;if(mode){if(mode==1)newMode=1;}if(eventOnBeforeNew(mode))return;var doc=getDoc();if(!browser.ie){}if(newMode==0){if(globalBreakMode=="p")editWrite("<p></p>");else if(globalBreakMode=="wp")editWrite("<p style='margin-top:0;margin-bottom:0'></p>");else editWrite("");}else{if(globalBreakMode=="p" || globalBreakMode=="wp"){try{doc.body.innerHTML="<p id='__temp__'></p>";var p=doc.getElementById("__temp__");if(globalBreakMode=="wp"){p.style.marginTop=0;p.style.marginBottom=0;}var sel=new Selection(doc);sel.setCursorToObject(p);p.removeAttribute("id");}catch(Error){}}else{doc.body.innerHTML="";}}__editSetPlaceHolders();getDocHtml().body.innerHTML="";getDocPreview().body.innerHTML="";__editDefaultFont!="" ?(doc.body.style.fontFamily=__editDefaultFont):(doc.body.style.fontFamily="");__editDefaultFontSize!="" ?(doc.body.style.fontSize=__editDefaultFontSize):(doc.body.style.fontSize="");__currentURL="";__editOnChanged(false);editStatusBarSetText("");if(__intisetemp)__editLave();editSetFocus();};function editLoad(url){if(url.indexOf(globalEditorPageName)>=0 || url.indexOf("editor/dummy.html")>=0)return;__editHTMLAreaUsed=false;__editDocumentLoadedFlag=false;__editDefaultFont="";__editDefaultFontSize="";__editStylesAvailable=false;__editInitStatus=2;if(eventOnBeforeLoad(url))return;if(url!=""){__editLoading=true;var nocache="?rnd="+Math.random();if(browser.ie)getEdit().src=url+nocache;else{if(!document.getElementById("__moz_load")){iframe=document.createElement("IFRAME");iframe.id="__moz_load";iframe.style.visibility="hidden";iframe.src=url+nocache;iframe.onload=__moz_OnLoad;document.body.appendChild(iframe);}else{iframe=document.getElementById("__moz_load");iframe.src=url+nocache;}}editStatusBarSetText(url);}};function editSetStyleSheetObject(combo){__editStyleSheetCombo=combo;};function editSetFormatObject(combo){__editFormatCombo=combo;};function __editHideSymbols(){try{var doc=getDoc();if(!browser.ie){try{var aEmbed=doc.getElementsByTagName("embed");for(i=0;i<aEmbed.length;i++){aEmbed[i].parentNode.parentNode.parentNode.parentNode.style.borderColor="white";}}catch(error){}}var aForms=getDoc().getElementsByTagName("form");for(var i=0;i<aForms.length;i++){if(aForms[i].style.borderLeftStyle.toLowerCase()=="dotted" && aForms[i].style.borderLeftColor=="red"){if(browser.ie){aForms[i].style.borderWidth="";aForms[i].style.borderStyle="";aForms[i].style.borderColor="";}else{aForms[i].style.border="";}}}if(globalDisplaySymbolAnchor){var aAnchors=doc.getElementsByTagName("a");for(var i=0;i<aAnchors.length;i++){if(aAnchors[i].name!=""){aAnchors[i].removeAttribute("style");var childs=aAnchors[i].getElementsByTagName("img");for(var j=0;j<childs.length;j++){var child=childs[j];if(child.id.indexOf("__anchor")>=0){if(browser.ie)child.removeNode(true);else child.parentNode.removeChild(child);}}}}}var aHR=doc.getElementsByTagName("hr");for(var i=0;i<aHR.length;i++){if(aHR[i].id=="__PAGEBREAK__"){aHR[i].style.border="1px solid white";aHR[i].style.height="1px";aHR[i].style.color="white";}}editSetTableHighlight(false);if(globalShowSpecialChar)__editShowSpecialChar(false);if(globalSpellByType)editSpellClear();}catch(Error){}};function __editShowSymbols(){try{var doc=getDoc();if(!browser.ie){try{var aEmbed=doc.getElementsByTagName("embed");for(i=0;i<aEmbed.length;i++){aEmbed[i].parentNode.parentNode.parentNode.parentNode.style.borderColor="#c0c0c0";}}catch(error){}}var aForms=doc.getElementsByTagName("form");for(i=0;i<aForms.length;i++){aForms[i].style.borderWidth=1;aForms[i].style.borderStyle="dotted";aForms[i].style.borderColor="red";}if(globalDisplaySymbolAnchor){var aAnchors=doc.getElementsByTagName("a");var url=__editGetEditorUrl();for(i=0;i<aAnchors.length;i++){if(aAnchors[i].name!=""){aAnchors[i].style.borderWidth="1";aAnchors[i].style.borderStyle="dotted";aAnchors[i].style.borderColor="blue";var childs=aAnchors[i].getElementsByTagName("img");for(var j=0;j<childs.length;j++){var child=childs[j];if(child.id.substring(0,8)=="__anchor"){if(browser.ie)child.removeNode(true);else child.parentNode.removeChild(child);}}var img=doc.createElement("img");img.id="__anchor"+i;img.src=url+"design/image/anchor.gif";img.alt="";aAnchors[i].appendChild(img);}}}var aHR=doc.getElementsByTagName("hr");for(var i=0;i<aHR.length;i++){if(aHR[i].id=="__PAGEBREAK__"){aHR[i].style.color="";aHR[i].style.height="2px";aHR[i].style.border="1px dotted red";}}editSetTableHighlight(true);if(globalShowSpecialChar)__editShowSpecialChar(true);}catch(Error){}};function editGetParameter(){return __editMozParam;};function __editGetParam(){return __editMozParam;};var __editDelayRefDoc=null;var __editDelayRefMode="";function editRefresh(doc,mode){if(browser.ie){__editDelayRefDoc=doc;__editDelayRefMode=mode;setTimeout("__editDelayRefresh()",50);}};function __editDelayRefresh(){try{if(__editDelayRefMode=="EDIT"){var margin=__editDelayRefDoc.body.style.marginLeft;__editDelayRefDoc.body.style.marginLeft=1;__editDelayRefDoc.body.style.marginLeft=margin;if(globalAutoFocus){editSetCursorHome(__editDelayRefDoc);}}if(__editDelayRefMode=="HTML"){var margin=__editDelayRefDoc.body.style.marginLeft;__editDelayRefDoc.body.style.marginLeft=1;__editDelayRefDoc.body.style.marginLeft=margin;editSetCursorHome(__editDelayRefDoc);}if(__editDelayRefMode=="PREVIEW"){var margin=__editDelayRefDoc.body.style.marginLeft;__editDelayRefDoc.body.style.marginLeft=1;__editDelayRefDoc.body.style.marginLeft=margin;editSetCursorHome(__editDelayRefDoc);}}catch(Error){}};function editCut(){execute('cut',false,null);};function editCopy(){execute('copy',false,null);};function editPaste(){try{if(globalVerifyKeyWhenNotEditable && browser.ie){if(editIsTagNotEditable())return;}}catch(Error){}editSetFocus();__editOnChanged(true);if(browser.ie){if(globalOptimizer)__editPasteIntern();else return execute('paste',false,null);return true;}else{return execute('paste',false,null);}};function editMultipleSelection(){execute('MultipleSelection','',true);};function editInsert(){execute('OverWrite','',false);};function editOverwrite(){execute('OverWrite','',true);};function editZoom(value){if(__NotSupportedByMozilla())return;getEdit().style.zoom=value;};function editPrint(){__editAddParagraphSpace();__editSetSpaceInTables(true);__editHideSymbols();execute('print',true);__editShowSymbols();__editSetSpaceInTables(false);__editSetPlaceHolders();};function editFont(font){if(globalTechnology=="desk")editSetFocus();if(globalUseStyleFormatting){__editFormatObject(true,"fontFamily",font,"font-family");}else{execute("FontName","",font);}__editOnChanged(true);if(globalTechnology=="desk"){var temp=__editBuildToolbarStatus();var aTest=temp.split(":");aTest[13]=font;temp=aTest.join(":");eventOnChangeToolbar(temp);__editUpdateScrollBar();}else{onchangePINEDIT();}};function editFontSize(size){if(globalTechnology=="desk")editSetFocus();if(globalUseStyleFormatting){__editFormatObject(true,"fontSize",size+globalFontSizeType,"font-size");}else{if(globalFontSizeType=="px"){if(size <=10)newSize=1;if(size >=11 && size <=12)newSize=2;if(size >=13 && size <=16)newSize=3;if(size >=17 && size <=18)newSize=4;if(size >=19 && size <=24)newSize=5;if(size >=25 && size <=32)newSize=6;if(size >=33)newSize=7;}if(globalFontSizeType=="pt"){if(size <=8)newSize=1;if(size >=9 && size <=10)newSize=2;if(size >=11 && size <=12)newSize=3;if(size >=13 && size <=14)newSize=4;if(size >=15 && size <=18)newSize=5;if(size >=19 && size <=24)newSize=6;if(size >=25)newSize=7;}execute('fontsize','',newSize);}var temp=__editBuildToolbarStatus();var aTest=temp.split(":");var deskSize=isNaN(size)? size :(size+globalFontSizeType);aTest[14]=deskSize;temp=aTest.join(":");eventOnChangeToolbar(temp);__editUpdateScrollBar();};function editBold(status){__editFormat(status,"bold","fontWeight","bold","font-weight");};function editItalic(status){__editFormat(status,"italic","fontStyle","italic","font-style");};function editUnderline(status){__editFormat(status,"underline","textDecoration","underline","text-decoration");};function editOverline(status){__editFormat(status,"overline","textDecoration","overline","text-decoration");};function editStrikeThrough(status){__editFormat(status,"strikethrough","textDecoration","line-through");};function editBackColor(color){if(globalTechnology=="desk")editSetFocus();if(color=="NOCOLOR")color="";if(globalUseOnlyStyleFormatting){__editFormat((color=="" ? false:true),"backcolor","backgroundColor",color);}else{if(browser.ie){execute("backcolor","",color);}else{if(color=="")execute("hilitecolor","","white");else execute("hilitecolor","",color);}}};function editColor(color){if(globalTechnology=="desk")editSetFocus();if(color=="NOCOLOR")color="";if(globalUseOnlyStyleFormatting){__editFormat((color=="" ? false:true),"ForeColor","color",color,"color");}else{if(color=="")execute("ForeColor","","black");else execute("ForeColor","",color);}};function editSmallCaps(){try{var obj=editGetActiveObject();if(obj.tagName.toLowerCase()!="body"){if(obj.style.fontVariant=="small-caps")obj.style.fontVariant="normal";else obj.style.fontVariant="small-caps";}}catch(error){}};function editSuperscript(){if(globalTechnology=="desk")editSetFocus();execute('superscript');onchangePINEDIT();};function editSubscript(){if(globalTechnology=="desk")editSetFocus();execute('subscript');onchangePINEDIT();};function __editFormat(status,execName,style,valueStyle,styleName){if(globalTechnology=="desk")editSetFocus();if(globalUseOnlyStyleFormatting){__editFormatObject(status,style,valueStyle,styleName);}else{execute(execName);}__editOnChanged(true);onchangePINEDIT();};function __editFormatObject(status,style,valueStyle,styleName){var doc=getDoc();var sel=new Selection(doc);try{var selectedObjects=new Array();if(sel.type!="NONE"){if(sel.type=="TEXT"){selectedObjects=sel.prepareSelection(true);}else{var curObject=sel.getActiveObject();if(status){eval("curObject.style."+style+"=valueStyle");}else{__editRemoveStyleElement(curObject,style,styleName);}}}else{globalPreselect=true;globalPreselectMode=0;globalPreselectStyleName=style;globalPreselectStyleValue=valueStyle;globalPreselectStatus=status;return;}if(selectedObjects.length > 0){var firstTime=true;for(var i=0;i<selectedObjects.length;i++){var curObject=selectedObjects[i];if(sel.type=="TEXT"){var curTag=curObject.tagName.toLowerCase();if(curTag=="span" || curTag=="li"){if(curTag=="span" && firstTime){firstTime=false;try{var parentli=curObject.parentNode;while(parentli){if(parentli.tagName.toLowerCase()=="li"){break;}parentli=parentli.parentNode;}if(parentli)eval("parentli.style."+style+"=valueStyle");}catch(ex){}}if(status){eval("curObject.style."+style+"=valueStyle");}else{__editRemoveStyleElement(curObject,style,styleName);if(globalOptimizer && curTag=="span"){__editReplaceSpanByText(curObject);}}}}else{if(status){eval("curObject.style."+style+"=valueStyle");}else{__editRemoveStyleElement(curObject,style,styleName);}}}}}catch(Error){if(globalDebug)alert("__editFormatObject: "+Error);}sel.__selection_reset();};function editIndent(){try{var indentValue=40;if(globalUseOnlyStyleFormatting){var sel=new Selection(getDoc());if(sel.type=="NONE"){var aHierarchy=__editGetTagHierarchy(editGetActiveObject(),1);__editIndent(aHierarchy,indentValue);}if(sel.type=="TEXT"){sel.prepareTypeDetails();if(!sel.hasP){var parent=sel.getParent();var aHierarchy=__editGetTagHierarchy(parent,1);__editIndent(aHierarchy,indentValue);}else{var aObjects=sel.getSelectedObjects(true);for(var i=0;i<aObjects.length;i++){if(aObjects[i].tagName.toLowerCase()=="p"){var curLeft=aObjects[i].style.marginLeft;if(curLeft=="")curLeft=0;else curLeft=parseInt(aObjects[i].style.marginLeft);aObjects[i].style.marginLeft=curLeft+indentValue;}}}}}else{execute('indent');}}catch(Error){}};function __editIndent(aHierarchy,indentValue){for(var i=0;i<aHierarchy.length;i++){if(aHierarchy[i].tagName.toLowerCase()=="ol" || aHierarchy[i].tagName.toLowerCase()=="ul"){execute('indent');break;}if(aHierarchy[i].tagName.toLowerCase()=="p"){var curLeft=aHierarchy[i].style.marginLeft;if(curLeft=="")curLeft=0;else curLeft=parseInt(aHierarchy[i].style.marginLeft);aHierarchy[i].style.marginLeft=curLeft+indentValue;break;}}};function editOutdent(){try{var outdentValue=40;if(globalUseOnlyStyleFormatting){var sel=new Selection(getDoc());if(sel.type=="NONE"){var aHierarchy=__editGetTagHierarchy(editGetActiveObject(),1);__editOutdent(aHierarchy,outdentValue);}if(sel.type=="TEXT"){sel.prepareTypeDetails();if(!sel.hasP){var parent=sel.getParent();var aHierarchy=__editGetTagHierarchy(parent,1);__editOutdent(aHierarchy,outdentValue);}else{var aObjects=sel.getSelectedObjects(true);for(var i=0;i<aObjects.length;i++){if(aObjects[i].tagName.toLowerCase()=="p"){var curLeft=aObjects[i].style.marginLeft;if(curLeft=="")curLeft=0;else curLeft=parseInt(aObjects[i].style.marginLeft);aObjects[i].style.marginLeft=curLeft-outdentValue;if(parseInt(aObjects[i].style.marginLeft)< 0)aObjects[i].style.marginLeft=0;}}}}}else{execute('outdent');}}catch(Error){}};function __editOutdent(aHierarchy,outdentValue){for(var i=0;i<aHierarchy.length;i++){if(aHierarchy[i].tagName.toLowerCase()=="ol" || aHierarchy[i].tagName.toLowerCase()=="ul"){execute('outdent');break;}if(aHierarchy[i].tagName.toLowerCase()=="p"){var curLeft=aHierarchy[i].style.marginLeft;if(curLeft=="")curLeft=0;else curLeft=parseInt(aHierarchy[i].style.marginLeft);aHierarchy[i].style.marginLeft=curLeft-outdentValue;if(parseInt(aHierarchy[i].style.marginLeft)< 0)aHierarchy[i].style.marginLeft=0;break;}}};function __editJustify(action){try{if(globalUseOnlyStyleFormatting){var sel=new Selection(getDoc());if(sel.type=="NONE"){var aHierarchy=__editGetTagHierarchy(editGetActiveObject(),1);____editJustify(aHierarchy,action,sel);}if(sel.type=="TEXT"){sel.prepareTypeDetails();if(!sel.hasP){var parent=sel.getParent();var aHierarchy=__editGetTagHierarchy(parent,1);____editJustify(aHierarchy,action,sel);}else{var aObjects=sel.getSelectedObjects(true);for(var i=0;i<aObjects.length;i++){var curObject=aObjects[i];if(curObject.tagName.toLowerCase()=="p"){if(action=="left"){__editRemoveStyleElement(curObject,"textAlign","text-align");}else{curObject.style.textAlign=action;}curObject.removeAttribute("align");}if(curObject.tagName.toLowerCase()=="table"){if(action=="left"){curObject.removeAttribute("align");}else{curObject.align=action;}}}}}if(sel.type=="CONTROL"){var activeObject=sel.getActiveObject();if(activeObject.tagName.toLowerCase()=="table"){activeObject.align=action;}}}else{if(action=="justify")action="full";execute("justify"+action);}}catch(Error){if(globalDebug)alert("__editJustify: "+Error);}onchangePINEDIT();};function ____editJustify(aHierarchy,action,sel){var hasP=false;for(var i=0;i<aHierarchy.length;i++){if(aHierarchy[i].tagName.toLowerCase()=="p"){if(action=="left"){__editRemoveStyleElement(aHierarchy[i],"textAlign","text-align");}else{aHierarchy[i].style.textAlign=action;}aHierarchy[i].removeAttribute("align");hasP=true;break;}}if(!hasP){execute("justify"+action);var parentObject=sel.getParent();var aHierarchy=__editGetTagHierarchy(parentObject,1);for(var i=0;i<aHierarchy.length;i++){if(aHierarchy[i].tagName.toLowerCase()=="p"){if(action=="left"){__editRemoveStyleElement(aHierarchy[i],"textAlign","text-align");}else{aHierarchy[i].style.textAlign=action;}aHierarchy[i].removeAttribute("align");if(globalBreakMode=="wp"){aHierarchy[i].style.marginTop=0;aHierarchy[i].style.marginBottom=0;}break;}}}};function editJustifyLeft(){__editJustify("left");};function editJustifyCenter(){__editJustify("center");};function editJustifyRight(){__editJustify("right");};function editJustifyFull(){__editJustify("justify");};function editLineSpacing(value){value=value+"pt";var sel=new Selection(getDoc());var aObjects=sel.getSelectedObjects(true);if(aObjects!=null){for(var i=0;i<aObjects.length;i++){if(aObjects[i].tagName.toLowerCase()=="p"){aObjects[i].style.lineHeight=value;}}}};function editOrderedList(type){try{__editOnChanged(true);var sel=new Selection(getDoc());var parent=sel.getParent();var aHierarchy=__editGetTagHierarchy(parent,1);for(var j=0;j<aHierarchy.length;j++){if(aHierarchy[j].tagName.toLowerCase()=="ol" || aHierarchy[j].tagName.toLowerCase()=="ul"){aHierarchy[j].style.listStyleType="";break;}}execute('InsertOrderedList');if(globalBreakMode=="wp"){var sel=new Selection(getDoc());var selectedObject=sel.getParent();var aHierarchy=__editGetTagHierarchy(selectedObject,1);for(var i=0;i<aHierarchy.length;i++){if(aHierarchy[i].tagName.toLowerCase()=="ol"){aHierarchy[i].style.marginTop=0;aHierarchy[i].style.marginBottom=0;break;}}}onchangePINEDIT();}catch(Error){}};function editUnorderedList(type){try{__editOnChanged(true);var sel=new Selection(getDoc());var parent=sel.getParent();var aHierarchy=__editGetTagHierarchy(parent,1);for(var j=0;j<aHierarchy.length;j++){if(aHierarchy[j].tagName.toLowerCase()=="ol" || aHierarchy[j].tagName.toLowerCase()=="ul"){aHierarchy[j].style.listStyleType="";break;}}execute('InsertUnorderedList');if(globalBreakMode=="wp"){var sel=new Selection(getDoc());var selectedObject=sel.getParent();var aHierarchy=__editGetTagHierarchy(selectedObject,1);for(var i=0;i<aHierarchy.length;i++){if(aHierarchy[i].tagName.toLowerCase()=="ul"){aHierarchy[i].style.marginTop=0;aHierarchy[i].style.marginBottom=0;break;}}}onchangePINEDIT();}catch(Error){}};function __editGetListObject(){};function editRemoveFormat(){editSetFocus();var doc=getDoc();var sel=new Selection(doc);if(sel.type=="NONE"){alert(getLanguageString("",4500));return;}var sel=new Selection(doc);var selectedObjects=sel.getSelectedObjects(true);var haveTable=false;for(var i=0;i<selectedObjects.length;i++){var curObject=selectedObjects[i];if(curObject.tagName.toLowerCase()=="table"){if(curObject.border==0){haveTable=true;}}curObject.removeAttribute("style");curObject.removeAttribute("className");curObject.removeAttribute("class");curObject.removeAttribute("align");curObject.removeAttribute("vAlign");curObject.removeAttribute("lang");if(curObject.tagName.toLowerCase()=="span"){__editReplaceSpanByText(curObject);}if(selectedObjects[i].tagName.toLowerCase()=="p" && globalBreakMode=="wp"){selectedObjects[i].style.marginTop=0;selectedObjects[i].style.marginBottom=0;}}execute('RemoveFormat');if(haveTable){editSetTableHighlight(true);}__editOnChanged(true);if(browser.ie){var margin=doc.body.style.marginLeft;doc.body.style.marginLeft=1;doc.body.style.marginLeft=margin;}};function __editSetFormatReplace(curNode){if(curNode.childNodes.length > 0){var frag=getDoc().createDocumentFragment();var childs=curNode.childNodes;for(var j=0;j<childs.length;j++){var newNode=childs[j].cloneNode(true);frag.appendChild(newNode);}if(browser.ie)curNode.replaceNode(frag);else curNode.parentNode.replaceChild(frag,curNode);}};function editWriteMode(mode){try{var obj=editGetActiveObject();if(obj.tagName.toLowerCase()!="body")obj.style.writingMode=mode;}catch(error){}};function editFormat(format){execute('FormatBlock',false,format);};function editParagraph(){execute('InsertParagraph');};function editUnselect(){execute('Unselect');};function editSetFocus(){getWindow().focus();};function editWrite(htmlin,status){var tmpStatus=status>0 ? status:0;if(htmlin=="")__editChanged=false;__editEditWriteCalled=true;__editStylesAvailable=false;if(tmpStatus==0)if(htmlin=="")__editInitStatus=4;else __editInitStatus=3;else __editInitStatus=tmpStatus;if(htmlin==""){if(globalBreakMode=="p"){htmlin="<p></p>";}else if(globalBreakMode=="wp"){htmlin="<p style='margin-top:0;margin-bottom:0'></p>";}else{if(!browser.ie){htmlin="<br id='_ph_'>";}}}htmlin=htmlin.replace(/###TEXTAREA###/gi,"</textarea>");var html=htmlin;if(browser.ie){var doc=getDoc();doc.open();doc.write(html);doc.close();__editRelativePrepare(true);}else{if(globalAutoFocus && globalForceFokus){__temp_moz_html=html;window.setTimeout("__moz_delay_focus()",200);return;}else{var doc=getDoc();try{if(!__editReadOnly)doc.designMode="on";}catch(Error){__temp_moz_html=html;window.setTimeout("__editMozResetModeEdit()",50);return;}doc.open();doc.write(html);doc.close();}}};function __moz_delay_focus(){var doc=getDoc();try{if(!__editReadOnly)doc.designMode="on";}catch(Error){window.setTimeout("__editMozResetModeEdit()",50);return;}doc.body.innerHTML=__temp_moz_html;editSetFocus();try{__editSetBodyBackground();}catch(Error){}};function editSetBodyHtml(html){var doc=getDoc();doc.body.innerHTML=html;__editShowSymbols();__editOnChanged(false);};function __editGetHtmlFromHTMLArea(){var docHtml=getDocHtml();var temp="";if(!browser.ie){try{temp=docHtml.body.innerHTML.replace(/<[^>]+>/g,"");temp=temp.replace(/&lt;/gi,"<");temp=temp.replace(/&gt;/gi,">");if(globalRemoveCRLF){temp=temp.replace(/\r/gi," ");temp=temp.replace(/\n/gi,"");}temp=temp.replace(/&nbsp;/gi,"");temp=temp.replace(/&amp;/gi,"&");}catch(Error){}}else{temp=docHtml.body.innerText;if(globalRemoveCRLF){temp=temp.replace(/\r/gi,"");temp=temp.replace(/\n/gi,"");}}return temp;};function editGetHtml(isBody,isRel){var html="";var bodyMode=isBody ? true:false;var relMode=isRel ? true:false;var doc=getDoc();if(__intisetemp)__editLave();if(editGetMode()=="HTML"){__editUpdateFromHTMLArea();}__editSetSpaceInTables(true);__editAddParagraphSpace();__editHideSymbols();__editRemoveMSMetaTag();if(browser.ie){doc.body.removeAttribute("contenteditable","",0);html=bodyMode ? doc.body.innerHTML : doc.documentElement.innerHTML;if(!__readOnly)doc.body.contentEditable=true;}else{doc.body.style.backgroundColor=null;if(doc.body.style.cssText=="")doc.body.removeAttribute("style");html=bodyMode ? doc.body.innerHTML : doc.documentElement.innerHTML;__editSetBodyBackground();}html=__editRemovePlaceHolder(html);if(relMode ||(globalImagePathRelative!="" || globalLinkPathRelative!=""))html=__editRelativeGetHtml(html);__editSetSpaceInTables(false);__editShowSymbols();__editSetPlaceHolders();if(globalConvertChar)html=__editConvertCode(html);return html;};function editGetHtmlRel(){return editGetHtml(false,true);};function editGetHtmlBody(){return editGetBodyHtml();};function editGetBodyHtml(){return editGetHtml(true,false);};function editGetHtmlBodyRel(){return editGetBodyHtmlRel();};function editGetBodyHtmlRel(){return editGetHtml(true,true);};function editGetText(){try{var doc=getDoc();if(browser.ie){var data=doc.body.innerText;document.getElementById('__editData').value=data;return data;}else{var text=doc.body.textContent;return text;}}catch(Error){}return "";};function editSetText(text){var doc=getDoc();if(browser.ie){doc.body.innerText=text;}else{text=text.replace(/</gi,"&lt;");text=text.replace(/>/gi,"&gt;");doc.body.innerHTML=text;}__editOnChanged(true);};function editInsertHtml(htmlin,notProcessRelative){var html="";if(!notProcessRelative)html=htmlin;else html=__editProcessRelative(htmlin);editSetFocus();var sel=new Selection(getDoc());sel.insertHtml(html);try{if(htmlin.toLowerCase().indexOf("table")>=0){editSetTableHighlight(true);}}catch(Error){};};function editInsertHtml2(html){try{var doc=getDoc();var range=doc.selection.createRange();if(range.text==""){range.text="|";range.moveStart("character",-1);range.select();}range.pasteHTML(html);}catch(Error){}};function editInsertText(text){editSetFocus();if(browser.ie){pasteText(text);}else{__MozillaInsertNodeAtSelection(getDoc().createTextNode(text));}editSetFocus();__editOnChanged(true);};function pasteHTML(html){try{var doc=getDoc();if(doc.selection.type.toLowerCase()!='none')doc.selection.clear();var range=doc.selection.createRange();range.pasteHTML(html);}catch(Error){};};function pasteText(text){try{if(editGetMode()=="HTML")var doc=getDocHtml();else var doc=getDoc();var range=doc.selection.createRange();range.text=text;__editOnChanged(true);}catch(Error){};};function executeSelection(command,value,ui){var doc=getDoc();var range=doc.selection.createRange();range.execCommand(command,ui,value);__editOnChanged(true);};function execute(command,ui,value){try{if(globalAutoFocus && command!="MultipleSelection")editSetFocus();if(!browser.ie && command=="print"){getWindow().print();return true;}if(command=="print")__editHideSymbols();var result=getDoc().execCommand(command,ui,value);if(command=="print")__editShowSymbols();if(command!="AbsolutePosition" && command!="2D-Position" && command!="MultipleSelection" && command!="copy")__editOnChanged(true);return result;}catch(Error){if(!browser.ie &&(command=='cut' || command=='copy' || command=='paste'))alert("'Cut','Copy' or 'Paste' functions are currently not available because of security reasons. Please goto http://mozilla.org/editor/midasdemo/securityprefs.html to find out how to enabled these functions.");return false;}};function editQuery(command){var doc=getDoc();try{var test=__editActiveObject.tagName;}catch(Error){__editActiveObject=getDoc().body;}var curTag=__editActiveObject.tagName.toUpperCase();try{if(browser.ie){var currentStyle=__editActiveObject.currentStyle;if(editGetSelectionType()=="CONTROL"){command=command.toUpperCase();if(command=="BOLD"){if(currentStyle.fontWeight=="bold" || currentStyle.fontWeight=="700")return true;else return false;}if(command=="ITALIC")return currentStyle.fontStyle=="italic" ? true:false;if(command=="UNDERLINE")return currentStyle.textDecoration=="underline" ? true:false;if(command=="STRIKETHROUGH")return currentStyle.textDecoration=="line-through" ? true:false;if(command=="SUPERSCRIPT")return curTag=="SUP" ? true:false;if(command=="SUBSCRIPT")return curTag=="SUB" ? true:false;if(command=="JUSTIFYLEFT")return currentStyle.textAlign=="left" ? true:false;if(command=="JUSTIFYCENTER")return currentStyle.textAlign=="center" ? true:false;if(command=="JUSTIFYRIGHT")return currentStyle.textAlign=="right" ? true:false;if(command=="JUSTIFYFULL")return currentStyle.textAlign=="justify" ? true:false;if(command=="INSERTORDEREDLIST"){if(curTag=="LI"){return __editActiveObject.parentNode.tagName.toUpperCase()=="OL" ? true:false;}}if(command.toUpperCase()=="INSERTUNORDEREDLIST"){if(curTag=="LI"){return __editActiveObject.parentNode.tagName.toUpperCase()=="UL" ? true:false;}}}var range=doc.selection.createRange();var result=range.queryCommandValue(command);command=command.toUpperCase();if(command=="JUSTIFYLEFT" || command=="JUSTIFYCENTER" || command=="JUSTIFYRIGHT" || command=="JUSTIFYFULL"){var value="";if(command=="JUSTIFYLEFT")value="left";if(command=="JUSTIFYCENTER")value="center";if(command=="JUSTIFYRIGHT")value="right";if(command=="JUSTIFYFULL")value="justify";if(!result){if(__editActiveObject.tagName.toLowerCase()!="p"){var aHierarchy=__editGetTagHierarchy(__editActiveObject,1);for(var i=0;i<aHierarchy.length;i++){if(aHierarchy[i].tagName.toLowerCase()=="p"){result=(aHierarchy[i].currentStyle.textAlign==value ? true: false);break;}}}else{result=(__editActiveObject.currentStyle.textAlign==value ? true: false);}}return result;}if(command=="FONTNAME"){if(currentStyle==null)return result;else return currentStyle.fontFamily;}if(command=="FONTSIZE"){if(currentStyle==null)fontSize=doc.body.currentStyle.fontSize;else fontSize=currentStyle.fontSize;if(!globalUseStyleFormatting){if(fontSize=="12pt"){if(result!=null){fontSize=result;fontSize=parseInt(fontSize);}else{fontSize=result=3;fontSize=parseInt(fontSize);}}else if(parseInt(fontSize)< 8){result=parseInt(fontSize);fontSize=parseInt(fontSize);}}if(result==fontSize){if(globalFontSizeType.toLowerCase()=="pt"){switch(result){case 1: fontSize=8;break;case 2: fontSize=10;break;case 3: fontSize=12;break;case 4: fontSize=14;break;case 5: fontSize=18;break;case 6: fontSize=24;break;case 7: fontSize=36;break;}}else{switch(result){case 1: fontSize=10;break;case 2: fontSize=12;break;case 3: fontSize=16;break;case 4: fontSize=18;break;case 5: fontSize=24;break;case 6: fontSize=32;break;case 7: fontSize=48;break;}}return fontSize+globalFontSizeType;}else{return fontSize;}}else{return result;}}else{var currentStyle=doc.defaultView.getComputedStyle(__editActiveObject,null);command=command.toUpperCase();if(command=="BOLD")return currentStyle.fontWeight=="bold" ? true:false;if(command=="ITALIC")return currentStyle.fontStyle=="italic" ? true:false;if(command=="UNDERLINE")return currentStyle.textDecoration=="underline" ? true:false;if(command=="STRIKETHROUGH")return currentStyle.textDecoration=="line-through" ? true:false;if(command=="SUPERSCRIPT")return curTag=="SUP" ? true:false;if(command=="SUBSCRIPT")return curTag=="SUB" ? true:false;if(command=="JUSTIFYLEFT")return currentStyle.textAlign=="left" ? true:false;if(command=="JUSTIFYCENTER")return currentStyle.textAlign=="center" ? true:false;if(command=="JUSTIFYRIGHT")return currentStyle.textAlign=="right" ? true:false;if(command=="JUSTIFYFULL")return currentStyle.textAlign=="justify" ? true:false;if(command=="INSERTORDEREDLIST"){if(curTag=="LI"){return __editActiveObject.parentNode.tagName.toUpperCase()=="OL" ? true:false;}}if(command=="INSERTUNORDEREDLIST"){if(curTag=="LI"){return __editActiveObject.parentNode.tagName.toUpperCase()=="UL" ? true:false;}}if(command=="FONTSIZE"){var fontSize=parseInt(currentStyle.getPropertyValue("font-size"));if(globalFontSizeType.toLowerCase()=="px"){return fontSize}else{fontSize=Math.round(fontSize*0.75237);}return fontSize;}if(command=="FONTNAME"){var fontName=currentStyle.getPropertyValue("font-family");if(fontName=="serif")fontName="Times New Roman";return fontName;}return doc.queryCommandValue(command);}}catch(Error){if(command.toUpperCase()=="FONTSIZE")return "12"+globalFontSizeType;else return false;}};function editInsertObject(obj){if(__editEditorStatus=="HTML")return;var doc=getDoc();var editorUrl=__editGetEditorUrl();var content='';var isSelected=editGetSelectionType()=="CONTROL" ? true: false;objSelected=editGetActiveObject();editSetFocus();if(obj=='DIV'){if(isSelected &&(objSelected.tagName.toLowerCase()=="div")){editProperties(5);return;}execute('2D-Position','',true);if(browser.ie){content="<div id='__tempOBJ' style='position:absolute;z-index:"+__zindex+";width:100;height:100;border: 1px dotted #d8d8d7;background-color: #F8F8F8'></div>";}else{content="<div id='__tempOBJ' style='position:absolute;z-index:"+__zindex+";width:100;height:100;border: 1px dotted #d8d8d7;background-color: #F8F8F8'>&nbsp;</div>";}__zindex++;editInsertHtml(content,false);var obj=doc.getElementById("__tempOBJ");obj.removeAttribute("id");editSetActiveObject(obj);editSelectObject(obj);__editOnChanged(true);return obj;}if(obj=='IMAGE'){execute('InsertImage',true);editRefresh(getDoc(),editGetMode());__editOnChanged(true);return;}if(obj=='IMAGEWEB'){if(browser.ie){var aParam=new Array();aParam[0]=language;aParam[1]=design;aParam[14]=__editLanguage;var url=window.showModalDialog(editorUrl+"dialogs/webimage.html",aParam,"dialogHeight:"+(140+globalDialogOffset)+"px;dialogWidth:400px;resizable:0;status:0;scroll:0");if(url!=""){__editOnChanged(true);return editCreateImage(url);}return null;}else{var left=screen.width/2-200;var top=screen.height/2-50;__editMozParam=new Array();__editMozParam[0]=language;__editMozParam[1]=design;__editMozParam[14]=__editLanguage;window.open(editorUrl+"dialogs/webimage.html","color","modal=1,left="+left+",top="+top+",height=100,width=400,resizable=0,status=0,scrollbars=0");return;}}if(obj=='RULE'){if(browser.ie){editInsertBlockHtml("<hr>");}else{execute('inserthorizontalrule');}__editOnChanged(true);return;}if(obj=='ANCHOR'){__editMozParam=new Array();__editMozParam[0]=language;__editMozParam[1]=design;__editMozParam[4]=getDoc();__editMozParam[14]=__editLanguage;var path="";if(globalUserMode=="0")path=editorUrl+"mode/html/dialogs/anchor.html";else path=editorUrl+"mode/wp/dialogs/anchor.html";if(browser.ie){var name=window.showModalDialog(path,__editMozParam,"dialogHeight:"+(140+globalDialogOffset)+"px;dialogWidth:400px;resizable:0;status:0;scroll:0");if(name!=""){editInsertHtml("<a name='"+name+"'></a>",false);__editShowSymbols();__editOnChanged(true);return;}else{return;}}else{var left=screen.width/2-400/2;var top=screen.height/2-100/2;window.open(path,"color","modal=1,left="+left+",top="+top+",height=100,width=400,resizable=0,status=0,scrollbars=0");return;}}if(obj=='PAGEBREAK'){if(editGetSelectionType()=="CONTROL")return;var doc=getDoc();var curObject=editGetActiveObject();var curTable=null;var curRow=null;var contentPB="<hr id='__PAGEBREAK__' contentEditable=false title='"+getLanguageString("",404)+"' style='height:2px;PAGE-BREAK-AFTER: always; border-top:1px dotted red;border-bottom:1px dotted red'>";if(browser.ie){try{var isInTable=false;var aHierarchy=__editGetTagHierarchy(curObject,1);for(var i=0;i<aHierarchy.length;i++){if(aHierarchy[i].tagName.toLowerCase()=="tr"){curRow=aHierarchy[i];}if(aHierarchy[i].tagName.toLowerCase()=="table"){isInTable=true;curTable=aHierarchy[i];}}var thead=null;if(isInTable){var newTable=curTable.cloneNode(true);var rowsToRemove=curTable.rows.length-curRow.rowIndex-1;for(var i=0;i<rowsToRemove;i++){var lastRow=curTable.rows[curTable.rows.length-1];lastRow.parentNode.removeChild(lastRow);}var firstRowIndex=0;var thead=curTable.getElementsByTagName("thead")[0];if(thead){firstRowIndex=thead.getElementsByTagName("tr").length;}else{var ths=curTable.getElementsByTagName("th");if(ths.length==0){firstRowIndex=0;}else{var k=1;var curIndex=0;var previousIndex=0;for(var j=0;j<ths.length;j++){curIndex=ths[j].parentNode.rowIndex;if(curIndex!=previousIndex){k++;}previousIndex=curIndex;}firstRowIndex=k;}}rowsToRemove=newTable.rows.length-firstRowIndex-rowsToRemove;for(var i=0;i<rowsToRemove;i++){var lastRow=newTable.rows[firstRowIndex];lastRow.parentNode.removeChild(lastRow);}var newPB=doc.createElement(contentPB);var curPB=null;if(curTable.nextSibling!=null){curPB=curTable.parentNode.insertBefore(newPB,curTable.nextSibling);}else{curPB=curTable.parentNode.appendChild(newPB);}if(curPB.nextSibling!=null){curPB.parentNode.insertBefore(newTable,curPB.nextSibling);}else{curPB.parentNode.appendChild(newTable);}}else{editInsertBlockHtml(contentPB);}}catch(Error){}}else{var contentPBFF="<hr id='__PAGEBREAK__' title='"+getLanguageString("",404)+"' style='height:2px;PAGE-BREAK-AFTER: always; border-top:1px dotted red;border-bottom:1px dotted red'>";editInsertHtml(contentPBFF);}__editOnChanged(true);return;}if(obj=='FORM'){if(((!browser.ie && objSelected)||(browser.ie && isSelected))&& objSelected.tagName.toLowerCase()=="form"){editProperties(9);return;}else{content="<form id='__tempOBJ' style='border-width: 1px;border-style:dotted;border-color:red'>&nbsp;</form>&nbsp;";}}if(obj=='BUTTON'){if(isSelected && objSelected.tagName.toLowerCase()=="input" && objSelected.type=="button"){editProperties(10);return;}content="<input id='__tempOBJ' type='button'>";}if(obj=='INPUT'){if(isSelected && objSelected.tagName.toLowerCase()=="input"){editProperties(10);return;}content="<input id=\"__tempOBJ\" type=\"text\">";}if(obj=='LISTBOX'){if(isSelected && objSelected.tagName.toLowerCase()=="select"){editProperties(11);return;}content="<select id='__tempOBJ' size=3></select>";}if(obj=='COMBO'){if(isSelected && objSelected.tagName.toLowerCase()=="select"){editProperties(11);return;}content="<select id='__tempOBJ'></select>";}if(obj=='CHECK'){if(isSelected && objSelected.tagName.toLowerCase()=="input" && objSelected.type=="checkbox"){editProperties(10);return;}content="<input id='__tempOBJ' type='checkbox'>";}if(obj=='OPTION'){if(isSelected && objSelected.tagName.toLowerCase()=="input" && objSelected.type=="radio"){editProperties(10);return;}content="<input id='__tempOBJ' type='radio'>";}if(obj=='AREA'){if(isSelected && objSelected.tagName.toLowerCase()=="textarea"){editProperties(13);return;}content="<textarea id='__tempOBJ'></textarea>";}if(obj=='IFRAME'){if(__NotSupportedByMozilla())return;execute('InsertIFrame');__editOnChanged(true);return;}if(obj=='MARQUEE'){if(__NotSupportedByMozilla())return;execute('InsertMarquee');__editOnChanged(true);return;}if(obj=='HIDDEN'){if(isSelected && objSelected.tagName.toLowerCase()=="input" && objSelected.type=="hidden"){editProperties(10);return;}content="<input id='__tempOBJ' type='hidden'>";}if(obj=='UPLOAD'){if(__NotSupportedByMozilla())return;execute('InsertInputFileUpload');__editOnChanged(true);return;}if(obj=='LABEL'){if(isSelected){editProperties(10);return;}else{content="<p id='__tempOBJ' style='z-index:"+__zindex+";padding-left: 3px;width:100px;height:25px;border: 1px solid #c0c0c0'>Text</p>";__zindex++;}}if(obj=='FLASH'){var aParam=new Array();aParam[0]=language;aParam[1]=design;var name=window.showModalDialog(editorUrl+"dialogs/flash.html?language="+language,aParam,"dialogHeight:120px;dialogWidth:400px;resizable:0;status:0;scroll:0");}editInsertHtml(content,false);var object=getDoc().getElementById("__tempOBJ");if(object!=null){object.removeAttribute("id");editSetActiveObject(object);editSelectObject(object);}__editOnChanged(true);return obj;};function setMode(mode){var html="";var isUpdate=false;if(__editLoading)return;if(mode==lastMode)return;try{toolbarsTop.reset();}catch(Error){}if(objMenuBar){var objMenu=objMenuBar.getActiveBarItem();if(objMenu)objMenu.reset();}var doc=getDocEdit();if(mode=="EDIT"){if(__editEnableExternalPreview.indexOf(".htm")> 0)document.getElementById('pinEditPreview').src=__editEnableExternalPreview;else document.getElementById('pinEditPreview').src="dummy.html";globalCurrentArea="EDIT";if(__editDefaultFont!="")doc.body.style.fontFamily=__editDefaultFont;if(__editDefaultFontSize!="")doc.body.style.fontSize=__editDefaultFontSize;try{toolbarstop.show();}catch(Error){};if(globalMenuVisible)editMenuVisible(true);if(globalHierarchyBarVisible)editSetHierachyBarVisible(true);if(globalAttributeAreaVisible)editSetAttributeAreaVisible(true);if(globalLeftAreaVisible)editSetLeftAreaVisible(true);var docHtml=document.getElementById('pinEditHtml').contentWindow.document;try{document.getElementById("pinEditHtml").style.display='none';document.getElementById("pinEditPreview").style.display='none';document.getElementById("editContainer").style.display='block';}catch(Error){}html=__editGetHtmlFromHTMLArea();if(browser.ie){if(__editContent!=html && __editHTMLAreaUsed){__editContent=html;__editChanged=true;var isOvertake=true;if(globalOptimizer){var iframe=null;if(!document.getElementById("__paste_frame")){iframe=document.createElement("IFRAME");document.body.appendChild(iframe);if(globalSupportHttps && browser.ie)iframe.src="dummy.html";iframe.id="__paste_frame";iframe.style.visibility="visible";iframe.style.position="absolute";iframe.style.left=-100;iframe.style.top=0;iframe.style.width=1;}else{iframe=document.getElementById("__paste_frame");}var pastedoc=iframe.contentWindow.document;pastedoc.open();pastedoc.write(html);pastedoc.close();if(__editCheckPasteCode(pastedoc.body)){if(eventOnRequireOptimization()){isOvertake=true;}else{if(!confirm(getLanguageString(language,1085))){isOvertake=false;}}}}if(isOvertake){__editUpdateFromHTMLArea();eventOnChanged();}}editSetFocus();}else{lastMode=mode;if(__editContent!=html){__editContent=html;__editChanged=true;html=__editRelativeHtml(html);if(globalHTMLMode=="1"){getDoc().body.innerHTML=html;}else{editWrite(html);}}else{try{document.getElementById("pinEdit").contentWindow.document.designMode="on";}catch(Error){__temp_moz_html=getDoc().documentElement.innerHTML;window.setTimeout("__editMozResetModeEdit()",50);return;}}__editSetBodyBackground();setTimeout("__editShowSymbols()",50);}__editEditorStatus="EDIT";__editSetPlaceHolders();__editSetSpaceInTables(false);__editShowSymbols();if(browser.ie)editRefresh(doc,"EDIT");if(globalSpellByType){setTimeout("editSpellByType()",500);}}if(mode=="HTML"){if(__editEnableExternalPreview.indexOf(".htm")> 0)document.getElementById('pinEditPreview').src=__editEnableExternalPreview;else document.getElementById('pinEditPreview').src="dummy.html";__editHTMLAreaUsed=true;__editHideSymbols();editHelpLineVisible(false);var docHtml=document.getElementById('pinEditHtml').contentWindow.document;if(browser.ie)docHtml.body.contentEditable=true;docHtml.body.style.fontFamily="Courier New";docHtml.body.style.fontSize="10pt";docHtml.body.style.backgroundColor="white";try{toolbarstop.hide();}catch(Error){};if(globalMenuVisible)editMenuVisible(false);if(globalHierarchyBarVisible)editSetHierachyBarVisible(false);if(globalAttributeAreaVisible)editSetAttributeAreaVisible(false);if(globalLeftAreaVisible)editSetLeftAreaVisible(false);document.getElementById("pinEditPreview").style.display='none';document.getElementById("editContainer").style.display='none';document.getElementById("pinEditHtml").style.display='block';try{if(!browser.ie &&!__editReadOnly)docHtml.designMode="on";}catch(error){window.setTimeout("__editMozResetModeHtml()",30);return;}__editSetSpaceInTables(false);__editUpdateHtmlArea();__editContent=__editGetHtmlFromHTMLArea();__editEditorStatus="HTML";if(browser.ie)editRefresh(docHtml,"HTML");if(globalTechnology=="desk"){document.getElementById('pinEditHtml').contentWindow.focus();}}if(mode=="PREVIEW"){globalCurrentArea="EDIT";__editAddParagraphSpace();__editSetSpaceInTables(true);__editHideSymbols();var docHtml=document.getElementById('pinEditHtml').contentWindow.document;var html=__editGetHtmlFromHTMLArea();if(browser.ie){if(__editContent!=html && __editHTMLAreaUsed){__editContent=html;__editChanged=true;__editUpdateFromHTMLArea();eventOnChanged();}}else{if(__editContent!=html){__editContent=html;__editChanged=true;html=__editRelativeHtml(html);var body=html.substring(html.indexOf("<body"));doc.body.innerHTML=body;}else{try{document.getElementById("pinEdit").contentWindow.document.designMode="on";}catch(Error){__temp_moz_html=getDoc().documentElement.innerHTML;window.setTimeout("__editMozResetModeEdit()",50);return;}}}doc.body.removeAttribute("contenteditable","",0);if(browser.ie)html=doc.documentElement.outerHTML;else html="<html>"+doc.documentElement.innerHTML+"</html>";html=__editRemovePlaceHolder(html);html=__editGetDocType()+html;if(__editEnableExternalPreview==""){editSetToolbarVisible("TOP",false);var docPreview=document.getElementById('pinEditPreview').contentWindow.document;docPreview.open();docPreview.write(html);docPreview.close();}else if(__editEnableExternalPreview.indexOf(".htm")> 0){if(__editHPPCheckDocument()){if(!confirm(getLanguageString("",1099))){editSetActiveMode(lastMode);return;}else{__editHPPPrepareDocument();if(browser.ie)html=doc.documentElement.outerHTML;else html="<html>"+doc.documentElement.innerHTML+"</html>";html=__editGetDocType()+html;html=__editRemovePlaceHolder(html);}}editSetToolbarVisible("TOP",false);var docPreview=document.getElementById('pinEditPreview').contentWindow.document;var code=__editHtmlPrintPreview();var container=docPreview.getElementById("container").contentWindow.document;container.open();container.write(code);container.close();}else{if(__editHPPCheckDocument()){if(!confirm(getLanguageString("",1099))){editSetActiveMode(lastMode);return;}else{__editHPPPrepareDocument();if(browser.ie)html=doc.documentElement.outerHTML;else html="<html>"+doc.documentElement.innerHTML+"</html>";html=__editGetDocType()+html;html=__editRemovePlaceHolder(html);}}editSetToolbarVisible("TOP",false);var tempHtml="";tempHtml+="<html>";tempHtml+="<body><p><span style='font-family:arial;font-size:11px'>"+getLanguageString("",1097)+"</span></p>";tempHtml+="<form name='frmComm' id='frmComm' method ='POST' action='"+__editEnableExternalPreview+"'>";tempHtml+="<input type='hidden' id='html' name='html'>";tempHtml+="</form>";tempHtml+="</body>";tempHtml+="</html>";var docPreview=document.getElementById('pinEditPreview').contentWindow.document;docPreview.open();docPreview.write(tempHtml);docPreview.close();docPreview.getElementById("html").value=html;docPreview.getElementById("frmComm").submit();}doc.body.contentEditable=true;if(globalMenuVisible)editMenuVisible(false);if(globalHierarchyBarVisible)editSetHierachyBarVisible(false);if(globalAttributeAreaVisible)editSetAttributeAreaVisible(false);if(globalLeftAreaVisible)editSetLeftAreaVisible(false);try{toolbarstop.hide();}catch(Error){};document.getElementById("editContainer").style.display='none';document.getElementById("pinEditHtml").style.display='none';document.getElementById("pinEditPreview").style.display='block';if(browser.ie){if(__editEnableExternalPreview=="")editRefresh(docPreview,"PREVIEW");}__editEditorStatus="PREVIEW";}lastMode=mode;};function __editUpdateFromHTMLArea(){var html=__editGetHtmlFromHTMLArea();var doc=getDoc();if(browser.ie){html=__editRelativeHtml(html);if(globalHTMLMode=="1"){doc.body.innerHTML=html;}if(globalHTMLMode=="2"){editWrite(html,5);}}else{}};function __editUpdateHtmlArea(){var html="";var docHtml=document.getElementById('pinEditHtml').contentWindow.document;if(globalHTMLMode=="1"){if(globalHTMLModeExtended){html=editGetHtmlFormatted(globalHTMLMode);html=__editRemovePlaceHolder(html);docHtml.body.innerHTML=html;}else{html=editGetHtmlBody();html=__editRemovePlaceHolder(html);if(browser.ie){docHtml.body.innerText=html;}else{html=html.replace(/</gi,"&lt;");html=html.replace(/>/gi,"&gt;");docHtml.body.innerHTML=html;}}}if(globalHTMLMode=="2"){if(globalHTMLModeExtended){html=editGetHtmlFormatted(globalHTMLMode);html=__editRemovePlaceHolder(html);docHtml.body.innerHTML=html;}else{html=editGetHtml();html=__editRemovePlaceHolder(html);if(browser.ie){docHtml.body.innerText=html;}else{html=html.replace(/</gi,"&lt;");html=html.replace(/>/gi,"&gt;");docHtml.body.innerHTML=html;}}}};function __editMozResetModeEdit(){try{var html=__temp_moz_html;var iframe=getDoc().createElement("iframe");iframe.id="pinEdit";iframe.name="pinEdit";iframe.frameBorder=0;iframe.width="100%";iframe.height="100%";iframe.style.width="100%";iframe.style.height="100%";document.getElementById('pinEdit').parentNode.replaceChild(iframe,document.getElementById('pinEdit'));var doc=getDoc();if(!__editReadOnly){doc.designMode="on";}doc.open();doc.write(html);doc.close();__editInitEvents();__editSetBodyBackground();__editShowSymbols();}catch(Error){}};function __editMozResetModeHtml(){var docPreview=document.getElementById('pinEditPreview').contentWindow.document;var docHtml=document.getElementById('pinEditHtml').contentWindow.document;docPreview.open();docPreview.write(getDoc().documentElement.innerHTML);docPreview.close();if(!browser.ie &&!__editReadOnly)docHtml.designMode="on";__editUpdateHtmlArea();};function __editHidePopup(){if(browser.ie)popup.hide();else popup.style.visibility="hidden";};function __editRemoveNode(node){try{if(node){if(browser.ie)node.removeNode(true);else node.parentNode.removeChild(node);}}catch(error){}};function __editRemoveAnchor(){try{var selection=new Selection(getDoc());var anchor=selection.getActiveObject("a");if(anchor){__editRemoveNode(anchor);__editOnChanged(true);}}catch(Error){};__editHidePopup();};function __editRemoveForm(){try{var selection=new Selection(getDoc());var form=selection.getActiveObject("form");if(form){__editRemoveNode(form);__editOnChanged(true);}}catch(Error){};__editHidePopup();};var __temp_EditOnContextMenuItemClickMode="";function __editOnContextMenuItemClick(id){if(!browser.ie)popup.style.visibility="hidden";var item=__editContextMenu.getItemById(id);if(__temp_EditOnContextMenuItemClickMode=="SPELL"){__temp_EditOnContextMenuItemClickMode="";onContextSpellMenuItemClick(item.value,item.tag1);}else{onContextMenuItemClick(item.value,item.tag1);}};function __editCheckTag(tagName){if(tagName=="STRONG" || tagName=="FONT" || tagName=="EM" || tagName=="U" || tagName=="SUB" || tagName=="SUP")return true;else return false;};function editPopup(evt){var source=null;if(__editReadOnly)return;try{if(browser.ie){source=evt.srcElement;}else{source=evt.target;}if(globalVerifyKeyWhenNotEditable && browser.ie){if(editIsTagNotEditable(source))return;}if(source.tagName.toLowerCase()=="img"){var temp=source.src.toLowerCase();if(temp.indexOf("anchor")>=0 && source.id.indexOf("anchor")>=0)source=source.parentNode;}var mode="";var isCell=false;var path="";var aHierarchy=null;var selection=null;if(source.id=="__PAGEBREAK__"){return;}if(source.id.substring(0,5)=="pes__"){mode="SPELL";__temp_EditOnContextMenuItemClickMode=mode;}else{aHierarchy=__editGetTagHierarchy(source,1);selection=new Selection(getDoc());}if(browser.ie){var objPopup=window.createPopup();popup=objPopup;}else{var doc=window.parent.document;if(!browser.ie &&!browser.safari){if(doc.getElementById("__MozPopup")){var node=doc.getElementById("__MozPopup");node.parentNode.removeChild(node);}}if(doc.getElementById("__MozPopup")){var objPopup=doc.getElementById("__MozPopup");}else{var objPopup=doc.createElement("iframe");objPopup.id="__MozPopup";objPopup.style.position="absolute";objPopup.style.visibility="hidden";objPopup.style.width="200px";objPopup.style.zIndex=10000;objPopup.frameBorder=0;doc.body.appendChild(objPopup);}popup=objPopup;}__editContextMenu=new Menu("");__editContextMenu.design=design;__editContextMenu.dynamicWidth=false;if(browser.ie)__editContextMenu.callbackInternal="__editOnContextMenuItemClick";else __editContextMenu.callbackInternal="window.parent.document.getElementById('"+window.frameElement.id+"').contentWindow.__editOnContextMenuItemClick";__editContextMenu.isPopupMode=true;if(mode=="SPELL"){CreateSpellContextMenu(__editContextMenu,source);}else{CreateContextMenu(__editContextMenu,source,aHierarchy,selection,evt.clientX,evt.clientY);}if(__editContextMenu.count()==0)return;if(source.contenteditable=="false"){if(__editContextMenu.count()> 0)__editContextMenu.add(new MenuSeparator());__editContextMenu.add(new MenuItem(getLanguageString(language,3100),"editor/design/image/edit.gif","","EDITABLE"));}var temp="";temp+="<html><head><link rel='stylesheet' href='"+__editGetEditorUrl()+"menu/design/style/pinMenu.css' type='text/css'><script>";temp+="function onClick(table, row, design, func){ ";if(browser.ie)temp+="eval('parent.' + func + '(' + row + ')');};";else temp+="eval(func + '(' + row + ')');};";temp+="function onOver(table,row,design) { ";temp+="table.className = 'MenuItemHover' + design;";temp+=" table.cellPadding = 1;";temp+="document.getElementById(row + '.2').className = 'MenuItemHoverText' + design;};";temp+="function onOut(table,row,design) { ";temp+="table.className = 'MenuItem' + design;";temp+=" table.cellPadding = 2;";temp+="document.getElementById(row + '.2').className  = 'MenuItemFont' + design;};";temp+="</script></head><body oncontextmenu='javascript: return false;' style='background-color: white; border: 1px outset; margin:0;overflow:hidden'>";temp+="</body></html>";if(browser.ie){objPopup.document.open();objPopup.document.write(temp);objPopup.document.close();__editContextMenu.createInObject(objPopup.document.body);objPopup.show(evt.clientX,evt.clientY,globalPopupWidth,__editContextMenu.height,getEdit());}else{var doc=objPopup.contentWindow.document;doc.open();doc.write(temp);doc.close();objPopup.addEventListener("load",__temp_Moz_Popup_Delay,false);__temp_Moz_Context=__editContextMenu;var frame=window.parent.document.getElementById(window.frameElement.id);var frameLeft=__editGetIframePositionX(frame);var frameTop=__editGetIframePositionY(frame);var frame=document.getElementById("pinEdit");frameLeft=frameLeft+__editGetIframePositionX(frame);frameTop=frameTop+__editGetIframePositionY(frame);objPopup.style.left=frameLeft+evt.layerX+"px";__temp_Moz_Context_top=frameTop+evt.layerY-getWindow().pageYOffset;}}catch(Error){}return false;};var __temp_Moz_Context=null;var __temp_Moz_Context_top=0;function __temp_Moz_Popup_Delay(){try{var objPopup=window.parent.document.getElementById("__MozPopup");var doc=objPopup.contentWindow.document;objPopup.style.height="500px";__temp_Moz_Context.createInObject(doc.body);var height=parseInt(__temp_Moz_Context.height);if(height < 5){height=100;}height=(parseInt(height)+(browser.safari ? 5:2));objPopup.style.height=height+"px";if(__temp_Moz_Context_top+height > window.parent.innerHeight){objPopup.style.top=window.parent.innerHeight-height+"px";}else{objPopup.style.top=__temp_Moz_Context_top+"px";}objPopup.style.visibility="visible";}catch(Error){}};function editSetBr(value){if(value)globalBreakMode=value;try{if(btnReturnMode){if(globalBreakMode=="br"){btnReturnMode.setImage("toolbar/design/image/"+__editGetDesign(design)+"/bron.gif");}if(globalBreakMode=="p"){btnReturnMode.setImage("toolbar/design/image/"+__editGetDesign(design)+"/broff.gif");}if(globalBreakMode=="wp"){btnReturnMode.setImage("toolbar/design/image/"+__editGetDesign(design)+"/div.gif");}}}catch(Error){};};function __editSetFocusStatus(value){if(browser.ie){try{if(!value){eventOnLostFocus();}else{eventOnGotFocus();__editFocusTime=new Date().getTime();}}catch(Error){}}};function editGetBr(){return globalBreakMode;};var sb=null;function editGetHtmlFormatted(mode){var doc=getDoc();__edit_tmp_first_formatProcessNode=true;if(!browser.ie){doc.body.style.backgroundColor=null;if(doc.body.style.cssText=="")doc.body.removeAttribute("style");}var head=doc.getElementsByTagName("head")[0];if(head){if(head.firstChild==null){var title=doc.createElement("title");head.appendChild(title);}}sb=new MakeString();if(mode=="1")var childs=getDoc().body.childNodes;if(mode=="2"){__editRemoveMSMetaTag();var childs=getDoc().childNodes;}for(var i=0;i<childs.length;i++){__formatProcessNode(childs[i],0,true);}var data="";data=data+sb.get();if(!globalHTMLAreaWrapLine)data="<div nowrap>"+data+"</div>";var end=new Date().getTime();__editSetBodyBackground();return data;};function __getIndent(level){var result="";for(var i=0;i < level;i++){result+="&nbsp;&nbsp;";}return result;};__edit_tmp_first_formatProcessNode=true;function __formatProcessNode(node,level,prettyFormat){var cr="<br>";var curIndent=__getIndent(level);switch(node.nodeType){case 1: if(node.nodeName=="!"){sb.add(node.text);break;}var name=node.nodeName;var tagColor=__editfontTag;if(node.nodeName==""){name="unknown";tagColor="<FONT color='#00ff00'>";}if(browser.ie){if(node.scopeName=="HTML"){name=name.toLowerCase();}else{name=node.scopeName+":"+name;}}else{name=name.toLowerCase();}var showTag=true;if(name=="tbody" &&!globalShowTBodyTag){showTag=false;}if(!browser.ie && name=="br"){if(node.id=="_ph_"){showTag=false;}}if(showTag){if(!__edit_tmp_first_formatProcessNode)__addCR(name);__edit_tmp_first_formatProcessNode=false;if(globalPrettyFormat)sb.add(curIndent);sb.add(__editopenTag+tagColor+name+__editfontClose);var attributes=node.attributes;var len=attributes.length;var tagName=node.tagName.toLowerCase();if(tagName!="option" && tagName!="br"){for(var j=0;j<len;j++){var attributeNode=attributes[j];var attribName=attributeNode.nodeName.toLowerCase();if(tagName=="body" && attribName=="contenteditable"){}else{var attribValue=null;if(tagName=="input" && node.type.toLowerCase()=="image"){}else{try{attribValue=node.getAttribute(attribName);}catch(Error){attribValue=attributeNode.nodeValue;}}if(!browser.ie && attribName.indexOf("_moz")>=0){a=1;}else{if(attributeNode.specified){if(!browser.ie && tagName=="input" && attribName=="type"){if((node.type=="checkbox" || node.type=="radio")&& node.checked)sb.add(" "+__editfontAttribute+"checked"+__editfontClose+"=\""+__editfontStyle+(attribValue ? "checked":"")+__editfontClose+"\"");if(node.type=="text" && node.value!="")sb.add(" "+__editfontAttribute+"value"+__editfontClose+"=\""+__editfontStyle+node.value+__editfontClose+"\"");}if(tagName=="input" && attribName=="checked"){sb.add(" "+__editfontAttribute+"checked"+__editfontClose+"=\""+__editfontStyle+(attribValue ? "checked":"")+__editfontClose+"\"");}else{__formatGetAttributes(attributeNode,node);}}else{switch(tagName){case "input": if(attribName=="value" || attribName=="type" || attribName=="name")__formatGetAttributes(attributeNode,node);break;case "img": if(attribName=="vspace" && attribValue!="0")__formatGetAttributes(attributeNode,node);break;case "area": if(attribName=="coords" || attribName=="shape")__formatGetAttributes(attributeNode,node);break;default: break;}if(attribValue!=null)switch(attribName){case "onload": __formatGetAttributes(attributeNode,node);break;case "onmouseup","onmousedown","onkeypress","onkeyup","onkeydown","onmouseout","onmouseover","onmousemove","ondblclick","onchange","onselect","onclick": __formatGetAttributes(attributeNode,node);default: break;}}}}}}else if(tagName=="br"){}else{try{var value=node.getAttribute("value");sb.add(" "+__editfontAttribute+"value"+__editfontClose+"=\""+__formatCheckAttribute(value)+"\"");value=node.getAttribute("selected");if(value)sb.add(" "+__editfontAttribute+"selected"+__editfontClose);}catch(Error){}}}var canHaveChildren=false;if(browser.ie)if(name=="iframe")canHaveChildren=true;else canHaveChildren=node.canHaveChildren;else canHaveChildren=(name=="input" || name=="br" || name=="link" || name=="meta")? false:true;if(showTag){if(canHaveChildren || node.hasChildNodes()){if(name=="tbody" &&!globalShowTBodyTag){level=level-1;}else{sb.add(__editcloseTag);}var childs=node.childNodes;len=childs.length;for(var j=0;j<len;j++){__formatProcessNode(childs[j],level+1,prettyFormat);}if(name=="tbody" &&!globalShowTBodyTag){}else{__addCR(name);if(globalPrettyFormat)sb.add(curIndent);sb.add(__editopenTag+"/"+tagColor+name+__editfontClose+__editcloseTag);}}else if(name=="script"){sb.add(__editcloseTag+__processScript(node.text,level)+curIndent+__editopenTag+"/"+tagColor+name+__editfontClose+__editcloseTag);__addCR(name);}else if(name=="style"){sb.add(__editcloseTag+__processScript(node.innerHTML,level)+cr+__editopenTag+"/"+tagColor+name+__editfontClose+__editcloseTag);}else if(name=="title" || name=="comment"){sb.add(__editcloseTag+node.innerHTML+__editopenTag+"/"+tagColor+name+__editfontClose+__editcloseTag);}else{sb.add(__editcloseTagWithSlash);}}break;case 3: var value=node.nodeValue ? node.nodeValue : "";if(!browser.ie){if(value.charCodeAt(0)==10){if(value.length==1)value="";else value=value.substring(1);}}else{if(value.length==1 && value.charCodeAt(0)==32)value="";}if(browser.ie)value=editReplaceSpecialChar(value,true);if(value!=""){if(!__edit_tmp_first_formatProcessNode)__addCR(name);if(globalPrettyFormat)sb.add(__getIndent(level));sb.add(_checkText(value));}break;case 4: sb.add("<![CDA"+"TA[\n"+node.nodeValue+"\n]"+"]>");break;case 8: var temp="";if(browser.ie){temp=node.text;}else{temp="<!-- "+node.nodeValue+" -->";}temp=temp.replace(/\&/g,"&amp;");temp=temp.replace(/</gi,"&lt;");temp=temp.replace(/>/gi,"&gt;");temp=temp.replace(/\t/gi,"&nbsp;&nbsp;");sb.add(temp);__addCR("");break;case 9: var childs=node.childNodes;len=childs.length;for(var j=0;j<len;j++)__formatProcessNode(childs[j],level,prettyFormat);break;default: sb.add("<!-- Not found:"+"nodeName: "+node.nodeName+"-->");}__edit_tmp_first_formatProcessNode=false;};function _checkText(s){var temp=s;temp=temp.replace(/</g,"&lt;");temp=temp.replace(/>/g,"&gt;");return temp;};function __addCR(name){var cr="<br>";if(globalPrettyFormat){sb.add(cr);return;}if(name=="html" || name=="body" || name=="title" || name=="table" || name=="head" || name=="tr" || name=="tbody" || name=="meta" || name=="style"){sb.add(cr);}};function __processScript(text,level){var space=__getIndent(level);text=text.replace(/\n/gi,"");text=text.replace(/\&/g,"&amp;");text=text.replace(/</g,"&lt;");text=text.replace(/>/g,"&gt;");text=text.replace(/\t/gi,"&nbsp;&nbsp;");var aLines=text.split("\r");text="";if(aLines.length==1){text=aLines[0];}else{for(var i=0;i<aLines.length;i++){var line=aLines[i];text=text+space+line+"\r";}text=text.replace(/\r/gi,"<br>");}return text;};function __formatGetAttributes(attributeNode,node){var tagName=node.tagName.toLowerCase();var attribName=attributeNode.nodeName.toLowerCase();var name=attributeNode.nodeName;var value=null;try{if(name=="class" || name=="http-equiv" || name=="type")value=attributeNode.nodeValue;else value=node.getAttribute(name);}catch(Error){value=attributeNode.nodeValue;}value=String(value);if(value.indexOf("function anonymous")>=0){value="javascript:"+value.substring(22,value.length-1);}if((tagName=="img" && name.toLowerCase()=="id")||(tagName=="a" && name.toLowerCase()=="id")||(tagName=="link" && name.toLowerCase()=="id")||(tagName=="embed" && name.toLowerCase()=="id")||(tagName=="area" && name.toLowerCase()=="id")){if(value.substring(0,2)=="D#"){return;}else if(value.substring(0,2)=="I#"){value=value.split(__editRelSeparator);value=value[1];}}if((tagName=="img" && name.toLowerCase()=="src")||(tagName=="a" && name.toLowerCase()=="href")||(tagName=="link" && name.toLowerCase()=="href")||(tagName=="embed" && name.toLowerCase()=="src")||(tagName=="area" && name.toLowerCase()=="href")){var id=node.id;if(id.substring(0,2)=="D#"){value=id.substring(2);}else if(id.substring(0,2)=="I#"){id=id.split(__editRelSeparator);value=id[2];}}if(name!="style"){sb.add(" "+__editfontAttribute+(attributeNode.expando ? name : name.toLowerCase())+__editfontClose+"=\""+__formatCheckAttribute(value)+"\"");}else{if(node.style.cssText.toUpperCase()!="FONT-FAMILY: "){var css=node.style.cssText.toLowerCase();if(css.indexOf("rgb")>=0){var startPos=0;var newCSS=css;while(newCSS.indexOf("rgb",startPos)>=0){startPos=newCSS.indexOf("rgb");var endPos=newCSS.indexOf(")",startPos);var color=newCSS.substring(startPos,endPos+1);var hex=rgbToHex(color);newCSS=newCSS.substring(0,startPos)+hex+newCSS.substring(endPos+1);}css=newCSS;}sb.add(" "+__editfontAttribute+"style"+__editfontClose+"=\""+__formatCheckAttribute(css)+"\"");}}};function __formatCheckAttribute(s){return __editfontStyle+String(s).replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/\"/g, "&quot;")+__editfontClose;};function editSetActiveMode(mode){var btnEdit=null;var btnHTML=null;var btnPreview=null;try{if(toolbarsBottom==null){return;}btnEdit=toolbarsBottom.getElementByTag("EDIT");btnHTML=toolbarsBottom.getElementByTag("HTML");btnPreview=toolbarsBottom.getElementByTag("PREVIEW");if(mode=="EDIT"){if(btnEdit)btnEdit.setStatus(true);if(btnHTML)btnHTML.setStatus(false);if(btnPreview)btnPreview.setStatus(false);}if(mode=="HTML"){if(btnEdit)btnEdit.setStatus(false);if(btnHTML)btnHTML.setStatus(true);if(btnPreview)btnPreview.setStatus(false);}if(mode=="PREVIEW"){if(btnEdit)btnEdit.setStatus(false);if(btnHTML)btnHTML.setStatus(false);if(btnPreview)btnPreview.setStatus(true);}}catch(Error){};};var __editIsEvaluation=true;function editGetFocus(){return __editFocusTime;};function editWriteBody(htmlin){var html=__editProcessRelative(htmlin);editSetBodyHtml(html);__editOnChanged(true);};function editReplaceSpecialChar(value,isArea){for(var i=0;i<__editSpecialChar1.length;i++){var re=new RegExp(__editSpecialChar1[i],"g");var rep=__editSpecialChar2[i];if(isArea)rep=rep.replace(/\&/gi,"&amp;");value=value.replace(re,rep);}return value;};function editAddSpecialCharReplacement(from,to){try{var len=__editSpecialChar1.length;__editSpecialChar1[len]=from;__editSpecialChar2[len]=to;}catch(Error){}};function editSetCursorHome(doc){if(!browser.ie)return;try{if(!doc)doc=getDoc();var rng=doc.body.createTextRange();rng.moveEnd("textedit",-1);rng.select();}catch(Error){}};function editSetCursorEnd(doc){if(!browser.ie)return;try{if(!doc)doc=getDoc();var rng=doc.body.createTextRange();rng.moveStart("textedit",1);rng.select();}catch(Error){}};function editCreateLink(url,target,title,inText,inMisc,inId,inTrail){url=url.replace(/ /gi,"%20");absurl=__editRelativeGetAbsUrl(url,"LINK");misc=inMisc ? inMisc : "";inText=inText ? inText : "";inId=inId ? inId : "";inTrail=(inTrail==null || inTrail=="")? false:true;if(browser.ie){var doc=getDoc();var sel=new Selection(doc);var range=sel.getRange();var selType=sel.type;if(selType!="CONTROL"){if(inText!=""){text=inText;}else{var text=sel.getSelectedHtml();if(text.toLowerCase().indexOf("<a")>=0){alert(getLanguageString(language,3330));return;}text=text.replace(/\r/gi,"");text=text.replace(/\n/gi,"");if(text.substring(0,1)==" ")text="&nbsp;"+text.substring(1);if(text.substring(text.length-1,text.length)==" ")text=text.substring(0,text.length-1)+"&nbsp;";}if(text.toLowerCase().indexOf("<p")< 0){sel.insertHtml("<a "+misc+" id='__temp_link' href=''>"+text+"</a>");var newLink=doc.getElementById("__temp_link");newLink.href=absurl;if(target!="")newLink.target=target;if(title!="")newLink.title=title;if(globalLinkPathRelative==""){if(inId=="")newLink.removeAttribute("id","",0);else newLink.id=inId;}else{newLink.id=inId;__editRelativeSetUrl(newLink,url);}}else{var aObjects=__editGetSelectedObjects(true);var aP=new Array();for(var i=0;i<aObjects.length;i++){if(aObjects[i].tagName.toLowerCase()=="p"){aP[aP.length]=aObjects[i];}}aObjects=__editPrepareSelection();for(var i=0;i<aObjects.length;i++){if(aObjects[i].tagName.toLowerCase()=="span"){var newLink=doc.createElement("a");if(aObjects[i].style.cssText==""){newLink.innerHTML=aObjects[i].innerHTML;aObjects[i].replaceNode(newLink);}else{newLink.appendChild(aObjects[i].cloneNode(true));aObjects[i].replaceNode(newLink);}newLink.href=absurl;if(target!="")newLink.target=target;if(title!="")newLink.title=title;if(globalLinkPathRelative==""){if(inId=="")newLink.removeAttribute("id","",0);else newLink.id=inId;}else{newLink.id=inId;__editRelativeSetUrl(newLink,url);}}}for(var i=0;i<aP.length;i++){var child=aP[i].childNodes[0];var linkNodes=new Array();do{if(child.nodeType=="1"){if(child.tagName.toLowerCase()=="a"){linkNodes[linkNodes.length]=child;}else{break;}}child=child.nextSibling;}while(child);html="";for(var j=0;j<linkNodes.length;j++){html+=linkNodes[j].innerHTML;if(j<linkNodes.length-1){__editRemoveNode(linkNodes[j]);}}linkNodes[linkNodes.length-1].innerHTML=html;}}__editOnChanged(true);return null;}else{var newNode=doc.createElement("a");range(0).replaceNode(newNode);newNode.href=absurl;newNode.target=target;newNode.title=title;newNode.innerHTML=range(0).outerHTML;if(globalLinkPathRelative=="")newNode.removeAttribute("id","",0);else newNode.id="D#"+url;__editOnChanged(true);return newNode;}}else{editSetFocus();if(inText!="")var html=inText;else var html=editGetSelectedHtml();var linkCode="";if(globalLinkPathRelative==""){linkCode="<a "+misc+" href='"+url+"' ";if(inId!="")linkCode+=" id='"+inId+"' ";}else{if(inId=="")linkCode="<a "+misc+" id='D#"+url+"' href='"+absurl+"' ";else linkCode="<a "+misc+" id='I#"+__editRelSeparator+inId+__editRelSeparator+url+"' href='"+absurl+"' ";}if(target!="")linkCode+=" target='"+target+"' ";if(title!="")linkCode+=" title='"+title+"' ";linkCode+=">"+html+"</a>";editInsertHtml(linkCode);}__editOnChanged(true);};function editSetUserCode(code){__editToolbarCode=code;};function editGetUserCode(){return __editToolbarCode;};function editSetReadOnlyStatus(value){__editReadOnly=value;};function editSetHierachyBarVisible(value){try{document.getElementById("hierarchyBar").style.display=value ? "inline":"none";}catch(Error){}};function editSetAttributeAreaVisible(value){try{document.getElementById("windowRight").style.display=value ? "inline":"none";}catch(Error){}};function editSetLeftAreaVisible(value){try{}catch(Error){}};function __editPrepareParams(){var editorUrl=__editGetEditorUrl();var baseUrl="";var basePath="";if(globalImageUrlAbsolute==""){baseUrl=__editGetEditorWeb()+globalImageDir+"/";basePath=globalRootPath!="" ?(globalRootPath+globalImageDir+"/"): "";}else{baseUrl=globalImageUrlAbsolute;basePath=globalImagePathAbsolute;}var baseUrl2="";var basePath2="";if(globalDocumentUrlAbsolute==""){baseUrl2=__editGetEditorWeb()+globalDocDir+"/";basePath2=globalRootPath!="" ?(globalRootPath+globalDocDir+"/"): "";}else{baseUrl2=globalDocumentUrlAbsolute;basePath2=globalDocumentPathAbsolute;}__editMozParam=new Array();__editMozParam[0]=language;__editMozParam[1]=design;__editMozParam[2]="";__editMozParam[3]="";__editMozParam[4]=getDoc();__editMozParam[5]="";__editMozParam[6]=baseUrl;__editMozParam[7]=basePath;__editMozParam[8]=globalTechnology;__editMozParam[9]=globalDialogFilterImage;__editMozParam[10]=globalImagePathRelative;__editMozParam[11]=window;__editMozParam[12]=__editStyles;__editMozParam[13]=globalTabDesign;__editMozParam[14]=__editLanguage;__editMozParam[15]="0";__editMozParam[16]=baseUrl2;__editMozParam[17]=basePath2;__editMozParam[18]=globalDialogUrlButton;__editMozParam[19]="";__editMozParam[20]="";__editMozParam[21]=globalUserMode;__editMozParam[22]="";__editMozParam[23]=globalHighlightColor;__editMozParam[24]=globalXHtmlType;__editMozParam[25]=__editNoEdit;__editMozParam[26]=globalUploadImageFileTypes;__editMozParam[27]=globalUploadDocumentFileTypes;__editMozParam[28]=globalRelativeImageRoot;__editMozParam[29]=__editUploadMode;__editMozParam[30]=globalUploadMaxFileSize;__editMozParam[31]=globalDebug;__editMozParam[32]=globalFontSizeType;};function editSetToolbarHeight(type,height){try{if(type=="TOP")document.getElementById("toolbar_top").style.height=height;if(type=="BOTTOM")document.getElementById("toolbar_bottom").style.height=height;}catch(Error){}};function editSetToolbarVisible(type,value){try{if(type=="TOP"){if(value)document.getElementById("toolbar_top").style.display="inline";else document.getElementById("toolbar_top").style.display="none";}if(type=="BOTTOM"){if(value)document.getElementById("toolbar_bottom").style.display="inline";else document.getElementById("toolbar_bottom").style.display="none";}}catch(Error){}};function editGetToolbar(type){if(type=="TOP")return toolbarsTop;if(type=="BOTTOM")return toolbarsBottom;if(type=="LEFT")return toolbarsLeft;return null;};var __intisetemp=true;function __editGetLanguage(){return __editLanguage;};function __editConvertCode(text){var temp="";if(text==null)return "";var hasChar=false;for(var i=0;i<text.length;i++){var c=text.charCodeAt(i);if(c > 128){hasChar=true;break;}}if(!hasChar)return text;var i=0;var last=0;var len=text.length;for(var i=0;i<text.length;i++){var c=text.charCodeAt(i);if(c > 128){temp+=text.substring(last,i)+"&#"+c+";";last=i+1;}}temp+=text.substring(last);return temp;};function editGetSelectionType(){try{if(browser.ie){return getDoc().selection.type.toUpperCase();}else{var seltype="";var selection=getWindow().getSelection();if(selection!=""){seltype="TEXT";}else{var range=selection.getRangeAt(selection.rangeCount-1);if(selection.rangeCount==1)if(range.startContainer==range.endContainer){if((range.endOffset-range.startOffset)==1){seltype="CONTROL";}else{seltype="NONE";}}else{seltype="NONE";}}return seltype;}}catch(Error){return "NONE";}};var __editPrepareSelectionIndex=0;function __editPrepareSelectionChild(node,aText,range){var doc=getDoc();var text=node.nodeValue;var inRange=doc.body.createTextRange();inRange.moveToElementText(node);if(range.inRange(inRange)){alert("Fragment: "+text);}else if(range.isEqual(inRange)){alert("Full: "+text);}else{alert("Not in range");}};function __editPrepareSelection(){if(editGetSelectionType()=="CONTROL"){var selectedNodes=new Array();selectedNodes[selectedNodes.length]=editGetActiveObject();return selectedNodes;}else{try{var doc=getDoc();var range=getDoc().selection.createRange();var selectedHtml=range.htmlText;var selectedText=range.text;var aP=selectedHtml.toLowerCase().split("<p");var mode=0;var startRange=range.duplicate();startRange.collapse(true);startRange.pasteHTML("<span id='__tmp_start'>#</span>");var startElement=getDoc().getElementById("__tmp_start");var endRange=range.duplicate();endRange.collapse(false);endRange.pasteHTML("<span id='__tmp_end'>#</span>");var endElement=getDoc().getElementById("__tmp_end");var leftNode=startElement.previousSibling;var rightNode=startElement.nextSibling;var insideText=false;if(rightNode){if(rightNode.nodeType==3){insideText=true;}}if(insideText){if(rightNode!=null){if(rightNode.parentNode.tagName.toLowerCase()=="span"){if((leftNode==null && endElement.nextSibling==null && startElement.parentNode==endElement.parentNode)||(leftNode==null && startElement.parentNode!=endElement.parentNode)){}else{var newSpan=doc.createElement("span");if(rightNode.data.substring(0,1)==" ")newSpan.innerHTML="&nbsp;"+rightNode.data.substring(1);else newSpan.innerHTML=rightNode.data;rightNode.replaceNode(newSpan);}}else{var newSpan=doc.createElement("span");if(rightNode.data.substring(0,1)==" ")newSpan.innerHTML="&nbsp;"+rightNode.data.substring(1);else newSpan.innerHTML=rightNode.data;rightNode.replaceNode(newSpan);}}}else{}var leftNode=endElement.previousSibling;var rightNode=endElement.nextSibling;var insideText=false;if(leftNode){if(leftNode.nodeType==3){insideText=true;}}if(insideText){if(leftNode!=null){if(leftNode.parentNode.tagName.toLowerCase()=="span"){if((rightNode==null && startElement.previousSibling==null && startElement.parentNode==endElement.parentNode)||(rightNode==null && startElement.parentNode!=endElement.parentNode)){}else{var newSpan=doc.createElement("span");if(leftNode.data.substring(0,1)==" ")newSpan.innerHTML="&nbsp;"+leftNode.data.substring(1);else newSpan.innerHTML=leftNode.data;leftNode.replaceNode(newSpan);}}else{var newSpan=doc.createElement("span");if(leftNode.data.substring(0,1)==" ")newSpan.innerHTML="&nbsp;"+leftNode.data.substring(1);else newSpan.innerHTML=leftNode.data;leftNode.replaceNode(newSpan);}}}else{}}catch(Error){__editRemoveNode(getDoc().getElementById("__tmp_start"));__editRemoveNode(getDoc().getElementById("__tmp_end"));return;}if(startElement==null || endElement==null)return;var rangeStart=getDoc().body.createTextRange();rangeStart.moveToElementText(startElement);var rangeEnd=getDoc().body.createTextRange();rangeEnd.moveToElementText(endElement);range.setEndPoint("StartToStart",rangeStart);range.setEndPoint("EndToEnd",rangeEnd);var parentElement=null;var aP=range.htmlText.toLowerCase().split("<p");parentElement=range.parentElement();if(aP.length > 1){parentElement=range.parentElement();if(parentElement.tagName.toLowerCase()!="body")parentElement=parentElement.parentNode;}else{if(parentElement.tagName.toLowerCase()!="body")parentElement=parentElement.parentNode;}var selectedNodes=new Array();var clearNodes=new Array();var childs=__editGetChildNodes(parentElement);try{for(var i=0;i<childs.length;i++){if(childs[i].nodeType==3){var parentNode=childs[i].parentNode;if(parentNode!=null){if(parentNode.tagName.toLowerCase()!="span"){var newSpan=doc.createElement("span");var text=childs[i].nodeValue;if(text.length==1 && text==String.fromCharCode(160)){}else{if(text.substring(0,1)==" "){newSpan.innerHTML=String.fromCharCode(160)+text.substring(1);}else{newSpan.innerHTML=text;}newSpan.id="__tmp_sel__";childs[i].replaceNode(newSpan);}}}}}}catch(Error){}try{var rangeStart=getDoc().body.createTextRange();rangeStart.moveToElementText(startElement);var rangeEnd=getDoc().body.createTextRange();rangeEnd.moveToElementText(endElement);range.setEndPoint("StartToStart",rangeStart);range.setEndPoint("EndToEnd",rangeEnd);var childs=parentElement.all;for(var i=0;i<childs.length;i++){var inRange=doc.body.createTextRange();inRange.moveToElementText(childs[i]);if(range.inRange(inRange)|| range.isEqual(inRange)){if(childs[i].id=="__tmp_sel__"){childs[i].removeAttribute("id");}if(childs[i].id!="__tmp_start" && childs[i].id!="__tmp_end")selectedNodes[selectedNodes.length]=childs[i];}else{if(childs[i].id=="__tmp_sel__"){clearNodes[clearNodes.length]=childs[i];}}}for(var i=0;i<clearNodes.length;i++){var text=clearNodes[i].innerText;var textNode=null;if(text.substring(0,1)==" "){textNode=doc.createTextNode(String.fromCharCode(160)+text.substring(1));}else{textNode=doc.createTextNode(text);}clearNodes[i].replaceNode(textNode);}var rangeStart=getDoc().body.createTextRange();rangeStart.moveToElementText(startElement);var rangeEnd=getDoc().body.createTextRange();rangeEnd.moveToElementText(endElement);range.setEndPoint("StartToStart",rangeStart);range.setEndPoint("EndToEnd",rangeEnd);range.select();}catch(Error){}var aSpan=getDoc().getElementsByTagName("span");for(var i=0;i<aSpan.length;i++){if(aSpan[i].id=="__tmp_sel__"){aSpan[i].removeAttribute("id");}}__editRemoveNode(getDoc().getElementById("__tmp_start"));__editRemoveNode(getDoc().getElementById("__tmp_end"));return selectedNodes;}};var __editGetChildNodesList=null;function __editGetChildNodesChild(node){if((node.canHaveChildren || node.hasChildNodes())){var allChilds=node.childNodes;for(var i=0;i<allChilds.length;i++){__editGetChildNodesChild(allChilds[i]);}}__editGetChildNodesList[__editGetChildNodesList.length]=node;};function __editGetChildNodes(parent){var childs=parent.childNodes;__editGetChildNodesList=new Array();for(var i=0;i<childs.length;i++){__editGetChildNodesChild(childs[i]);}return __editGetChildNodesList;};function __editGetSelectedObjects(full){var aObjects=new Array();var isFull=full ? true:false;try{if(browser.ie){var selType=editGetSelectionType();if(selType=="CONTROL"){aObjects[aObjects.length]=editGetActiveObject();}else if(selType=="NONE"){return aObjects;}else{var doc=getDoc();var range=doc.selection.createRange();var parentObject=null;var selectedHtml=range.htmlText;var aP=selectedHtml.toLowerCase().split("<p");if(aP.length > 1){parentObject=range.parentElement();if(parentObject.tagName.toLowerCase()!="body")parentObject=parentObject.parentNode;}else{parentObject=range.parentElement();}var childs=parentObject.getElementsByTagName("*");var inRange=doc.body.createTextRange();inRange.moveToElementText(parentObject);if(range.isEqual(inRange)){aObjects[aObjects.length]=parentObject;for(var i=0;i<childs.length;i++){aObjects[aObjects.length]=childs[i];}return aObjects;}var inRange=doc.body.createTextRange();for(var i=0;i<childs.length;i++){inRange.moveToElementText(childs[i]);if(range.inRange(inRange)){aObjects[aObjects.length]=childs[i];}else{if(isFull){if(range.compareEndPoints("StartToEnd",inRange)=="-1" && range.compareEndPoints("EndToStart",inRange)=="1"){aObjects[aObjects.length]=childs[i];}}}}}}}catch(Error){}return aObjects;};function editGetSelectedHtml(){var html="";var doc=getDoc();try{if(browser.ie){if(doc.selection.type.toUpperCase()=="CONTROL"){html=__editActiveObject.outerHTML;}else{var range=doc.selection.createRange();html=range.htmlText;}}else{editSetFocus();var buffer=document.createElement("div");var selection=getWindow().getSelection();var range=selection.getRangeAt(selection.rangeCount-1).cloneRange();var frag=range.cloneContents();buffer.appendChild(frag);html=buffer.innerHTML;}}catch(Error){};document.getElementById('__editData').value=html;return html;};function editGetSelectedText(){var doc=getDoc();if(browser.ie){if(doc.selection.type.toLowerCase()=="control"){data="";}else{var range=doc.selection.createRange();var data=range.text;}}else{var selection=getWindow().getSelection();var data=selection.getRangeAt(selection.rangeCount-1).toString();}document.getElementById('__editData').value=data;return data;};function editHasSelection(){if(editGetSelectionType()!="NONE")return true;else return false;};function editSelectionClear(){try{if(browser.ie)getDoc().selection.clear();}catch(Error){}};function editRetrieveActiveObject(){try{if(browser.ie){if(editGetSelectionType()=="CONTROL"){return __editActiveObject;}else{return getDoc().selection.createRange().parentElement();}}else{if(editGetSelectionType()=="CONTROL"){var selection=getWindow().getSelection();return selection.anchorNode.childNodes[selection.anchorOffset];}else{return __editActiveObject;}}}catch(Error){}};function editGetActiveObject(){return __editActiveObject;};function editSetActiveObject(obj){__editActiveObject=obj;};function editSelectText(source){try{if(browser.ie){var rng=getDoc().body.createTextRange();rng.moveToElementText(source);rng.select();}}catch(Error){}};function editSelectObject(source){try{if(browser.ie){var rng=getDoc().body.createControlRange();rng.add(source);rng.select();}}catch(Error){}};