/*
Modification or decryption of this file is strictly forbidden - Pintexx GmbH
*/
function Browser(){var agent=navigator.userAgent.toLowerCase();this.ns=((agent.indexOf('mozilla')!=-1)&&((agent.indexOf('spoofer')==-1)&&(agent.indexOf('compatible')==-1)));this.ie=(agent.indexOf("msie")!=-1);}var browser=new Browser();var folderImage='design/image/1/folderclosed.gif';var openFolderImage='design/image/1/folderopened.gif';var fileImage='design/image/1/file.gif';var lineImage='design/image/1/line.gif';var lImage='design/image/1/branch2.gif';var lMinusImage='design/image/1/minus2.gif';var lPlusImage='design/image/1/plus2.gif';var tImage='design/image/1/branch1.gif';var tMinusImage='design/image/1/minus1.gif';var tPlusImage='design/image/1/plus1.gif';var blankImage='design/image/1/blank.gif';var plusImage='design/image/1/plus.gif';var minusImage='design/image/1/minus.gif';var objTree=new Tree();var objMenu=null;var img1=new Image();img1.src=folderImage;var img2=new Image();img2.src=openFolderImage;var img3=new Image();img3.src=fileImage;var img4=new Image();img4.src=lineImage;var img5=new Image();img5.src=lImage;var img6=new Image();img6.src=lMinusImage;var img7=new Image();img7.src=lPlusImage;var img8=new Image();img8.src=tImage;var img9=new Image();img9.src=tMinusImage;var img10=new Image();img10.src=tPlusImage;var img11=new Image();img11.src=blankImage;var version="1.0.1127";function __tree_hi(object){object.style.backgroundColor=objTree.highlightBackcolor;object.style.borderColor=objTree.highlightBordercolor;};function __tree_lo(object){object.style.backgroundColor=objTree.backcolor;object.style.borderColor=objTree.backcolor;};function Tree(container){this.container=container?container : "container";this.mode=0;this.adapterUrl="";this.id=-1;this.nodes=new Array();this.backcolor="white";this.background="white";this.font="Arial";this.fontSize="11px";this.fontColor="black";this.fontBackcolor="";this.fontBold=false;this.fontItalic=false;this.marginLeft=3;this.marginTop=3;this.marginRight=3;this.marginBottom=0;this.selectFontcolor="black";this.selectFontBackcolor="";this.highlightBackcolor="#ffb6c1";this.highlightBordercolor="rgb(176,8,95)";this.design=1;this.menuDesign="Office2003";this.showIcons=true;this.showLines=true;this.enableInlineEditing=false;this.enableCopy=false;this.enableDrag=false;this.enableContext=false;this.folderIcon=folderImage;this.openFolderIcon=openFolderImage;this.isFolderOpenedWhenTextClicked=false;this.highlight=false;this.folderOnly=false;this.basePath="";this.selectedNode=null;this._scrollY=0;this.callback_select=null;this.callback_click=null;this.isInline=false;this.isCut=false;this.isCopy=false;this.copyNode=null;this.onNodeClick="";this.onBeforeNodeEdit="";this.onAfterNodeEdit="";this.onAfterNodeAdd="";this.onBeforeNodeRemove="";this.onAfterNodeRemove="";this.onAfterNodeCopy="";this.onAfterNodePaste="";this.onContextMenuClick="";this.onContextMenuCreate="";this.onError="";this.setDesign=__tree_setdesign;this.setMenuDesign=__tree_setmenudesign;this.createNode=__tree_createNode;this.setIconsBlank=__tree_setIconsBlank;this.getID=__tree_getID;this.create=__tree_create;this.getNodeById=__tree_getnodebyid;this.getNodeByKey=__tree_getnodebykey;this.getNodeByTag=__tree_getnodebytag;this.clear=__tree_clear;var node=new Node("__ROOT","","","",true);node.id=this.getID();node.isMaster=true;node.open=true;node.tree=this;this.nodes[this.nodes.length]=node;this.rootnode=node;this.imageBaseUrl="";};function __tree_clear(){this.nodes=new Array();this.id=-1;var node=new Node("__ROOT","","","",true);node.id=this.getID();node.isMaster=true;node.open=true;node.tree=this;this.nodes[this.nodes.length]=node;this.rootnode=node;this.create();};function __tree_setdesign(design){this.design=design;folderImage=this.imageBaseUrl+"design/image/"+design+"/folderclosed.gif";openFolderImage=this.imageBaseUrl+"design/image/"+design+"/folderopened.gif";fileImage=this.imageBaseUrl+"design/image/"+design+"/file.gif";lineImage=this.imageBaseUrl+"design/image/"+design+"/line.gif";plusImage=this.imageBaseUrl+"design/image/"+design+"/plus.gif";minusImage=this.imageBaseUrl+"design/image/"+design+"/minus.gif";lImage=this.imageBaseUrl+"design/image/"+design+"/branch2.gif";lMinusImage=this.imageBaseUrl+"design/image/"+design+"/minus2.gif";lPlusImage=this.imageBaseUrl+"design/image/"+design+"/plus2.gif";tImage=this.imageBaseUrl+"design/image/"+design+"/branch1.gif";tMinusImage=this.imageBaseUrl+"design/image/"+design+"/minus1.gif";tPlusImage=this.imageBaseUrl+"design/image/"+design+"/plus1.gif";blankImage=this.imageBaseUrl+"design/image/"+design+"/blank.gif";this.folderIcon=folderImage;this.openFolderIcon=openFolderImage;if(design==1){}else if(design==2){this.selectFontBackcolor="#316AC1";this.font="Arial";this.fontSize="8pt";this.selectFontcolor="white";}};function __tree_setmenudesign(design){if(design==1)this.menuDesign="Office2000";if(design==2)this.menuDesign="OfficeXP";if(design==3)this.menuDesign="Office2003";if(design==4)this.menuDesign="Office2003S";};function __tree_getnodebyid(id){return this.nodes[id];};function __tree_getnodebykey(key){for(var i=0;i<this.nodes.length;i++){if(this.nodes[i].key==key){return this.nodes[i];}}};function __tree_getnodebytag(tag){var aNodes=new Array();for(var i=0;i<this.nodes.length;i++){if(this.nodes[i].tag==tag){aNodes[aNodes.length]=this.nodes[i];}}return aNodes;};function __tree_createNode(name,key,icon,tag,folder){var node=new Node(name,key,icon,tag,folder);node.tree=this;return node;};function __tree_setIconsBlank(){lineImage='design/image/blank.gif';lImage='design/image/blank.gif';lMinusImage='design/image/blank.gif';lPlusImage='design/image/blank.gif';tImage='design/image/blank.gif';tMinusImage='design/image/blank.gif';tPlusImage='design/image/blank.gif';return false;};function __tree_getID(){this.id++;return this.id;};function __tree_keydown(e){var evt;if(browser.ns){evt=e;if(evt.target.tagName.toLowerCase()=="input")return;}else{evt=window.event;if(evt.srcElement.tagName=="input")return;}var code=evt.keyCode;if(code==46){if(!objTree.isInline){objTree.selectedNode.remove();__CancelEvent(evt);}return;}if(code==32||code==113){if(objTree.selectedNode&&objTree.enableInlineEditing){objTree.selectedNode.select();__CancelEvent(evt);}}if(code==38){__CancelEvent(evt);}if(code==40){__CancelEvent(evt);}if(code==67&&evt.ctrlKey){if(objTree.enableCopy&&objTree.selectedNode.enableCopy){objTree.copyNode=objTree.selectedNode;if(objTree.onAfterNodeCopy!=""){eval("parent."+objTree.onAfterNodeCopy+"(objTree.copyNode)");}__CancelEvent(evt);}}if(code==86&&evt.ctrlKey){if(objTree.enableCopy&&objTree.selectedNode.enablePaste){var newNode=objTree.selectedNode.paste();if(objTree.onAfterNodePaste!=""){eval("parent."+objTree.onAfterNodePaste+"(objTree.selectedNode,newNode)");}__CancelEvent(evt);}}if(code==78&&evt.ctrlKey){setTimeout("__delay_create()",50);__CancelEvent(evt);}if(code==116){objTree.create();__CancelEvent(evt);}};function __delay_create(){if(objTree.selectedNode){var node=new Node("New folder","","","",true);objTree.selectedNode.addNew(node);}};Tree.prototype.__nodeClick=function(id,y,toggle){__tree_inline_hide(true);this._scrollY=y;if(this.nodes[id].folder&&toggle&&this.nodes[id].enableExpand){this.nodes[id].toggle();}if(!toggle&&this.nodes[id].enabled&&this.nodes[id].enableSelect){this.nodes[id].select();}if(browser.ns)evt=e;else evt=window.event;__CancelEvent(evt);};function __tree_node_oncontext(e){objTree.__contextMenu(e);};Tree.prototype.__contextMenu=function(e){var objPopup=null;if(browser.ns){evt=e;target=evt.target;}else{evt=window.event;target=evt.srcElement;}if(browser.ie){evt.cancelBubble=true;evt.returnValue=false;}else{evt.preventDefault();}if(target.id==""||target.tagName.toLowerCase()!="span")return;aID=target.id.split(".");var id=aID[0];if(!objTree.enableContext||!objTree.nodes[id].enableContext)return;if(objTree.selectedNode==null||id!=objTree.selectedNode.id){if(objTree.nodes[id].enabled&&objTree.nodes[id].enableSelect)objTree.nodes[id].select();}var doc=top.document;if(doc.getElementById("__MozPopup")){objPopup=doc.getElementById("__MozPopup");}else{objPopup=doc.createElement("iframe");objPopup.id="__MozPopup";objPopup.style.position="absolute";objPopup.style.visibility="hidden";objPopup.style.width="200px";objPopup.style.zIndex=10000;objPopup.frameBorder=0;doc.body.appendChild(objPopup);}objMenu=new Menu("");objMenu.design=this.menuDesign;objMenu.isPopupMode=true;if(objTree.onContextMenuCreate!="")eval("parent."+objTree.onContextMenuCreate+"(objTree.nodes[id],objMenu)");var temp="";temp+="<html><head><link rel='stylesheet' href='menu/design/style/pinMenu.css' type='text/css'><script>";temp+="var globalCallback = null;";temp+="function onClick(table, row, design, func){ ";if(browser.ie)temp+="globalCallback(row);};";else temp+="eval(func+'('+row+')');};";temp+="function onOut(table,row,design) { ";temp+="};";temp+="function onBlur(table,row,design) { ";temp+="};";temp+="function onKeyDown(table, row, design, func) { ";temp+="};";temp+="function onOver(table,row,design) { ";temp+="  table.className = 'MenuItemHover' + design;";temp+="  table.cellPadding = 1;";temp+="  document.getElementById(row + '.2').className = 'MenuItemHoverText' + design;";temp+="};";temp+="function onOut(table,row,design) { ";temp+="  table.className = 'MenuItem' + design;";temp+="  table.cellPadding = 2;";temp+="  document.getElementById(row + '.2').className  = 'MenuItemFont' + design;";temp+="};";temp+="</script></head><body oncontextmenu='javascript: return false;' style='background-color: white; border: 1px outset; margin:0;overflow:hidden'>";temp+=objMenu.create();temp+="</body></html>";objPopup.style.height=parseInt(objMenu.height)+"px";var doc=objPopup.contentWindow.document;doc.open();doc.write(temp);doc.close();objPopup.contentWindow.globalCallback=__tree_oncontextclick;if(browser.ie){doc.body.onmouseup=__tree_context_onmouseup;doc.body.setCapture(false);}else{parent.window.captureEvents(Event.MOUSEUP);window.captureEvents(Event.MOUSEUP);parent.window.onmouseup=__tree_context_onmouseup;window.onmouseup=__tree_context_onmouseup;}var frame=window.frameElement;var frameLeft=globalGetPositonAllX(frame);var frameTop=globalGetPositonAllY(frame);objPopup.style.left=frameLeft+evt.clientX+"px";objPopup.style.top=frameTop+evt.clientY+"px";objPopup.style.width=objMenu.width;objPopup.style.visibility="visible";return false;};function __tree_context_onmouseup(){var objPopup=top.document.getElementById("__MozPopup");if(browser.ie){objPopup.contentWindow.document.body.releaseCapture();}else{parent.window.releaseEvents(Event.MOUSEUP);window.releaseEvents(Event.MOUSEUP);}objPopup.style.visibility="hidden";};function __tree_popup_hide(){var objPopup=top.document.getElementById("__MozPopup");objPopup.style.visibility="hidden";};function __tree_oncontextclick(id){__tree_popup_hide();var item=objMenu.getItemById(id);if(objTree.onContextMenuClick!="")eval("parent."+objTree.onContextMenuClick+"(item.value)");};Tree.prototype.__nodeSelect=function(id){this.nodes[id].select();};Tree.prototype.setMode=function(mode){this.mode=mode;if(this.mode==1){if(this.adapterUrl!=""){__comm=new Comm(this.adapterUrl);}}};Tree.prototype.getMode=function(){return this.mode;};Tree.prototype.setAdapterUrl=function(url){this.adapterUrl=url;};Tree.prototype.add=function(node){this.rootnode.add(node);};Tree.prototype.createHTML=function(){var html="";var crlf="\r";html+="<table width='100%' bgcolor=\""+this.backcolor+"\" border='0' cellspacing='0'>"+crlf;html+="<tr>"+crlf;html+="<td nowrap>"+crlf;for(var i=0;i<this.rootnode.subNodes.length;i++){html+=this.rootnode.subNodes[i].createHTML(i,this.rootnode.subNodes.length)+crlf;}html+="</td>"+crlf;html+="</tr>"+crlf;html+="</table>"+crlf;return html;};Tree.prototype.getSelectedNode=function(){return this.selectedNode;};function __tree_create(){var container=document.getElementById(this.container);document.body.style.marginLeft=this.marginLeft;document.body.style.marginRight=this.marginRight;document.body.style.marginTop=this.marginTop;document.body.style.backgroundColor=this.backcolor;container.innerHTML=this.createHTML();};function __tree_contextdisabled(e){if(browser.ns)e.preventDefault();return false;};function Node(text,key,icon,tag,folder){this.id="";this.tree=objTree;this.text=text;this.name="";this.key=key;this.tag=tag;this.tag2="";this.tag3="";this.action="";this.subNodes=new Array();this._lastNode=false;this.expanded=false;this.enabled=true;this.autoSort=true;this.enableEdit=true;this.enableRemove=true;this.enableSelect=true;this.enableExpand=true;this.enableCopy=true;this.enablePaste=true;this.enableContext=true;this.isRoot=false;this.icon=icon;this.parentNode=null;this.folder=folder;this.font="";this.fontSize="";this.fontColor="";this.fontBackcolor="";this.fontBold=false;this.setText=__node_settext;this.setIcon=__node_seticon;this.getSubNodes=__node_getsubnodes;};function __node_getsubnodes(){return this.subNodes;};function __node_settext(text){this.text=text;document.getElementById(this.id+".0").innerHTML=text;};function __node_seticon(icon){this.icon=icon;try{document.getElementById(this.id+".2").src=icon;}catch(Error){}};Node.prototype.getObject=function(){return document.getElementById(this.id+".0");};Node.prototype.add=function(node){node.id=node.tree.getID();node.parentNode=this;this.subNodes[this.subNodes.length]=node;this.tree.nodes[this.tree.nodes.length]=node;if(this.text=="__ROOT"){node.isRoot=true;}};Node.prototype.toggle=function(){if(this.expanded){this.collapse();}else{this.expand();}};Node.prototype.select=function(){if(this.tree.selectedNode){if(this.id==this.tree.selectedNode.id){if(this.tree.enableInlineEditing&&this.tree.selectedNode.enableEdit){var inline=document.getElementById("__inline");var curSpan=document.getElementById(this.id+".0");__tree_inline_show(curSpan,this.text);return;}}this.tree.selectedNode.deselect();}this.tree.selectedNode=this;document.getElementById(this.id+'.0').style.backgroundColor=this.tree.selectFontBackcolor;document.getElementById(this.id+'.0').style.color=this.tree.selectFontcolor;if(this.folder)this.setIcon(this.tree.openFolderIcon);if(this.tree.onNodeClick!=""){eval("parent."+this.tree.onNodeClick+"(this)");}};Node.prototype.edit=function(){if(!this.enableEdit)return;this.tree.selectedNode.deselect();this.tree.selectedNode=this;document.getElementById(this.id+'.0').style.backgroundColor=this.tree.selectFontBackcolor;document.getElementById(this.id+'.0').style.color=this.tree.selectFontcolor;if(this.tree.enableInlineEditing&&this.tree.selectedNode.enableEdit){var inline=document.getElementById("__inline");var curSpan=document.getElementById(this.id+".0");__tree_inline_show(curSpan,this.text);return;}};Node.prototype.deselect=function(){var color="";var backcolor="";if(this.folder)this.setIcon(this.tree.folderIcon);if(!this.fontColor)color=this.tree.fontColor;if(this.fontBackcolor)backcolor=this.fontBackcolor;else if(!this.fontBackcolor&&this.tree.fontBackcolor)backcolor=this.tree.fontBackcolor;else backcolor="";var obj=document.getElementById(this.id+'.0');if(obj!=null){obj.style.backgroundColor=backcolor;obj.style.color=color;}};Node.prototype.expand=function(){this.expanded=true;if(this.tree.mode==1){this.subNodes=[];this._lastNode=false;if(this.tree.selectedNode){if(this.tree.selectedNode.folder)this.tree.selectedNode.setIcon(this.tree.folderIcon);}if(this.folder)this.setIcon(this.tree.openFolderIcon);this.tree.selectedNode=this;var aParams=new Array();aParams[0]=new Pair("key","LIST");aParams[1]=new Pair("para1",objTree.basePath);aParams[2]=new Pair("para2",objTree.selectedNode.key);if(this.tree.folderOnly)aParams[3]=new Pair("para3","1");__comm.execute(aParams);}else{this.tree.create();}};Node.prototype.collapse=function(){if(this.tree.selectedNode.folder)this.tree.selectedNode.setIcon(this.tree.folderIcon);if(this.folder)this.setIcon(this.tree.openFolderIcon);this.tree.selectedNode=this;this.expanded=false;this.tree.create();};Node.prototype.activate=function(){this.select();};Node.prototype.remove=function(){if(!this.enableRemove)return;var curNode=this;if(this.tree.onBeforeNodeRemove!=""){if(eval("parent."+this.tree.onBeforeNodeRemove+"(curNode)"))return;}if(this.tree.mode==1){var aParams=new Array();aParams[0]=new Pair("key","REMOVE");aParams[1]=new Pair("para1",this.key);aParams[2]=new Pair("para2",this.folder?"0":"1");__comm.execute(aParams);}else{this.removeIntern();if(this.tree.onAfterNodeRemove!=""){eval("parent."+this.tree.onAfterNodeRemove+"(curNode)");}}};Node.prototype.removeIntern=function(){var aNodes=this.parentNode.subNodes;var newNodes=new Array();for(var i=0;i<aNodes.length;i++){if(aNodes[i].id!=this.id){newNodes[newNodes.length]=aNodes[i];}}this.parentNode.subNodes=newNodes;this.tree.create();};__delay_node=null;Node.prototype.addNew=function(node){this.expanded=true;node.action="CREATE";this.add(node);this.tree.create();node=this.tree.getNodeById(node.id);__delay_node=node;setTimeout("__delay_addnew()",200);};function __delay_addnew(){node=__delay_node;node.edit();};Node.prototype.cut=function(){this.tree.copyNode=this;this.tree.isCut=true;this.tree.isCopy=false;this.setIcon("images/cut.gif");};Node.prototype.copy=function(){this.tree.copyNode=this;this.tree.isCut=false;this.tree.isCopy=true;if(this.folder)this.setIcon("images/folderclosed.gif");else this.setIcon("images/html.gif");};Node.prototype.paste=function(){if(!this.tree.copyNode)return;if(this.tree.mode==1){var aParams=new Array();if(this.tree.isCut)aParams[0]=new Pair("key","MOVE");else aParams[0]=new Pair("key","COPY");aParams[1]=new Pair("para1",this.tree.copyNode.key);aParams[2]=new Pair("para2",this.key);aParams[3]=new Pair("para3",this.tree.copyNode.folder?"0":"1");__comm.execute(aParams);}else{if(this.tree.copyNode){var sourceNode=this.tree.copyNode;var newNode=new Node(sourceNode.text,sourceNode.key,sourceNode.icon,sourceNode.tag,sourceNode.folder);this.expanded=true;this.add(newNode);this.tree.create();newNode.select();return newNode;}}};Node.prototype.createHTML=function(node,nodeCount){var parentNode=this.parentNode;var indent='';var icon="";var crlf="\r";var font="";var size="";var color="";var backcolor="";var bold=false;var italic=false;var scroll="";if(!this.font)font="font-family:"+this.tree.font+";";else font="font-family:"+this.font+";";if(!this.fontSize)size="font-size:"+this.tree.fontSize+";";else size="font-size:"+this.fontSize+";";if(!this.fontColor)color="color:"+this.tree.fontColor+";";else color="color:"+this.fontColor+";";if(!this.fontBackcolor&&this.tree.fontBackcolor!="")backcolor="background-color:"+this.tree.fontBackcolor+";";else if(this.fontBackcolor)backcolor="background-color:"+this.fontBackcolor+";";else backcolor="";if(this.fontBold)bold="font-weight:bold;";else bold="font-weight:normal;";if(objTree.selectedNode){if(this.id==objTree.selectedNode.id){backcolor="background-color:"+objTree.selectFontBackcolor+";";color="color:"+objTree.selectFontcolor+";";}}var context="";if(node+1==nodeCount){this.parentNode._lastNode=true;}while(parentNode.parentNode&&!parentNode.parentNode.isMaster){parentNode=parentNode.parentNode;icon=parentNode._lastNode?blankImage : lineImage;if(this.tree.showLines)indent="<td width=\"1%\"><img border=0 src=\""+icon+"\"></td>"+indent;else indent="<td width=\"1%\"><img border=0 src=\""+blankImage+"\"></td>"+indent;}parentNode=this.parentNode;if(this.tree.mode==1){}else{if(this.subNodes.length){this.folder=true;}}if(this.tree.highlight)var html="<table  id='"+this.id+".3' style=\"border-width: 1px; border-style: solid; border-color:"+this.tree.backcolor+";\" onmouseover=\"javascript:__tree_hi(this);\" onmouseout=\"javascript:__tree_lo(this);\" width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">";else var html="<table  id='"+this.id+".3' cellspacing=\"0\" cellpadding=\"0\">";if(this.folder){if(this.icon==""){this.icon=this.tree.folderIcon;}html+="<tr>"+crlf;html+=indent+crlf;if(this.tree.showLines)icon=((this.expanded)?((this.parentNode._lastNode)?lMinusImage:tMinusImage):((this.parentNode._lastNode)?lPlusImage:tPlusImage));else icon=this.expanded?minusImage:plusImage;if(browser.ie)scroll=",document.body.scrollTop";else scroll=",window.pageYOffset";if(!parentNode.isMaster){html+="<td width=\"1%\"><a  style=\"text-decoration: none;\" href=\"javascript:void(0)\" onclick=\""+"objTree.__nodeClick("+this.id+scroll+",true);\"><img id=\""+this.id+".1\" border=0 src=\""+icon+"\" ></a></td>"+crlf;}if(this.tree.showIcons)html+="<td width=\"1%\"><a style=\"text-decoration: none;\"  href=\"javascript:void(0)\" onclick=\""+"objTree.__nodeClick("+this.id+scroll+",false);\"><img id=\""+this.id+".2\" border=0 src=\""+this.icon+"\"  ></a></td>"+crlf;id="id=\""+this.id+".0\"";if(this.tree.isFolderOpenedWhenTextClicked)html+="<td nowrap><a style=\"text-decoration: none;\"  onclick=\""+"objTree.__nodeClick("+this.id+scroll+",false);\" href=\"javascript:void(0)\" ><span "+id+context+" style=\"text-decoration: none;"+bold+font+size+color+backcolor+"\">"+this.text+"</span></a></td>"+crlf;else html+="<td nowrap><a style=\"text-decoration: none;\"  onclick=\""+"objTree.__nodeClick("+this.id+scroll+",false);\" href=\"javascript:void(0)\"><span "+id+context+" style=\"padding:3px"+bold+font+size+color+backcolor+"\">"+this.text+"</span></a></td>"+crlf;html+="</tr>"+crlf;html+="</table>"+crlf;if(this.expanded){for(var i=0;i<this.subNodes.length;i++){html+=this.subNodes[i].createHTML(i,this.subNodes.length)+crlf;}this._lastNode=false;}}else{if(!this.icon){this.icon=fileImage;}html+="<tr>"+crlf;html+=indent+crlf;if(this.tree.showLines)icon=this.parentNode._lastNode?lImage : tImage;else icon=blankImage;if(!parentNode.isMaster){html+="<td width=\"1%\"><img id=\""+this.id+".1\" border=0 src=\""+icon+"\"></td>"+crlf;}if(this.tree.showIcons)html+="<td width=\"1%\"><a href=\"javascript:void(0)\" onclick=\""+"objTree.__nodeClick("+this.id+scroll+",false);\"><img id=\""+this.id+".2\" border=0 src=\""+this.icon+"\" ></a></td>"+crlf;id="id=\""+this.id+".0\"";html+="<td nowrap><a style=\"text-decoration: none;\" href=\"javascript:void(0)\" onclick=\"objTree.__nodeClick("+this.id+scroll+",false);\"><span "+id+context+" style=\""+bold+font+size+color+backcolor+"\">"+this.text+"</span></a></td>"+crlf;html+="</tr>"+crlf;html+="</table>"+crlf;}return html;};var __comm;var __data;function Comm(url){this.url=url;}Comm.prototype.execute=function(aParams){Ajax.method="POST";Ajax.callback=__comm.receive;Ajax.request(objTree.adapterUrl,aParams);};Comm.prototype.receive=function(){var aKey=Ajax.xml.getElementsByTagName('key');if(aKey[0].firstChild.data=="LIST"){var aNodes=Ajax.xml.getElementsByTagName('node');for(var i=0;i<aNodes.length;i++){if(aNodes[i].getAttribute("type")=="0"){objTree.selectedNode.add(new Node(aNodes[i].getAttribute("name"),aNodes[i].getAttribute("path"),'','',true));}else{objTree.selectedNode.add(new Node(aNodes[i].getAttribute("name"),aNodes[i].getAttribute("path"),aNodes[i].getAttribute("image"),aNodes[i].getAttribute("type"),false));}}objTree.create();}if(aKey[0].firstChild.data=="CREATE"){var aError=Ajax.xml.getElementsByTagName('errormessage');var errorMessage=aError[0].firstChild?aError[0].firstChild.data : "";if(errorMessage!=""){if(objTree.onError!=""){eval("parent."+objTree.onError+"('CREATE',errorMessage)");}}else{var aName=Ajax.xml.getElementsByTagName('name');var aPath=Ajax.xml.getElementsByTagName('path');objTree.selectedNode.setText(aName[0].firstChild.data);objTree.selectedNode.key=aPath[0].firstChild.data;if(objTree.onAfterNodeAdd!=""){eval("parent."+objTree.onAfterNodeAdd+"(objTree.selectedNode)");}objTree.selectedNode.action="";if(objTree.onAfterNodeAdd!=""){eval("parent."+objTree.onAfterNodeAdd+"(objTree.selectedNode)");}}}if(aKey[0].firstChild.data=="RENAME"){var aError=Ajax.xml.getElementsByTagName('errormessage');var errorMessage=aError[0].firstChild?aError[0].firstChild.data : "";if(errorMessage!=""){if(objTree.onError!=""){eval("parent."+objTree.onError+"('RENAME',errorMessage)");}}else{var aName=Ajax.xml.getElementsByTagName('name');var aPath=Ajax.xml.getElementsByTagName('path');var oldText=objTree.selectedNode.text;objTree.selectedNode.setText(aName[0].firstChild.data);objTree.selectedNode.key=aPath[0].firstChild.data;if(objTree.onAfterNodeEdit!=""){eval("parent."+objTree.onAfterNodeEdit+"(oldText,aName[0].firstChild.data)");}}}if(aKey[0].firstChild.data=="REMOVE"){var aError=Ajax.xml.getElementsByTagName('errormessage');var errorMessage=aError[0].firstChild?aError[0].firstChild.data : "";if(errorMessage!=""){alert("Fehler bei Remove: "+errorMessage);}else{var aNodes=objTree.selectedNode.parentNode.subNodes;var newNodes=new Array();for(var i=0;i<aNodes.length;i++){if(aNodes[i].id!=objTree.selectedNode.id){newNodes[newNodes.length]=aNodes[i];}}objTree.selectedNode.parentNode.subNodes=newNodes;objTree.create();}}if(aKey[0].firstChild.data=="COPY"){var aError=Ajax.xml.getElementsByTagName('errormessage');var errorMessage=aError[0].firstChild?aError[0].firstChild.data : "";if(errorMessage!=""){alert("Fehler bei Copy: "+errorMessage);}}if(aKey[0].firstChild.data=="MOVE"){var aError=Ajax.xml.getElementsByTagName('errormessage');var errorMessage=aError[0].firstChild?aError[0].firstChild.data : "";if(errorMessage!=""){alert("Fehler bei Move: "+errorMessage);}}};function Pair(key,value){this.key=key;this.value=value;};function globalGetPositonAllX(obj){var x=0;var parent=obj;var saveParent=null;isWindow=true;try{while(isWindow){while(parent){x=x+parent.offsetLeft;saveParent=parent;parent=parent.offsetParent;}var hasFrame=false;try{hasFrame=saveParent.ownerDocument.parentWindow.frameElement;}catch(Error){};if(hasFrame){parent=hasFrame;isWindow=true;}else{isWindow=false;}}}catch(Error){};return x;};function globalGetPositonAllY(obj){var y=0;var parent=obj;var saveParent=null;isWindow=true;try{while(isWindow){while(parent){y=y+parent.offsetTop;saveParent=parent;parent=parent.offsetParent;}var hasFrame=false;try{hasFrame=saveParent.ownerDocument.parentWindow.frameElement;}catch(Error){}if(hasFrame){parent=hasFrame;isWindow=true;}else{isWindow=false;}}}catch(Error){}return y;};function globalGetPositonY(obj){var y=0;var parent=obj;while(parent){y=y+parent.offsetTop;parent=parent.offsetParent;}return y;};function globalGetPositonX(obj){var x=0;var parent=obj;while(parent){x=x+parent.offsetLeft;parent=parent.offsetParent;}return x;};function __tree_sort(a,b){if(a.name<b.name)return-1;if(a.name>b.name)return 1;return 0;};function __inline_keydown(e){var evt=null;if(browser.ns)evt=e;else evt=window.event;if(evt.keyCode==27){__tree_inline_hide();__CancelEvent(evt);return;}if(evt.keyCode==13){var newText="";var curText=document.getElementById("__inline").value;if(objTree.onBeforeNodeEdit!=""){if(eval("parent."+objTree.onBeforeNodeEdit+"(curText)"))return;}if(objTree.mode==0){var oldText=objTree.selectedNode.text;var action=objTree.selectedNode.action;objTree.selectedNode.action="";newText=__tree_inline_hide();objTree.selectedNode.text=newText;objTree.selectedNode.setText(newText);if(objTree.selectedNode.parentNode.autoSort){var subNodes=objTree.selectedNode.parentNode.getSubNodes();for(var i=0;i<subNodes.length;i++){subNodes[i].name=subNodes[i].text;}subNodes.sort(__tree_sort);objTree.selectedNode.parentNode.subNodes=subNodes;objTree.create();}if(action=="CREATE"){if(objTree.onAfterNodeAdd!=""){eval("parent."+objTree.onAfterNodeAdd+"(objTree.selectedNode)");}}else{if(objTree.onAfterNodeEdit!=""){eval("parent."+objTree.onAfterNodeEdit+"(oldText,newText)");}}}else{if(objTree.selectedNode.action=="CREATE"){newText=__tree_inline_hide(true);var aParams=new Array();aParams[0]=new Pair("key","CREATE");aParams[1]=new Pair("para1",objTree.selectedNode.parentNode.key);aParams[2]=new Pair("para2",newText);aParams[3]=new Pair("para3",objTree.selectedNode.folder?"0":"1");__comm.execute(aParams);}else{newText=__tree_inline_hide();var aParams=new Array();aParams[0]=new Pair("key","RENAME");aParams[1]=new Pair("para1",objTree.selectedNode.text);aParams[2]=new Pair("para2",objTree.selectedNode.parentNode.key);aParams[3]=new Pair("para3",newText);aParams[4]=new Pair("para4",objTree.selectedNode.folder?"0":"1");__comm.execute(aParams);}}__CancelEvent(evt);return;}};function __tree_inline_show(curObject,text){var inline=document.getElementById("__inline");var x=globalGetPositonX(curObject);var y=globalGetPositonY(curObject);inline.style.width=curObject.offsetWidth+20;inline.style.height="19px";inline.style.left=x;inline.style.top=y;inline.style.zIndex=1000;inline.style.visibility="visible";inline.value=text;inline.focus();if(browser.ie){var objRange=inline.createTextRange();objRange.select();}objTree.isInline=true;};function __tree_inline_hide(mode){var remove=mode?false:true;if(objTree.selectedNode.action=="CREATE"){if(remove){var parentNode=objTree.selectedNode.parentNode;objTree.selectedNode.removeIntern();}}var inline=document.getElementById("__inline");var text=inline.value;inline.style.visibility="hidden";inline.style.left=-100;objTree.isInline=false;return text;};function __CancelEvent(evt){if(browser.ie){evt.cancelBubble=true;evt.returnValue=false;}else{evt.preventDefault();}};